["概率论与随机过程 (下)\n常寅山2目录\n第一章 引言 1\n第二章 有限状态马氏链 3\n第 2.1节 定义和例子 . . . . . . . . . . . . . . . . . . . . . . . . . 3\n第 2.2节 极限行为和不变概率 . . . . . . . . . . . . . . . . . . . . 8\n第 2.3节 状态分类 . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n2.3.1可约性 . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n2.3.2周期性 . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n2.3.3不可约、非周期链 . . . . . . . . . . . . . . . . . . . . 14\n2.3.4可约或者周期链 . . . . . . . . . . . . . . . . . . . . . . 15\n第 2.4节 返回次数 . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n第 2.5节 非常返态 . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n第 2.6节 举例 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n第三章 可数状态马氏链 27\n第 3.1节 引言 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n第 3.2节 强马氏性 . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n第 3.3节 常返和非常返 . . . . . . . . . . . . . . . . . . . . . . . . 30\n第 3.4节 正常返和零常返 . . . . . . . . . . . . . . . . . . . . . . . 35\n第 3.5节 不可约正常返链的极限定理 . . . . . . . . . . . . . . . . 44\n第 3.6节 分支过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 46\n第四章 连续时间马氏链 49\n第 4.1节 泊松过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n第 4.2节 有限状态空间 . . . . . . . . . . . . . . . . . . . . . . . . 52\niii 目录\n第 4.3节 生灭过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n第 4.4节 一般情形 . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n第五章 可逆马氏链 71\n第 5.1节 可逆过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n第 5.2节 收敛到平稳分布 . . . . . . . . . . . . . . . . . . . . . . . 73\n第 5.3节 马尔可夫链算法 . . . . . . . . . . . . . . . . . . . . . . . 75\n第 5.4节 常返的判定准则 . . . . . . . . . . . . . . . . . . . . . . . 77\n第六章 更新过程 81\n第 6.1节 引言 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n第 6.2节 更新方程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n第 6.3节 平稳更新过程 . . . . . . . . . . . . . . . . . . . . . . . . 88\n第 6.4节 离散更新过程 . . . . . . . . . . . . . . . . . . . . . . . . 88\n第七章 高斯向量和高斯过程 93\n第 7.1节 高斯随机向量 . . . . . . . . . . . . . . . . . . . . . . . . 93\n第 7.2节 高斯过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n第 7.3节 高斯空间 . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n第 7.4节 高斯白噪声 . . . . . . . . . . . . . . . . . . . . . . . . . 99\n第八章 布朗运动 103\n第 8.1节 引言 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n第 8.2节 布朗运动的构造 . . . . . . . . . . . . . . . . . . . . . . . 106\n第 8.3节 马尔可夫性 . . . . . . . . . . . . . . . . . . . . . . . . . 111\n第 8.4节 布朗运动的轨道的性质 . . . . . . . . . . . . . . . . . . . 116\n第 8.5节 布朗运动的零集 . . . . . . . . . . . . . . . . . . . . . . . 121\n第 8.6节 多维布朗运动 . . . . . . . . . . . . . . . . . . . . . . . . 125\n第 8.7节 常返和非常返 . . . . . . . . . . . . . . . . . . . . . . . . 127\n第 8.8节 布朗运动的分形性质 . . . . . . . . . . . . . . . . . . . . 128\n第 8.9节 带漂移的布朗运动 . . . . . . . . . . . . . . . . . . . . . . 131\n第九章 离散鞅 133\n第 9.1节 条件期望 . . . . . . . . . . . . . . . . . . . . . . . . . . . 133\n第 9.2节 定义和举例 . . . . . . . . . . . . . . . . . . . . . . . . . 136目录 iii\n第 9.3节 可选停时定理 . . . . . . . . . . . . . . . . . . . . . . . . 137\n第 9.4节 一致可积 . . . . . . . . . . . . . . . . . . . . . . . . . . . 138\n第 9.5节 鞅收敛定理 . . . . . . . . . . . . . . . . . . . . . . . . . 140", "第 5.4节 常返的判定准则 . . . . . . . . . . . . . . . . . . . . . . . 77\n第六章 更新过程 81\n第 6.1节 引言 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n第 6.2节 更新方程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n第 6.3节 平稳更新过程 . . . . . . . . . . . . . . . . . . . . . . . . 88\n第 6.4节 离散更新过程 . . . . . . . . . . . . . . . . . . . . . . . . 88\n第七章 高斯向量和高斯过程 93\n第 7.1节 高斯随机向量 . . . . . . . . . . . . . . . . . . . . . . . . 93\n第 7.2节 高斯过程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n第 7.3节 高斯空间 . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n第 7.4节 高斯白噪声 . . . . . . . . . . . . . . . . . . . . . . . . . 99\n第八章 布朗运动 103\n第 8.1节 引言 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n第 8.2节 布朗运动的构造 . . . . . . . . . . . . . . . . . . . . . . . 106\n第 8.3节 马尔可夫性 . . . . . . . . . . . . . . . . . . . . . . . . . 111\n第 8.4节 布朗运动的轨道的性质 . . . . . . . . . . . . . . . . . . . 116\n第 8.5节 布朗运动的零集 . . . . . . . . . . . . . . . . . . . . . . . 121\n第 8.6节 多维布朗运动 . . . . . . . . . . . . . . . . . . . . . . . . 125\n第 8.7节 常返和非常返 . . . . . . . . . . . . . . . . . . . . . . . . 127\n第 8.8节 布朗运动的分形性质 . . . . . . . . . . . . . . . . . . . . 128\n第 8.9节 带漂移的布朗运动 . . . . . . . . . . . . . . . . . . . . . . 131\n第九章 离散鞅 133\n第 9.1节 条件期望 . . . . . . . . . . . . . . . . . . . . . . . . . . . 133\n第 9.2节 定义和举例 . . . . . . . . . . . . . . . . . . . . . . . . . 136目录 iii\n第 9.3节 可选停时定理 . . . . . . . . . . . . . . . . . . . . . . . . 137\n第 9.4节 一致可积 . . . . . . . . . . . . . . . . . . . . . . . . . . . 138\n第 9.5节 鞅收敛定理 . . . . . . . . . . . . . . . . . . . . . . . . . 140\n第 9.6节 极大不等式 . . . . . . . . . . . . . . . . . . . . . . . . . 143\n第 9.7节 倒向鞅 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\n第十章 连续时间鞅 147\n第 10.1节 域流和过程 . . . . . . . . . . . . . . . . . . . . . . . . . 147\n第 10.2节 停时 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\n第 10.3节 连续时间鞅和下鞅 . . . . . . . . . . . . . . . . . . . . . 152\n第 10.4节 鞅收敛定理 . . . . . . . . . . . . . . . . . . . . . . . . . 154\n第 10.5节 可选停时定理 . . . . . . . . . . . . . . . . . . . . . . . . 155\n10.5.1理论部分 . . . . . . . . . . . . . . . . . . . . . . . . . 155\n10.5.2应用 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158\n第十一章 连续半鞅 161\n第 11.1节 有限变差过程 . . . . . . . . . . . . . . . . . . . . . . . . 161\n11.1.1有限变差函数 . . . . . . . . . . . . . . . . . . . . . . . 161\n11.1.2有限变差过程 . . . . . . . . . . . . . . . . . . . . . . . 162\n第 11.2节 连续局部鞅 . . . . . . . . . . . . . . . . . . . . . . . . . 163\n第 11.3节 连续局部鞅的二次变差过程 . . . . . . . . . . . . . . . . 165\n第 11.4节 两个连续局部鞅的尖括号过程 . . . . . . . . . . . . . . . 167\n第 11.5节 连续半鞅 . . . . . . . . . . . . . . . . . . . . . . . . . . 168\n第十二章 随机积分 169\n第 12.1节 随机积分的构造 . . . . . . . . . . . . . . . . . . . . . . 169\n12.1.1对于L2有界连续鞅的随机积分 . . . . . . . . . . . . . 169\n12.1.2对于局部鞅的随机积分 . . . . . . . . . . . . . . . . . . 175\n12.1.3对于连续半鞅的随机积分 . . . . . . . . . . . . . . . . 177\n12.1.4随机积分的收敛 . . . . . . . . . . . . . . . . . . . . . . 178\n第 12.2节 Itô公式 . . . . . . . . . . . . . . . . . . . . . . . . . . . 178\n第 12.3节 Itô公式的应用 . . . . . . . . . . . . . . . . . . . . . . . 182\n12.3.1布朗运动的 Lévy刻画 . . . . . . . . . . . . . . . . . . 182\n12.3.2", "162\n第 11.2节 连续局部鞅 . . . . . . . . . . . . . . . . . . . . . . . . . 163\n第 11.3节 连续局部鞅的二次变差过程 . . . . . . . . . . . . . . . . 165\n第 11.4节 两个连续局部鞅的尖括号过程 . . . . . . . . . . . . . . . 167\n第 11.5节 连续半鞅 . . . . . . . . . . . . . . . . . . . . . . . . . . 168\n第十二章 随机积分 169\n第 12.1节 随机积分的构造 . . . . . . . . . . . . . . . . . . . . . . 169\n12.1.1对于L2有界连续鞅的随机积分 . . . . . . . . . . . . . 169\n12.1.2对于局部鞅的随机积分 . . . . . . . . . . . . . . . . . . 175\n12.1.3对于连续半鞅的随机积分 . . . . . . . . . . . . . . . . 177\n12.1.4随机积分的收敛 . . . . . . . . . . . . . . . . . . . . . . 178\n第 12.2节 Itô公式 . . . . . . . . . . . . . . . . . . . . . . . . . . . 178\n第 12.3节 Itô公式的应用 . . . . . . . . . . . . . . . . . . . . . . . 182\n12.3.1布朗运动的 Lévy刻画 . . . . . . . . . . . . . . . . . . 182\n12.3.2连续鞅与布朗运动的时间变换 . . . . . . . . . . . . . . 183iv 目录\n12.3.3 BDG 不等式 . . . . . . . . . . . . . . . . . . . . . . . 185\n第 12.4节 鞅表示 . . . . . . . . . . . . . . . . . . . . . . . . . . . 186\n第 12.5节 Girsanov 定理 . . . . . . . . . . . . . . . . . . . . . . . 189\n第十三章 随机微分方程 193\n第 13.1节 定义 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193\n第 13.2节 Lipschitz 情形 . . . . . . . . . . . . . . . . . . . . . . . 194\n第 13.3节 解的马氏性 . . . . . . . . . . . . . . . . . . . . . . . . . 198\n第 13.4节 例子 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199\n13.4.1 Ornstein –Uhlenbeck 过程 . . . . . . . . . . . . . . . . 199\n13.4.2几何布朗运动 . . . . . . . . . . . . . . . . . . . . . . . 200第一章 引言\n随机过程原本是指随机状态随着时间演变的过程 .一般我们用实数集\n的非空子集 T表示时间 .例如 ,T= (\u00001,1),T= [0,+1),T=Z或者\nT=f0,1,2,...g.前两者称为是连续时间的 ,最后两种情况被称为离散时\n间的 .而随机过程指的是一族以 t2T为参数的随机变量 (Xt)t∈T.其中 ,\nXt表示关心的对象在时刻 t的状态 .随机变量Xt不一定是实值随机变量 ,\n可以是在统一的一个状态空间 S中的 (广义 )随机变量 .在后来的研究中 ,\n人们放宽了参数集 T是实数的子集的限制 ,而允许 Rd甚至是相当一般的\n集合作为参数集 T.当T是欧式空间 Rd或者其子集时 ,我们称随机过程\n(Xt)t∈T为随机场 .\n作为 (一维 )离散时间随机过程的例子 ,我们将介绍离散时间马氏链和\n离散鞅 .作为 (一维 )连续时间随机过程的例子 ,我们将介绍连续时间马氏\n链、更新过程、布朗运动、连续鞅和连续半鞅 .作为一般参数集的例子 ,我\n们将介绍高斯过程 .\n在后半部分 ,我们将介绍随机分析 ,主要围绕对布朗运动的 Itô积分、连\n续鞅和随机微分方程展开 .\n12 第一章 引言第二章 有限状态马氏链\n第 2.1节 定义和例子\n假设S是一个有限的集合 . (不失一般性的 ,我们可以特别地取 S=\nf1,2,...,N g.)我们称S为状态空间 .考虑一个取值在 S上的随机过程\nX= (Xn)n≥0,即8n\u00150,Xn是取值在S上的随机变量 .为了描述过程 X\n的概率性质 ,我们需要对于任意的 n\u00150,给出 (X0,X1,...,X n)的联合概\n率分布列 :\nP(X0=i0,X1=i1,...,X n=in),\n其中 ,i0,i1,...,i n2S.根据多个事件交集的概率的乘法公式 ,此种概率可\n以由初始分布\nµ(i0) =P(X0=i0),\n和转移概率\nqn(inji0,i1,...,i n−1) =P(Xn=injX0=i0,X1=i1,...,X n−1=in−1)\n给出 .更确切的 ,我们有\nP(X0=i0,X1=i1,...,X n=in)\n=µ(i0)q1(i1ji0)q2(i2ji0,i1)\u0001 \u0001 \u0001qn(inji0,i1,...,i n−1). (2.1)\n对于某些系统 ,我们我们发现系统将来的演化规律只依赖于当下的状态 ,而\n和之前的历史进程无关 .这就是所谓 “马尔可夫性 ” .我们将在接下来的几章\n学习具有马尔可夫性的随机过程的理论 .在数学上 ,马尔可夫性的严格定义\n如下 :8n\u00150,m\u00151,8i0,i1,...,i n+m2S,\nP(Xn+1=in+1,...,X n+m=in+mjX0=i0,X1=i1,...,X n=in)\n34 第二章 有限状态马氏链\n=P(Xn+1=in+1,...,X n+m=in+mjXn=in).\n可以证明如下更简洁的定义和马尔可夫性完全等价 :\n8n\u00150,8i0,i1,...,i n+12S,我们有\nP(Xn+1=in+1jX0=i0,X1=i1,...,X n=in) =P(Xn+1=in+1jXn=in).\n我们把pn(i,j)≜", "需要对于任意的 n\u00150,给出 (X0,X1,...,X n)的联合概\n率分布列 :\nP(X0=i0,X1=i1,...,X n=in),\n其中 ,i0,i1,...,i n2S.根据多个事件交集的概率的乘法公式 ,此种概率可\n以由初始分布\nµ(i0) =P(X0=i0),\n和转移概率\nqn(inji0,i1,...,i n−1) =P(Xn=injX0=i0,X1=i1,...,X n−1=in−1)\n给出 .更确切的 ,我们有\nP(X0=i0,X1=i1,...,X n=in)\n=µ(i0)q1(i1ji0)q2(i2ji0,i1)\u0001 \u0001 \u0001qn(inji0,i1,...,i n−1). (2.1)\n对于某些系统 ,我们我们发现系统将来的演化规律只依赖于当下的状态 ,而\n和之前的历史进程无关 .这就是所谓 “马尔可夫性 ” .我们将在接下来的几章\n学习具有马尔可夫性的随机过程的理论 .在数学上 ,马尔可夫性的严格定义\n如下 :8n\u00150,m\u00151,8i0,i1,...,i n+m2S,\nP(Xn+1=in+1,...,X n+m=in+mjX0=i0,X1=i1,...,X n=in)\n34 第二章 有限状态马氏链\n=P(Xn+1=in+1,...,X n+m=in+mjXn=in).\n可以证明如下更简洁的定义和马尔可夫性完全等价 :\n8n\u00150,8i0,i1,...,i n+12S,我们有\nP(Xn+1=in+1jX0=i0,X1=i1,...,X n=in) =P(Xn+1=in+1jXn=in).\n我们把pn(i,j)≜P(Xn+1=jjXn=i)称为马氏链的 转移概率 ,描述了马\n氏链随时间演化在不同状态间转移的条件概率 .一般来说 ,转移概率pn(i,j)\n非对称的依赖于两个状态 i和j,也和转移发生的时刻 n有关 .但是 ,对于\n我们关心的绝大多数情况 ,转移概率和 n无关 ,可以写成p(i,j).我们称这\n种马氏链为 时齐的 ,这种马氏链内在的随机转移机制不随时间改变 . (就好像\n物理规律不随时间变化一样 .)如无特殊说明 ,我们默认研究的马氏链都有时\n齐的转移概率 .\n转移概率在描述马氏链的分布时至关重要 ,和初始分布一起 ,它们可以\n用来描述马氏链的分布 .对于马氏链 X,利用 (2.1 ),将其中的转移概率 qn替\n换成对应的马氏链的简化的转移概率 p(i,j),我们得到如下表示 :\nP(X0=i0,X1=i1,...,X n=in)\n=µ(i0)p(i0,i1)p(i1,i2)\u0001 \u0001 \u0001p(in−1,in). (2.2)\n既然转移概率如此重要 ,我们有必要进一步考察转移概率的性质 .我\n们可以把转移概率写成矩阵形式 P,其中 ,P是N\u0002N的方阵 ,Pij=\np(i,j).我们称P是转移矩阵 (transition matrix) .转移矩阵是所谓 随机矩\n阵 (Stochastic matrix) ,即,所有元素非负 ,每一行求和为 1:\nPij\u00150,X\njPij= 1.\n反之 ,所有的随机矩阵都对应一个马氏链的转移矩阵 .\n接下来 ,我们介绍一些马氏链的简单而典型的例子 .\n例 2.1 (两状态马尔可夫链 ).考虑S=f0,1g.马氏链X在任何时刻 n都\n在S上取值 .则转移矩阵的一般形式为\nP= \n1\u0000p p\nq 1\u0000q!\n,\n其中 ,0\u0014p,q\u00141.第 2.1节 定义和例子 5\n问题 .假设X0,X1,...,X n,...是独立同分布的参数为 p的伯努利随机变\n量.证明其构成 S=f0,1g上的马氏链 ,转移矩阵是\nP= \n1\u0000p p\n1\u0000p p!\n.\n例 2.2 (简单排队模型 ).假设有一台服务器为访客提供服务 .服务器的容\n量为 2,即最多只能同时为两个访客提供服务 .如果服务器正在为两个访客\n服务 ,那么 ,其他访客无法接入服务器 .我们将服务时间离散化 ,用Xn表\n示时刻n时系统内正在服务的访客人数 .我们首先对访客的到来建模 .一\n般情况下 ,我们认为访客的到来时刻构成泊松过程 .如果每个单位服务时间\n充分小 ,我们可以近似认为每个小时间间隔内到来的访问数不会超过 1.所\n以,我们近似认为每过一个单位时间 ,以概率p到来一个新的访客 ,以概率\n1\u0000p没有访客到来 .一般情况下 ,我们可以假设每个在服务中的访客的访\n问时间服从指数分布 .离散化之后 ,我们认为其近似服从几何分布 .或者等\n价的 ,我们近似认为如果在时刻 n时,某访客仍在服务中 ,那么 ,在下一个时\n刻n+ 1 ,访客结束服务的概率是 q.并且我们假设访客之间彼此独立 .那么 ,\nX= (Xn)n≥0构成马氏链 ,状态空间是 S=f0,1,2g,转移矩阵\nP=0\nBB@1\u0000p p 0\n(1\u0000p)q1\u0000(1\u0000p)q\u0000p(1\u0000q)p(1\u0000q)\nq22q(1\u0000q) (1\u0000q)21\nCCA.\n通常来说 ,服务时间离散化时 ,取的间隔时间都很小 ,这导致p和q都很小 .\n忽略高阶项 ,我们近似认为\nP=0\nBB@1\u0000p p 0\nq 1\u0000q\u0000p p\n0 2q 1\u00002q1\nCCA.\n问题 .如果服务器最多同时为 M个访客提供服务 ,应该如何建模 ,转移矩阵\n是多少 ?\n问题 .如果有等待队列 ,允许访客在服务器无法提供服务时进入等待序列 ,\n又当如何建模 ?\n例 2.3 (带有反射壁的随机游走 ).考虑一个粒子在 S=f0,1,...,N g上随\n机游动 .如果粒子在 0,那么 ,下一步它移动到 1;如果粒子在 N,那么 ,下一6 第二章 有限状态马氏链\n步它移动到 N\u00001;而如果例子位置在 Sn f0,Ng上,粒子以概率", "个在服务中的访客的访\n问时间服从指数分布 .离散化之后 ,我们认为其近似服从几何分布 .或者等\n价的 ,我们近似认为如果在时刻 n时,某访客仍在服务中 ,那么 ,在下一个时\n刻n+ 1 ,访客结束服务的概率是 q.并且我们假设访客之间彼此独立 .那么 ,\nX= (Xn)n≥0构成马氏链 ,状态空间是 S=f0,1,2g,转移矩阵\nP=0\nBB@1\u0000p p 0\n(1\u0000p)q1\u0000(1\u0000p)q\u0000p(1\u0000q)p(1\u0000q)\nq22q(1\u0000q) (1\u0000q)21\nCCA.\n通常来说 ,服务时间离散化时 ,取的间隔时间都很小 ,这导致p和q都很小 .\n忽略高阶项 ,我们近似认为\nP=0\nBB@1\u0000p p 0\nq 1\u0000q\u0000p p\n0 2q 1\u00002q1\nCCA.\n问题 .如果服务器最多同时为 M个访客提供服务 ,应该如何建模 ,转移矩阵\n是多少 ?\n问题 .如果有等待队列 ,允许访客在服务器无法提供服务时进入等待序列 ,\n又当如何建模 ?\n例 2.3 (带有反射壁的随机游走 ).考虑一个粒子在 S=f0,1,...,N g上随\n机游动 .如果粒子在 0,那么 ,下一步它移动到 1;如果粒子在 N,那么 ,下一6 第二章 有限状态马氏链\n步它移动到 N\u00001;而如果例子位置在 Sn f0,Ng上,粒子以概率 1\u0000p向左\n移动一个单位 ,以概率p向右移动一个单位 .简言之 ,粒子在离散区间 S的\n内部 ,以概率p向右移动一个单位 ,以概率 1\u0000p向左移动一个单位的方式\n作随机游动 ,而碰到边界 f0,Ng就会被反射回来 .这一马氏链的转移矩阵是\nP=0\nBBBBBBBBBB@0 1 0 \u0001 \u0001 \u0001 \u0001 \u0001 \u0001 0\n1\u0000p0p 0\u0001 \u0001 \u0001 0\n0...............\n...............0\n0\u0001 \u0001 \u0001 0 1 \u0000p0p\n0\u0001 \u0001 \u0001 \u0001 \u0001 \u0001 0 1 01\nCCCCCCCCCCA.\n如果p= 1/2 ,那么 ,在区间内部向左移动和向右移动的概率相同 ,我们称这\n个随机游动是对称的 (symmetric) 或者无偏的 (unbiased).\n例 2.4 (带有吸收壁的随机游走 ).和上面的粒子基本相同 ,只不过当粒子到\n达边界 0或者N后就停留在那里 .这个马氏链的转移矩阵是\nP=0\nBBBBBBBBBB@1 0 0 \u0001 \u0001 \u0001 \u0001 \u0001 \u0001 0\n1\u0000p0p 0\u0001 \u0001 \u0001 0\n0...............\n...............0\n0\u0001 \u0001 \u0001 0 1 \u0000p0p\n0\u0001 \u0001 \u0001 \u0001 \u0001 \u0001 0 0 11\nCCCCCCCCCCA.\n下面的例子是一类很重要的被广泛研究的马氏链 .\n例 2.5 (图上的简单随机游走 ).考虑一个有限、简单、无向的图 G= (V,E).\n它由顶点集 V和无向边集 E构成 .无向边连接两个顶点 ,被无向边连接的\n顶点被称为是相邻的 .例如在图 2.1中,a和b相邻 ,记作a\u0018b,而a和e不\n相邻 .考虑一个在 V上的粒子 ,如果该粒子现在在顶点 v,那么 ,下一时刻 ,\n粒子会转移到和 v相邻的一个顶点上 ,并且转移到每一个相邻顶点的概率是\n等可能的 .于是 ,这个马氏链的转移概率 P= (Pv,w)v,w为\nPv,w= 1v∼w1\nd(v),\n其中 ,d(v)是v的度 ,是和v相邻的顶点的个数 .第 2.1节 定义和例子 7\n图 2.1:一个简单的图的例子\na\nb\nc\nd\ne\nf\ng\n在介绍完这些例子后 ,我们最后介绍一个理论结果 .很多时候 ,我们会\n让粒子随着马氏链运动一段时间 ,然后考察在 n时刻粒子的位置 .更确切的 ,\n考察n时刻粒子的位置的分布 P(Xn=i).理论上 ,马氏链的运动规律完全\n由初始分布和转移概率所决定 .我们的目标是利用初始分布 µ和转移概率\n矩阵P表示P(Xn=i).通过对式 (2.2 )中的i0,i1,...,i n−1求和 ,我们知道\nP(Xn=i) =X\ni0,i1,...,in−1P(X0=i0,X1=i1,...,X n−1=in−1,Xn=i)\n=X\ni0,i1,...,in−1µ(i0)P(i0,i1)\u0001 \u0001 \u0001P(in−2,in−1)P(in−1,i)\n= (µPn)(i).\n这里 ,我们把µ写成一个行向量 ,P是转移概率矩阵 .那么 ,P(Xn=i)就是\n行向量µPn对应位置i的分量 .\n例 2.6.考虑例 2.1中的例子 ,假设初始状态是状态 0,p=q= 1/3 .计算时刻\n2时,马氏链处在状态 0的概率 .\n解.初始分布是 µ= (1,0).\nP2= \n2/3 1/3\n1/3 2/3!2\n= \n5/9 4/9\n4/9 5/9!\n.\n所以 ,P(X2= 0) = (µP2)(0) = 5/9 .\n注意到在公式 P(Xn=i) = (µPn)(i)的计算 ,一个关键步骤是计算\nPn(i,j)的取值 .并且 ,观察上述例子 ,通过取µ(j) = 1 i=j.我们可以得到\nPn(i,j) =P(Xn=j).此时 ,马氏链从i出发 ,X0=i.因此 ,我们发现\nP(Xn=jjX0=i) =Pn(i,j).8 第二章 有限状态马氏链\n对于一般的初始分布 µ,通过计算 ,也可以发现上式是成立的 .同时 ,还可以\n更一般的证明\nP(Xm+n=jjXm=i) =Pn(i,j).\n类比于转移概率 ,我们将P(Xm+n=jjXm=i)称为n-步转移概率 ,它由 1\n步转移矩阵的 n次幂给出 .\n第 2.2节 极限行为和不变概率\n有时 ,人们关心马氏链长时间演化后的系统所处状态的近似性质 .比如 ,\n", "P(in−2,in−1)P(in−1,i)\n= (µPn)(i).\n这里 ,我们把µ写成一个行向量 ,P是转移概率矩阵 .那么 ,P(Xn=i)就是\n行向量µPn对应位置i的分量 .\n例 2.6.考虑例 2.1中的例子 ,假设初始状态是状态 0,p=q= 1/3 .计算时刻\n2时,马氏链处在状态 0的概率 .\n解.初始分布是 µ= (1,0).\nP2= \n2/3 1/3\n1/3 2/3!2\n= \n5/9 4/9\n4/9 5/9!\n.\n所以 ,P(X2= 0) = (µP2)(0) = 5/9 .\n注意到在公式 P(Xn=i) = (µPn)(i)的计算 ,一个关键步骤是计算\nPn(i,j)的取值 .并且 ,观察上述例子 ,通过取µ(j) = 1 i=j.我们可以得到\nPn(i,j) =P(Xn=j).此时 ,马氏链从i出发 ,X0=i.因此 ,我们发现\nP(Xn=jjX0=i) =Pn(i,j).8 第二章 有限状态马氏链\n对于一般的初始分布 µ,通过计算 ,也可以发现上式是成立的 .同时 ,还可以\n更一般的证明\nP(Xm+n=jjXm=i) =Pn(i,j).\n类比于转移概率 ,我们将P(Xm+n=jjXm=i)称为n-步转移概率 ,它由 1\n步转移矩阵的 n次幂给出 .\n第 2.2节 极限行为和不变概率\n有时 ,人们关心马氏链长时间演化后的系统所处状态的近似性质 .比如 ,\n当n很大时 ,P(Xn=i)的渐进估计 .这和Pn(i,j)的渐进行为密切相关 .\n我们首先看一个例子 :\nP= \n3/4 1/4\n1/6 5/6!\n,\n通过数值计算 ,很快可以发现 ,当n很大时 ,\nPn\u0019 \n2/5 3/5\n2/5 3/5!\n.\n这一结果也很容易在理论上予以证明 .注意到P实际上可以相似对角化 :\nP=Q−1ΛQ,\n其中 ,\nΛ = \n1 0\n0 7/12!\n,Q= \n2/5 3/5\n\u00001 1!\n,Q−1= \n1\u00003/5\n1 2/5!\n.\n所以 ,我们有\nPn=Q−1ΛnQ\u0019Q−1 \n1 0\n0 0!\nQ\n= \n(Q−1)11Q11(Q−1)11Q12\n(Q−1)21Q11(Q−1)21Q12!\n= \n2/5 3/5\n2/5 3/5!\n.\n在这个例子中 ,我们观察到 P有一个单特征值 1,其余特征值模长小于 1.Q\n的第一行是 P的对应于特征值 1的左特征行向量 ,可以取成每个位置非负 ,\n求和为 1的概率向量 (ν(1),ν(2)) .此时 ,Q−1的第一列是 P的对应于特征第 2.2节 极限行为和不变概率 9\n值1的右特征列向量 .而由于P是随机矩阵 ,每个分量全是 1的列向量恰\n好是P的对应于特征根 1的右特征列向量之一 .由于QQ−1=I,所以 ,当\nQ的第一行选取为非负、求和为 1的概率向量时 ,Q−1的第一列被迫成为每\n个分量都是 1的向量 .此时 ,\nlim\nn→∞Pn=Q−1 \n1 0\n0 0!\nQ= \nν(1)ν(2)\nν(1)ν(2)!\n.\n这样 ,Pn的极限由P的唯一一个非负、归一左特征行向量的重复堆叠给出 .\n上述的观察实际上可以给出一个很一般的结果 :\n命题 2.2.1.假设转移矩阵 P有一个一重的单特征根 1,对应一个非负、归\n一的左特征行向量 π.并且假设P的其他特征值的模长都严格小于 1.那\n么,limn→∞Pn(i,j) =π(j).\n我们将上述 π称为马氏链的极限分布 .在2\u00022矩阵的具体例子中 ,\nP是可以对角化的 .这并不是本质的 ,一般情况下 ,可以将P相似变换到\nJordan标准型 ,很多证明是类似的 .\n接下来 ,一个自然的问题是什么样的转移矩阵 P满足命题 2.2.1的条件 ?\n在线性代数中 ,有关于这个问题的结果 : Perron-F robenius 定理 .\n定理 2.2.2 (Perron-F robenius 定理 ).假设方阵P的所有元素严格正 ,每行\n的数的求和为 1.那么 ,1是方阵P的一重单特征根 ,对应一个非负、归一\n的左特征行向量 .并且P的其他特征根的模长严格小于 1.\nPerron-F robenius 定理的条件是比较苛刻的 ,很多马氏链的转移矩阵 P\n有元素为 0.比如 ,\nP=0\nBB@2/3 1/3 0\n1/3 1/3 1/3\n0 2/3 1/31\nCCA.\n但是 ,通过计算 ,我们发现\nP2=0\nBB@5/9 1/3 1/9\n1/3 4/9 2/9\n2/9 4/9 1/31\nCCA.\nP2所有元素严格正 ,满足 Perron-F robenius 定理的条件 .所以 ,1是P2的\n单特征根 ,对应一个非负、归一的特征向量 .并且P的其他特征根的模长严10 第二章 有限状态马氏链\n格小于 1.注意到如果 λ是P的特征值 ,λ2一定是P2的特征值 .P的特征\n向量一定是 P2的特征向量 .如果ν是P2的特征根 ,代数重数是 k,那么 ,\npν和\u0000pν至少有一个是 P的特征根 ,并且 ,两者的代数重数之和必然为\nk.并且 ,由于P1 = 1 ,1一定是任何转移矩阵的特征值 .根据这些性质 ,利\n用反证法 ,不难看出 ,1是P的单特征根 ,对应一个非负、归一的特征向量 .\n并且P的其他特征根的模长严格小于 1.从而 ,命题 2.2.1的条件满足 ,极限\n定理成立 .更一般的 ,我们有如下命题 :\n命题 2.2.3.假设P是一个随机矩阵 .假设存在m\u00151使得Pm的所有", "�苛刻的 ,很多马氏链的转移矩阵 P\n有元素为 0.比如 ,\nP=0\nBB@2/3 1/3 0\n1/3 1/3 1/3\n0 2/3 1/31\nCCA.\n但是 ,通过计算 ,我们发现\nP2=0\nBB@5/9 1/3 1/9\n1/3 4/9 2/9\n2/9 4/9 1/31\nCCA.\nP2所有元素严格正 ,满足 Perron-F robenius 定理的条件 .所以 ,1是P2的\n单特征根 ,对应一个非负、归一的特征向量 .并且P的其他特征根的模长严10 第二章 有限状态马氏链\n格小于 1.注意到如果 λ是P的特征值 ,λ2一定是P2的特征值 .P的特征\n向量一定是 P2的特征向量 .如果ν是P2的特征根 ,代数重数是 k,那么 ,\npν和\u0000pν至少有一个是 P的特征根 ,并且 ,两者的代数重数之和必然为\nk.并且 ,由于P1 = 1 ,1一定是任何转移矩阵的特征值 .根据这些性质 ,利\n用反证法 ,不难看出 ,1是P的单特征根 ,对应一个非负、归一的特征向量 .\n并且P的其他特征根的模长严格小于 1.从而 ,命题 2.2.1的条件满足 ,极限\n定理成立 .更一般的 ,我们有如下命题 :\n命题 2.2.3.假设P是一个随机矩阵 .假设存在m\u00151使得Pm的所有元\n素严格正 .那么 ,存在一个非负、归一的概率向量 π,使得\nlim\nn→∞Pn(i,j) =π(j).\n在后续的内容中 ,我们将进一步讨论使得随机矩阵的 m次幂的元素严\n格正的条件 .\n最后 ,我们来考察一下出现在极限定理中的概率向量 π.首先 ,从之前\n的讨论中 ,我们已经注意到 π是P的左特征行向量 ,即\nπP=π.\n这一点也可以利用 π出现在Pn的极限这一点予以直接的说明 :\nπ(j) = lim\nn→∞Pn(i,j) = lim\nn→∞Pn+1(i,j) = lim\nn→∞X\nkPn(i,k)P(k,j)\n=X\nklim\nn→∞Pn(i,k)P(k,j) =X\nkπ(k)P(k,j) = (πP)(j).\n由于πP=π,两边同时右乘 P,可得πP2=πP=π.归纳的 ,可以证明对\n于非负整数 n,πPn=π.这个等式的概率意义如下 :如果马氏链的初始分布\n是π,那么 ,在以后的任何一个固定的 (非随机的 )时刻n,马氏链的状态 Xn\n的分布还是 π,与初始状态 X0的分布相同 ;更一般的 ,我们可以验证 :\n8s\u00150,(Xs,Xs+1,...,X s+t)都和(X0,X1,...,X t)同分布.\n这反映出从特殊分布 π出发的马氏链的分布随着时间演化的不变性和平稳\n性.因此 ,如果存在概率向量 π,满足\nπP=π,第 2.3节 状态分类 11\n那么 ,我们称π是平稳 (stationary) 分布 ,平衡 (equilibrium) 分布或者稳态\n(steady-state) 分布 .\n我们已经看到极限分布 π一定是一个平稳分布 .关于平稳分布 π,我们\n很自然的要考虑其存在性和唯一性 ,还要考虑是否有\nlim\nn→∞Pn=0\nBBBBB@π\nπ\n...\nπ1\nCCCCCA.\n我们将看到对于有限状态的马氏链而言 ,平稳分布总是存在的 ,但并不一定\n是唯一的 .因此 ,利用极限分布的唯一性 ,平稳分布不一定是极限分布 .但\n是,当平稳分布存在且唯一的时候 ,它一定是极限分布 .\n第 2.3节 状态分类\n我们在前面的内容中看到如下结果 :如果P是一个随机矩阵 ,假设存在\nm\u00151使得Pm的所有元素严格正 ,那么 ,存在一个非负、归一的概率向量\nπ,使得\nlim\nn→∞Pn(i,j) =π(j).\n因此 ,P满足什么条件时 ,存在m\u00151,Pm的所有元素严格正呢 ?我们先看\n一些不满足这个情况的例子 .\n例 2.7.考虑f0,1,2g上带有反射壁的简单随机游动 .对应的转移矩阵为\nP=0 1 2\n0\n1\n20\nBB@0 1 0\n1\n201\n2\n0 1 01\nCCA.\n那么 ,\nP2=0\nBB@1\n201\n2\n0 1 0\n1\n201\n21\nCCA,P3=0\nBB@0 1 0\n1\n201\n2\n0 1 01\nCCA=P,P4=P3P=P2,\nP5=P4P=P2P=P3=P,....12 第二章 有限状态马氏链\n容易发现 ,对于n+i+j是奇数时 ,Pn(i,j) = 0 .仔细观察这个例子 ,我们\n发现Pn(i,j)是否等于零的行为依赖于状态的一个分类 .更确切地 ,我们把\n状态空间分成两类 Sb=f0,2g和Sw=f1g.把Sb中的点染成黑色 ,Sw中\n的点染成白色 .那么 ,马氏链一定在黑白之间跳跃 .即若当前状态是黑色点 ,\n那么 ,转移之后的下一状态必然是白色点 ;而若当前状态是白色点 ,那么 ,转\n移之后的下一状态必然是黑色点 .马氏链状态的颜色交替出现 ,呈现周期性 ,\n周期为 2.这种周期的马氏链也一定不存在极限分布 .\n注 2.3.1.但是在这个例子中 ,如果i和j的颜色相同 ,那么 ,P2n(i,j)有\n极限 .也就是说 ,当我们把视线聚焦在一个颜色类上 ,只观察马氏链每次出\n现在这个颜色类的状态时 ,新得到的限制在这个颜色链上的马氏链的转移矩\n阵是P2在这个颜色类上的限制 .这个限制的马氏链 ,称为原马氏链的迹\n(trace),是存在极限分布的 .\n例 2.8.接下来 ,我们考虑S=f0,1,2g上带吸收壁的简单随机游动 .其转\n移概率为\n", "\n0 1 01\nCCA=P,P4=P3P=P2,\nP5=P4P=P2P=P3=P,....12 第二章 有限状态马氏链\n容易发现 ,对于n+i+j是奇数时 ,Pn(i,j) = 0 .仔细观察这个例子 ,我们\n发现Pn(i,j)是否等于零的行为依赖于状态的一个分类 .更确切地 ,我们把\n状态空间分成两类 Sb=f0,2g和Sw=f1g.把Sb中的点染成黑色 ,Sw中\n的点染成白色 .那么 ,马氏链一定在黑白之间跳跃 .即若当前状态是黑色点 ,\n那么 ,转移之后的下一状态必然是白色点 ;而若当前状态是白色点 ,那么 ,转\n移之后的下一状态必然是黑色点 .马氏链状态的颜色交替出现 ,呈现周期性 ,\n周期为 2.这种周期的马氏链也一定不存在极限分布 .\n注 2.3.1.但是在这个例子中 ,如果i和j的颜色相同 ,那么 ,P2n(i,j)有\n极限 .也就是说 ,当我们把视线聚焦在一个颜色类上 ,只观察马氏链每次出\n现在这个颜色类的状态时 ,新得到的限制在这个颜色链上的马氏链的转移矩\n阵是P2在这个颜色类上的限制 .这个限制的马氏链 ,称为原马氏链的迹\n(trace),是存在极限分布的 .\n例 2.8.接下来 ,我们考虑S=f0,1,2g上带吸收壁的简单随机游动 .其转\n移概率为\nP=0\nBB@1 0 0\n1\n201\n2\n0 0 11\nCCA.\n我们有\nPn\u00190\nBB@1 0 0\n1\n201\n2\n0 0 11\nCCA.\n显然 ,这个马氏链也不存在极限分布 ,故也不存在 n\u00151使得Pn的所有元\n素全为严格正 .原因在于 0和2是吸收态 ,从0或者 2出发不能经过有限步\n转移到 1.而若Pn的所有元素严格正 ,那么 ,对于任何的 i6=j,以非零的正\n概率 ,从i出发经过n步的转移将到达 j.所以 ,必然存在一种确定性的经\n过有限步从 i转移到j的方案 .所以 ,如果8n\u00151,Pn(i,j) = 0 ,那么 ,从i\n出发无法经过有限步转移到达 j.对于这样的转移概率 P,不存在n\u00151使\n得Pn的所有元素全严格正 .\n下面是另一个类似的例子 ,在这个例子里 P是分块对角的 .第 2.3节 状态分类 13\n例 2.9.考虑状态空间 S=f1,2,3,4,5g上的转移矩阵\nP=0\nBBBBBBB@1\n21\n20 0 0\n1\n21\n20 0 0\n0 0 01\n21\n2\n0 01\n201\n2\n0 01\n21\n201\nCCCCCCCA.\n那么 ,P也不满足本节开始指出的情况 .\n以上的例子的类型涵盖了不满足本节开始指出的条件的所有情况 .归纳\n出来 ,主要是 “周期性 ”和 “不可互通性 ” .\n2.3.1可约性\n对于两个状态 i6=j,我们称它们是 互通的 (communicate) 当且仅当存\n在n,m\u00150使得Pn(i,j)>0且Pm(j,i)>0,记为i$j.换言之 ,互通意\n味着从这两个状态的任一个出发都能通过有限次的转移到达另一个状态 .例\n如,在图 2.1所示的图上的简单随机游走的例子中 ,a和c就是互通的 ,因为\n从a出发依次经过 d和e即可到达c,而从c出发依次经过 e和b即可到\n达a.但是 ,c和f就不是互通的 .互通关系是状态空间上的一类等价关系 ,\n拥有自反性 (i$i,因为P0(i,i) = 1>0),对称性 (i$j=)j$i)和传\n递性 (i$j,j$k=)i$k).其中传递性的证明如下 :因为i$j,j$k,\n所以 ,存在n1,n2\u00150使得Pn1(i,j),Pn2(j,k)>0.故,\nPn1+n2(i,k) =X\njPn1(i,j)Pn2(j,k)\u0015Pn1(i,j)Pn2(j,k)>0.\n同理可证存在 m\u00150,Pm(k,i)>0.故i和k也互通 .根据互通这个等价\n关系 ,我们可以将状态空间分割成等价类 .每个等价类成为一个 互通类 .例\n如,在例 2.9中,有两个等价类 f1,2g和f3,4,5g.由于两个等价类不是互通\n的,为了讨论状态 S上的行为 ,只需要分别把马氏链限制在两个互通类内部\n考虑即可 .这反映出例子里马氏链的可约性 .如果只有一个互通类 ,那么 ,我\n们称马氏链是 不可约的 .\n例 2.10.对于图上的简单随机游走 ,它是不可约的 ,等价于图是连通的 .14 第二章 有限状态马氏链\n2.3.2周期性\n我们定义状态 i的周期 (period)d=d(i)为下列自然数的子集的最大公\n约数 :\nJi=fn\u00150 :Pn(i,i)>0g.\n如果Ji=f0g,约定d(i) = + 1.这是一种很特殊的情况 .此种情况下 ,从i\n出发是不能再回到 i的.等价于 ,P(i,i) = 0并且没有和 i互通的其他状态\nj.特别的 ,如果马氏链是不可约的 ,这一情况是不能发生的 .在例 2.7中,每\n个状态的周期都是 2.\n例 2.11.考虑一个二分图上的简单随机游走 ,那么 ,每个状态的周期都是 2.\n根据定义 ,Ji是dZ≥0的子集 ,并且两者可以不一样 .但是可以证明\n当d < +1时,两者的差必然是个有限集 ,即♯(dZ≥0nJi)<+1.或\n者等价的 ,存在n0= 0,1,2,... ,使得 8n\u0015n0,dn2Ji.实际上 ,因为\nPn+m(i,i)\u0015Pn(i,i)Pm(i,i),所以 ,Ji对加法封闭 .利用这个性质 ,可以证\n明前面叙述的性质 .\n问题 .证明要么Ji等于f0g,要么Ji是个无限集合 .\n关于周期的另一个重要性质是互通等价类上的周期是常数 .如果某个\n互通等价类的大小是 1,�", "�么 ,我\n们称马氏链是 不可约的 .\n例 2.10.对于图上的简单随机游走 ,它是不可约的 ,等价于图是连通的 .14 第二章 有限状态马氏链\n2.3.2周期性\n我们定义状态 i的周期 (period)d=d(i)为下列自然数的子集的最大公\n约数 :\nJi=fn\u00150 :Pn(i,i)>0g.\n如果Ji=f0g,约定d(i) = + 1.这是一种很特殊的情况 .此种情况下 ,从i\n出发是不能再回到 i的.等价于 ,P(i,i) = 0并且没有和 i互通的其他状态\nj.特别的 ,如果马氏链是不可约的 ,这一情况是不能发生的 .在例 2.7中,每\n个状态的周期都是 2.\n例 2.11.考虑一个二分图上的简单随机游走 ,那么 ,每个状态的周期都是 2.\n根据定义 ,Ji是dZ≥0的子集 ,并且两者可以不一样 .但是可以证明\n当d < +1时,两者的差必然是个有限集 ,即♯(dZ≥0nJi)<+1.或\n者等价的 ,存在n0= 0,1,2,... ,使得 8n\u0015n0,dn2Ji.实际上 ,因为\nPn+m(i,i)\u0015Pn(i,i)Pm(i,i),所以 ,Ji对加法封闭 .利用这个性质 ,可以证\n明前面叙述的性质 .\n问题 .证明要么Ji等于f0g,要么Ji是个无限集合 .\n关于周期的另一个重要性质是互通等价类上的周期是常数 .如果某个\n互通等价类的大小是 1,那么 ,结果不证自明 .所以 ,我们假设互通等价类\n的大小至少为 2.此时 ,对任意等价类中的状态 i,d(i)<+1.任取两\n个互通等价类中的不同状态 i和j.根据互通的定义 ,存在k,ℓ\u00150,使\n得Pk(i,j),Pℓ(j,i)>0.所以 ,Pk+l(i,i)\u0015Pk(i,j)Pℓ(j,i)>0.因此 ,\nk+ℓ2Ji.故,d(i)能整除k+ℓ.类似的 ,d(j)也能整除k+ℓ.类似的 ,如\n果n2Jj,即Pn(j,j)>0,那么 ,Pn+k+l(i,i)\u0015Pk(i,j)Pn(j,j)Pℓ(j,i)>0.\n所以 ,n+k+ℓ2Ji.因此 ,k+ℓ+Jj\u001aJi.而d(i)能够整除Ji中的每个数 ,\n又知道d(i)整除k+ℓ,所以 ,d(i)能够整除Jj中的数 .故,d(i)整除d(j).\n类似的 ,d(j)也能整除d(i).故两者相等 ,周期在互通等价类上是唯一的 .特\n别的 ,如果马氏链还是不可约的 ,那么 ,只有一个互通等价类 ,所有状态的周\n期有限 ,并完全相同 ,可以称之为马氏链的周期 .\n2.3.3不可约、非周期链\n如果不可约链的周期为 1,我们称之为 非周期的 .根据我们之前的讨论 ,\n对于任意的状态 i,存在Mi<+1,使得n\u0015Mi时,Pn(i,i)>0.根据第 2.3节 状态分类 15\n不可约性 ,考虑状态j,那么 ,存在k\u00150,Pk(i,j)>0.因此 ,Pn+k(i,j)\u0015\nPn(i,i)Pk(i,j)>0,8n\u0015Mi.所以 ,对于状态i和j,存在Mij<+1,对\n于任何n\u0015Mij,Pn(i,j)>0.取M= maxfMij:i,j2Sg.由状态空间\nS的有限性 ,M < +1.而对于n\u0015M ,8i,j2S,Pn(i,j)>0.根据命\n题2.2.3 ,我们得到如下定理 :\n定理 2.3.2.假设P是不可约、非周期的马氏链的转移矩阵 .那么 ,存在唯\n一一个不变概率 π,使得\nlim\nn→∞Pn(i,j) =π(j).\n注 2.3.3.在上述定理的假设下 ,如果µ是任意初始概率向量 ,那么 ,\nlim\nn→∞µPn=π.\n2.3.4可约或者周期链\n不可约周期链\n假设P是不可约的 ,但公共周期 d\u00152.那么 ,周期d一定是有限的 .这\n种情况下 ,可以将状态空间分割为 d个子空间S0,S1,...,S d−1,并且满足如\n下条件 :如果i2Sr而P(i,j)>0,那么 ,一定有j2Sr+1.其中 ,我们约定\nSd=S0.即马氏链总是从上一个 Sr中的状态转移到下一个 Sr+1中的状态 .\n具体的分类方法如下 :首先 ,随意的固定一个状态 i0.对于状态i,j2S,定\n义Jij=fn\u00150;Pn(i,j)>0g.由于不可约性 ,存在ℓ使得Pℓ(j,i)>0.因\n此,ℓ+Jij\u001aJi.故d能整除ℓ+Jij中的数 .这说明Jij中的数模掉 d的余\n数是常数 ,记为rij2 f0,1,...,d \u00001g.对于r= 0,1,...,d \u00001,定义\nSr=fj2S:ri0j=rg.\n问题 .证明这样根据余数定义的分割满足前面描述的性质 .\n原则上 ,这样定义的分割 S0,S1,...,S d−1依赖于最初选择的初始状\n态i0.但是 ,实际上 ,可以证明 fS0,S1,...,S d−1g不依赖于初始选取的\ni0.更确切的 ,对于某个固定的 i0,我们如上得到 S0,S1,...,S r.假设\ni2Sr,那么 ,如果当初固定状态 i而非i0,类似的可以定义出一个分割\nT0,T1,...,T d−1.那么 ,T0=Sr,T1=Sr+1,...,T d−1−r=Sd−1,Td−r=\nS0,Td−r+1=S1,...,T d−1=Sr−1.16 第二章 有限状态马氏链\n问题 .证明上述断言 .\n注意到Pd一定从Sr转移回Sr.考虑Pd对应的马氏链在 Sr上的限\n制表现 .那么 ,这个马氏链是不可约、非周期的 .\n问题 .证明上述限制在 Sr上,以Pd为转移矩阵的马氏链是不可约、非周期\n的.\n根据定理 2.3.2 ,存在唯一一个 Sr上的不变概率 πr,使得\nlim\nn→∞Pdn(i,j) =πr(j),8i,j2Sr.\n我们可以将概率 πr扩展到S上. (补充定义πr(i) = 0 ,8i/2Sr.)接下来 ,我\n们寻找πr之间的关系 .如果i2Sr,j2", "记为rij2 f0,1,...,d \u00001g.对于r= 0,1,...,d \u00001,定义\nSr=fj2S:ri0j=rg.\n问题 .证明这样根据余数定义的分割满足前面描述的性质 .\n原则上 ,这样定义的分割 S0,S1,...,S d−1依赖于最初选择的初始状\n态i0.但是 ,实际上 ,可以证明 fS0,S1,...,S d−1g不依赖于初始选取的\ni0.更确切的 ,对于某个固定的 i0,我们如上得到 S0,S1,...,S r.假设\ni2Sr,那么 ,如果当初固定状态 i而非i0,类似的可以定义出一个分割\nT0,T1,...,T d−1.那么 ,T0=Sr,T1=Sr+1,...,T d−1−r=Sd−1,Td−r=\nS0,Td−r+1=S1,...,T d−1=Sr−1.16 第二章 有限状态马氏链\n问题 .证明上述断言 .\n注意到Pd一定从Sr转移回Sr.考虑Pd对应的马氏链在 Sr上的限\n制表现 .那么 ,这个马氏链是不可约、非周期的 .\n问题 .证明上述限制在 Sr上,以Pd为转移矩阵的马氏链是不可约、非周期\n的.\n根据定理 2.3.2 ,存在唯一一个 Sr上的不变概率 πr,使得\nlim\nn→∞Pdn(i,j) =πr(j),8i,j2Sr.\n我们可以将概率 πr扩展到S上. (补充定义πr(i) = 0 ,8i/2Sr.)接下来 ,我\n们寻找πr之间的关系 .如果i2Sr,j2Sr+1,那么 ,\nPdn+1(i,j) =X\nk∈SrPdn(i,k)P(k,j).\n令n! 1 ,我们得到\nlim\nn→∞Pdn+1(i,j) =X\nk∈Srπr(k)P(k,j).\n另一方面 ,我们有\nPdn+1(i,j) =X\nk∈Sr+1P(i,k)Pdn(k,j).\n令n! 1 ,我们得到\nlim\nn→∞Pdn+1(i,j) =X\nk∈Sr+1P(i,k)πr+1(j) =πr+1(j).\n因此 ,我们有\nπrP=πr+1,8r= 0,1,...,d \u00001.\n其中 ,我们约定πd=π0.\n问题 .假设i2Ss,j2Sr.那么 ,\nlim\nn→∞Pdn+t(i,j) =πr(j)1t≡r−smod d.第 2.3节 状态分类 17\n可以发现 , lim n→∞Pn(i,j)并不存在 .但是 ,\nlim\nn→∞1\ndd−1X\nt=0Pn+t(i,j) =π(j),\n其中 ,\nπ(j) =1\ndd−1X\nr=0πr(j).\n可以证明π是唯一的不变概率 .\n于是 ,我们得到如下结论 :\n定理 2.3.4.对于有限状态不可约马氏链 ,总是存在唯一的不变分布 π.如\n果马氏链的周期 d大于等于 2,那么 ,我们没有\nlim\nn→∞Pn(i,j) =π(j).\n取而代之 ,对于d\u00151,我们有\nlim\nn→∞1\ndd−1X\nt=0Pn+t(i,j) =π(j).\n可约链\n我们假设马氏链有不止一个互通等价类 .根据这些互通等价类的状态之\n间允许的转移方向 ,我们可以定义一个有向图 .每个互通等价类对应这个有\n向图\u0000 !G= (V,\u0000 !E)的一个顶点 .对于顶点x和y,它们对应两个不同的互通\n等价类Sx和Sy.如果存在u2Sx和v2Sy使得P(u,v)>0,我们画一个\n从x到y的有向箭头 .注意到如果有箭头从 x指向y,则一定没有箭头 y指\n向x. (否则 ,Sx和Sy中的状态互通 .)更一般的 ,有向图\u0000 !G一定是无环的.\n定义顶点的出度和入度 :顶点x的出度是从 x出发指向其他顶点的有向边\n的数量 ,而顶点x的入度是从其他顶点指向 x的有向边数量 .由于状态空间\nS有限 ,所以 ,\u0000 !G是个有限的有向无环图 ,一定存在至少一个出度为 0的顶\n点.对于这样的顶点 x,它对应的互通等价类 Sx满足条件 :8u2Sx,\nX\nv∈SxP(u,v) = 1,\n即如果马氏链的出发点在 Sx中,则马氏链一定无法离开 Sx.我们称这样\n的互通等价类是 常返类 ,其他的互通等价类是 暂留类 .常返类中的状态被称18 第二章 有限状态马氏链\n为常返态 .与之对应的 ,暂留类中的状态被称为 暂留态 .可以证明 ,假设如果\n顶点y对应的等价类 Sy是个暂留类 ,考虑方阵Py是转移矩阵 P在Sy\u0002Sy\n上的限制 .那么 ,Py的特征值的模长严格小于 1.所以 , lim n→∞(Py)n= 0 .\n特别的 ,对于z2Sy,P(Xn2SyjX0=z)n→∞!0.因此 ,马氏链无法永远呆\n在Sy中,一定会在有限的时间后离开 Sy.而一旦马氏链离开 Sy,就无法再\n回到Sy. (这是因为\u0000 !G是无环的 .)因此 ,如果马氏链到达 Sy,那么 ,马氏链\n只是暂时留在其中 .因此称Sy是暂留的 .\n注意到极限分布描述系统长时间演化后的渐进行为 .而很长事件后 ,系\n统最终会进入常返类 .所以 ,在描述极限性质的时候 ,暂留类是没有多大作\n用的 .更确切地 ,考虑马氏链的一个平稳分布 π.考虑以平稳分布为初始分\n布的马氏链 .那么 ,对于任意j2S,对于任何时刻 n\u00150,P(Xn=j) =π(j).\n因此 ,马氏链在i呆的平均时间等于 π(i).实际上 ,考虑从 0时刻开始直至\nn时刻 ,这n+ 1个时刻中花费在状态 j的时刻数 :\nY(j,n) =nX\nm=0IfXm=jg.\n这里 ,我们记I为事件的“示性函数” .那么 ,我们有\nEY(j,n) =nX\nm=0P(Xm=j) = (n+ 1)π(j).\n所以 ,E(Y(j,n)/(n+ 1)) =π(j).而对于暂留态 j2S,存在一个随机的\n时刻τ < +1,使得对于n\u0014τ\u00001,马氏链处于某个暂留态之上", "于 1.所以 , lim n→∞(Py)n= 0 .\n特别的 ,对于z2Sy,P(Xn2SyjX0=z)n→∞!0.因此 ,马氏链无法永远呆\n在Sy中,一定会在有限的时间后离开 Sy.而一旦马氏链离开 Sy,就无法再\n回到Sy. (这是因为\u0000 !G是无环的 .)因此 ,如果马氏链到达 Sy,那么 ,马氏链\n只是暂时留在其中 .因此称Sy是暂留的 .\n注意到极限分布描述系统长时间演化后的渐进行为 .而很长事件后 ,系\n统最终会进入常返类 .所以 ,在描述极限性质的时候 ,暂留类是没有多大作\n用的 .更确切地 ,考虑马氏链的一个平稳分布 π.考虑以平稳分布为初始分\n布的马氏链 .那么 ,对于任意j2S,对于任何时刻 n\u00150,P(Xn=j) =π(j).\n因此 ,马氏链在i呆的平均时间等于 π(i).实际上 ,考虑从 0时刻开始直至\nn时刻 ,这n+ 1个时刻中花费在状态 j的时刻数 :\nY(j,n) =nX\nm=0IfXm=jg.\n这里 ,我们记I为事件的“示性函数” .那么 ,我们有\nEY(j,n) =nX\nm=0P(Xm=j) = (n+ 1)π(j).\n所以 ,E(Y(j,n)/(n+ 1)) =π(j).而对于暂留态 j2S,存在一个随机的\n时刻τ < +1,使得对于n\u0014τ\u00001,马氏链处于某个暂留态之上 ,对于\nn\u0015τ,马氏链处于某个常返态之上 .特别的 ,我们有Y(j,n)\u0014τ.故,\nlimn→∞Y(j,n)/(n+ 1) = 0 .根据控制收敛定理 ,\nπ(j) = lim\nn→∞E(Y(j,n)/(n+ 1)) = 0.\n这说明如下命题 :\n命题 2.3.5.马氏链的任何一个平稳分布一定支撑在常返态构成的集合上 .\n从这个角度 ,为了研究平稳分布和极限性质 ,我们应该主要聚焦在马氏\n链在平稳态上的限制之上 .大体上 ,常返态有两种情形 :要么所有常返态在\n一个等价类里 ,要么存在不止一个的常返等价类 .而每个常返等价类又有其\n周期 .如果只有一个常返类且该类的周期为 1,那么 ,该马氏链的行为和不可\n约非周期链基本一样 .第 2.4节 返回次数 19\n命题 2.3.6.假设 (有限状态空间的 )马氏链只有一个常返类且该类的周期\n为1.那么 ,存在唯一一个支撑在常返态上的不变分布 π,使得\nlim\nn→∞Pn(i,j) =π(j).\n如果只有一个常返类且该类的周期等于 d\u00152,那么 ,该马氏链的行为\n和不可约周期链基本一样 .\n命题 2.3.7.假设 (有限状态空间的 )马氏链只有一个常返类且该类的周期\nd\u00152.那么 ,存在唯一一个支撑在常返态上的不变分布 π,使得\nlim\nn→∞1\ndd−1X\nk=0Pn+k(i,j) =π(j).\n除此以外 ,不存在概率 π满足\nlim\nn→∞Pn(i,j) =π(j).\n接下来 ,考虑存在不止一个常返类 .为了简单起见 ,我们先假设所有的常\n返类的周期等于 1.我们可以把马氏链分别限制在每个常返类之上 ,得到一\n系列约化的小马氏链 .那么 ,每个小马氏链都是不可约非周期的 ,存在唯一\n一个不变分布 ,该不变分布也是极限分布 .我们可以自然的把该不变分布延\n拓到原空间 S之上 ,得到原马氏链的若干个不同的不变分布 π1,π2,...,π s.\n命题 2.3.8.在上述假设下 ,马氏链的所有平稳分布由 π1,π2,...,π s的凸组\n合给出 .此时 ,平稳分布并不唯一 ,因此不存在一个统一的概率 π,满足\nlim\nn→∞Pn(i,j) =π(j).\n问题 .对多个常返类 ,常返类的周期不全为 1的情形进行分析 .\n第 2.4节 返回次数\n令Xn是不可约马氏链 ,其转移矩阵为 P.那么 ,存在唯一的不变概率\nπ.考虑从 0时刻开始直至 n时刻 ,这n+ 1个时刻中花费在状态 j的时刻\n数:\nY(j,n) =nX\nm=0IfXm=jg.20 第二章 有限状态马氏链\n这里 ,我们记I为事件的“示性函数” .那么 ,根据上节的结果 ,我们有\nlim\nn→∞1\nn+ 1E(Y(j,n)jX0=i) = lim\nn→∞1\nn+ 1nX\nm=0P(Xm=jjX0=i) =π(j).\n这表示马氏链花费在状态 j的平均时间是 π(j).下面我们将 π(j)和首次返\n回j的时间联系起来 .\n固定状态i,并设X0=i.令T是0时刻之后马氏链首次回到 i的随机\n时刻 :\nT= inffn\u00151 :Xn=ig.\n我们定义T0= 0 ,并归纳的定义\nTk+1= inffn\u0015Tk+ 1 :Xn=ig.\n那么 ,Tk是0时刻之后 ,第k次回到i的时刻 .那么 ,T1=T.对于k\u00151,\n我们定义τk=Tk\u0000Tk−1.通过计算P(τ1=t1,τ2=t2,...,τ k=tk),我们\n可以发现 (τk)k≥1独立同分布 .并且可以证明其公共期望 Eτ1<+1.对于\nn\u00151,定义直到n时刻在i的总停留时刻为 Nn+ 1 .那么 ,直到n时刻 ,\n最后一次访问 i的时刻为TNn;严格在n时刻之后 ,第一次访问 i的时刻为\nTNn+1.除此以外 ,我们知道\nY(i,n) =Nn+ 1.\n容易发现 ,我们有\nNn+ 1\nTNn+ 1\u0014Y(i,n)\nn+ 1\u0014Nn+ 1\nTNn+1.\n根据大数定律 ,我们有\nlim\nk→∞Tk\nk=Eτ1.\n于是 ,我们有\nlim\nn→∞Y(i,n)\nn+ 1=1\nEτ1.\n再根据控制收敛定理 ,我们有\nlim\n", "\nlim\nn→∞1\nn+ 1E(Y(j,n)jX0=i) = lim\nn→∞1\nn+ 1nX\nm=0P(Xm=jjX0=i) =π(j).\n这表示马氏链花费在状态 j的平均时间是 π(j).下面我们将 π(j)和首次返\n回j的时间联系起来 .\n固定状态i,并设X0=i.令T是0时刻之后马氏链首次回到 i的随机\n时刻 :\nT= inffn\u00151 :Xn=ig.\n我们定义T0= 0 ,并归纳的定义\nTk+1= inffn\u0015Tk+ 1 :Xn=ig.\n那么 ,Tk是0时刻之后 ,第k次回到i的时刻 .那么 ,T1=T.对于k\u00151,\n我们定义τk=Tk\u0000Tk−1.通过计算P(τ1=t1,τ2=t2,...,τ k=tk),我们\n可以发现 (τk)k≥1独立同分布 .并且可以证明其公共期望 Eτ1<+1.对于\nn\u00151,定义直到n时刻在i的总停留时刻为 Nn+ 1 .那么 ,直到n时刻 ,\n最后一次访问 i的时刻为TNn;严格在n时刻之后 ,第一次访问 i的时刻为\nTNn+1.除此以外 ,我们知道\nY(i,n) =Nn+ 1.\n容易发现 ,我们有\nNn+ 1\nTNn+ 1\u0014Y(i,n)\nn+ 1\u0014Nn+ 1\nTNn+1.\n根据大数定律 ,我们有\nlim\nk→∞Tk\nk=Eτ1.\n于是 ,我们有\nlim\nn→∞Y(i,n)\nn+ 1=1\nEτ1.\n再根据控制收敛定理 ,我们有\nlim\nn→∞E\u0012Y(i,n)\nn+ 1\f\f\f\fX0=i\u0013\n=1\nEτ1.\n而我们已经得到上式左端等于 π(i).因而 ,我们有第 2.5节 非常返态 21\n定理 2.4.1.对于不可约马氏链 ,我们有\nE(inffn\u00151 :X0=igjX0=i) = 1/π(i).\n例 2.12.考虑S=f0,1g上的两状态马氏链 .转移矩阵为\nP=\"\n1\u0000p p\nq 1\u0000q#\n,0<p,q< 1.\n此时 ,马氏链是不可约的 ,存在唯一的不变分布 π.通过求解\nπP=π,\n知道π(0) =q\np+q,π(1) =p\np+q.令T为返回 0的时刻 ,那么 ,根据定理 2.4.1 ,\n我们有\nE(TjX0= 0) = 1/π(0) =p+q\nq.\n第 2.5节 非常返态\n定义 2.5.1.从某个状态 i出发 ,马氏链访问状态 i的次数总和 Y(i)的期望\n值EY(i)要么有限要么无限 .如果该期望无限 ,称状态i为一个常返态 ;否\n则,称为非常返态 ,也称为暂留态 .\n有限状态空间上 ,马氏链只会临时停留在暂留态上 ,最终一定会进入常\n返态 . (有限状态空间上的马氏链至少存在一个常返态 .)后面 ,在更一般的\n至多可数状态空间上的马氏链理论中 ,我们将看到常返性有如下两种等价刻\n画:\n1.P(Y(i) = + 1jX0=i) = 1 ,\n2.P(9n\u00151,Xn=ijX0=i) = 1 .\n对于非常返性 ,我们也有两种等价刻画 :\n1.P(Y(i)<+1jX0=i) = 1 ,\n2.P(9n\u00151,Xn=ijX0=i)<1.\n对于有限状态空间上的马氏链 ,我们可以借助互通意义下的等价类区分常\n返态和非常返态 .如果马氏链无法逃出一个互通等价类 ,一旦进入此等价类22 第二章 有限状态马氏链\n后,只能在此等价类内部转移 ,则此等价类为常返类 ,其中的状态都是常返\n态.否则 ,若马氏链可以逃出某互通等价类 ,则此等价类是非常返类 ,其中的\n状态都是非常返态 .特别的 ,互通的状态有相同的常返 /非常返类型 .\n接下来 ,对于非常返的状态 i,我们利用马氏链的转移矩阵计算相关的\n概率和期望问题 .\n首先 ,我们考虑EY(i).为此 ,我们将转移矩阵 P按照常返态和暂留态\n分块表示 :\nP=\"˜P0\nS Q#\n.\n其中 ,Q对应马氏链从一个暂留态到另一个暂留态的转移概率 .对于每一个\n暂留的互通类 ,至少存在一个暂留态 i,使得P\n暂留jP(i,j)<1.于是 ,可以\n证明Q的谱半径严格小于 1.特别的 ,I\u0000Q可逆 ,其中 ,I表示单位矩阵 .\n令M= (I\u0000Q)−1.那么 ,我们有如下命题 :\n命题 2.5.1.对于两个非常返态 i和j,\nE(Y(i)jX0=j) = (I\u0000Q)−1(j,i).\n下面 ,我们给出上述命题的证明 .注意到\nE(Y(i)jX0=j) =+∞X\nm=0P(Xm=ijX0=j) =+∞X\nm=0Pm(j,i).\n而\nPm=\"˜Pm0\nSmQm#\n.\n故,Pm(j,i) =Qm(j,i),并且 ,\nE(Y(i)jX0=j) =+∞X\nm=0Qm(j,i) = (I\u0000Q)−1(j,i).\n例 2.13.考虑f0,1,2,3,4g上带有双侧吸收壁的简单随机游动 .重排状态空\n间,得到S=f0,4,1,2,3g.对应的转移矩阵\nP=2\n666666641 0 0 0 0\n0 1 0 0 0\n1/2 0 0 1/2 0\n0 0 1/2 0 1/2\n0 1/2 0 1/2 03\n77777775.第 2.5节 非常返态 23\n那么 ,我们有\nQ=2\n6640 1/2 0\n1/2 0 1/2\n0 1/2 03\n775.\n从而 ,我们有\nM= (I\u0000Q)−1=2\n6643/2 1 1/2\n1 2 1\n1/2 1 3/23\n775.\n特别的 ,从状态 2出发 ,在状态 1停留的总时间的期望是 1,在状态 2停留\n的总时间的期望是 2,在状态 3停留的总时间的期望是 1.将三者相加 ,得到\n从状态 2出发 ,在被 0或者 4吸收前的存活", "2.5.1.对于两个非常返态 i和j,\nE(Y(i)jX0=j) = (I\u0000Q)−1(j,i).\n下面 ,我们给出上述命题的证明 .注意到\nE(Y(i)jX0=j) =+∞X\nm=0P(Xm=ijX0=j) =+∞X\nm=0Pm(j,i).\n而\nPm=\"˜Pm0\nSmQm#\n.\n故,Pm(j,i) =Qm(j,i),并且 ,\nE(Y(i)jX0=j) =+∞X\nm=0Qm(j,i) = (I\u0000Q)−1(j,i).\n例 2.13.考虑f0,1,2,3,4g上带有双侧吸收壁的简单随机游动 .重排状态空\n间,得到S=f0,4,1,2,3g.对应的转移矩阵\nP=2\n666666641 0 0 0 0\n0 1 0 0 0\n1/2 0 0 1/2 0\n0 0 1/2 0 1/2\n0 1/2 0 1/2 03\n77777775.第 2.5节 非常返态 23\n那么 ,我们有\nQ=2\n6640 1/2 0\n1/2 0 1/2\n0 1/2 03\n775.\n从而 ,我们有\nM= (I\u0000Q)−1=2\n6643/2 1 1/2\n1 2 1\n1/2 1 3/23\n775.\n特别的 ,从状态 2出发 ,在状态 1停留的总时间的期望是 1,在状态 2停留\n的总时间的期望是 2,在状态 3停留的总时间的期望是 1.将三者相加 ,得到\n从状态 2出发 ,在被 0或者 4吸收前的存活时间是 1 + 2 + 1 = 4 .\n问题 .假设i是暂留态 .那么 ,从i出发 ,最终一定会被某个常返互通类吸\n收.那么 ,在被吸收前 ,马氏链一定停留在某个暂留态 .记马氏链停留在暂留\n态的总时间为 ζ.试用M= (I\u0000Q)−1表达E(ζjX0=i).\n答案 .E(ζjX0=i) =P\n暂留jM(i,j) =P\n暂留j(I\u0000Q)−1(i,j).\n问题 .假设有个赌徒参与一个公平的赌博游戏 .初始赌资 100元.每局赌博\n如果获胜则增加一元赌资 ,否则减少一元赌资 .赌徒赢到 300元或者输光则\n游戏结束 .利用带双侧吸收壁的简单随机游走建模 .利用计算软件计算赌徒\n参与的赌博总局数的期望值 .\n在上面的问题中 ,有两个吸收态 0和300 .如果我们对赌博总局数不感\n兴趣 ,但是我们对最终的结果出现的概率感兴趣 .即我们希望知道赌徒输光\n的概率 .那么 ,应该如何计算呢 ?假设游戏结束的时刻是 ζ.那么 ,我们希望\n计算P(Xζ= 0jX0= 100) .我们关心ζ时刻马氏链的状态 .为此 ,我们向前\n回溯一步 ,如果Xζ= 0 ,那么 ,Xζ−1= 1 .根据全概率公式 ,我们有\nP(Xζ= 0jX0= 100) =P(Xζ−1= 1,Xζ= 0jX0= 100)\n=+∞X\nn=0P(Xn−1= 1,Xn= 0,ζ=njX0= 100)\n=+∞X\nn=0P(Xn−1= 1,Xn= 0jX0= 100)\n=+∞X\nn=0P(Xn−1= 1jX0= 100)P(Xn= 0jXn−1= 1)24 第二章 有限状态马氏链\n=P(1,0)+∞X\nn=0P(Xn−1= 1jX0= 100)\n=P(1,0)E(Y(1)jX0= 100)\n=P(1,0)M(100,1)\n=P(1,0)(I\u0000Q)−1(100,1).\n上述结果可以自然的推广 .假设i是一个暂留态 ,j是一个常返态 .用F(j)\n表示马氏链离开暂留态后第一次到达的常返态是 j.那么 ,我们有如下结果 :\n命题 2.5.2.\nE(F(j)jX0=i) =X\n暂留k(I\u0000Q)−1(i,k)P(k,j).\n问题 .给出马氏链最终进入某个常返互通类的概率的表达式 .\n最后 ,我们假设马氏链不可约 .我们计算从状态 j到达状态i的时刻τ\n的期望 ,其中 ,\nτ= inffn\u00150 :Xn=ig.\n我们调整状态的顺序 ,将i写在开头的位置 .得到转移矩阵\nP=\"\nP(i,i)R\nS Q#\n.\n由于我们只关心到达 i之前的过程 ,不关心到达 i之后的过程 ,所以 ,从i转\n出的转移概率无关紧要 .因此 ,不影响问题的 ,我们可以把 P换成\n˜P=\"\n1 0\nS Q#\n,\n即假设i是吸收态 .由于原本的马氏链是不可约的 ,所以 ,新的转移矩阵对\n应的马氏链 ˜X的吸收态只有 i.由于τ恰好等于马氏链在暂留态的时间总\n和,利用命题 2.5.1 ,我们得到\nE(τjX0=j) =X\nk̸=iE(Y(k)jX0=j) =X\nk̸=i(I\u0000Q)−1(j,k).\n命题 2.5.3.假设马氏链不可约 ,\nE(inffn\u00150 :Xn=igjX0=j) =X\nk̸=i(I\u0000Q)−1(j,k),\n其中 ,Q是P去掉状态i所在行和列之后剩余的矩阵 .第 2.6节 举例 25\n第 2.6节 举例\n例 2.14.假设 (Xn)n≥0是非齐次马氏链 ,证明 ((n,X n))n≥0是齐次马氏链 ,\n并写出其转移概率 .\n解.转移概率p((m,i),(n,j)) = 1 n=m+1P(Xm+1=jjXm=i).\n例 2.15.考虑有限无向图上的简单随机游走 .假设节点v的度是d(v).假\n设图上边的总数是 e.则,2e=P\nvd(v).可以验证\nπ(v) =d(v)/(2e)\n是图上的平稳分布 .如果该图不是连通的 ,那么 ,图上的平稳分布不是唯一\n的.每个连通分支上都有平稳分布 ,它们的凸组合也是平�", "�要 .因此 ,不影响问题的 ,我们可以把 P换成\n˜P=\"\n1 0\nS Q#\n,\n即假设i是吸收态 .由于原本的马氏链是不可约的 ,所以 ,新的转移矩阵对\n应的马氏链 ˜X的吸收态只有 i.由于τ恰好等于马氏链在暂留态的时间总\n和,利用命题 2.5.1 ,我们得到\nE(τjX0=j) =X\nk̸=iE(Y(k)jX0=j) =X\nk̸=i(I\u0000Q)−1(j,k).\n命题 2.5.3.假设马氏链不可约 ,\nE(inffn\u00150 :Xn=igjX0=j) =X\nk̸=i(I\u0000Q)−1(j,k),\n其中 ,Q是P去掉状态i所在行和列之后剩余的矩阵 .第 2.6节 举例 25\n第 2.6节 举例\n例 2.14.假设 (Xn)n≥0是非齐次马氏链 ,证明 ((n,X n))n≥0是齐次马氏链 ,\n并写出其转移概率 .\n解.转移概率p((m,i),(n,j)) = 1 n=m+1P(Xm+1=jjXm=i).\n例 2.15.考虑有限无向图上的简单随机游走 .假设节点v的度是d(v).假\n设图上边的总数是 e.则,2e=P\nvd(v).可以验证\nπ(v) =d(v)/(2e)\n是图上的平稳分布 .如果该图不是连通的 ,那么 ,图上的平稳分布不是唯一\n的.每个连通分支上都有平稳分布 ,它们的凸组合也是平稳分布 .但是 ,如果\n该图是连通的 ,那么 ,对应的简单随机游走就是不可约的 .因而存在唯一的\n平稳分布 .\n例 2.16.把n枚硬币排成一排 .每次等可能的随机选一枚硬币翻面 .那么 ,\n状态空间S=f\u00001,1gn.其中 ,\u00001代表反面 ,1代表正面 .对于σ1,σ22S,\n如果除了某一个分量不同外 ,其余分量完全相同 ,那么 ,称σ1和σ2相邻 ,并\n在σ1和σ2之间连一条线 .这样 ,我们得到一个以 S为顶点集的无向图 .上\n述翻硬币过程恰好是这个有限无向图上的简单随机游走 .那么 ,唯一的平稳\n分布是均匀分布 .假设初始时刻 ,硬币均正面朝上 .假设T次翻转后 ,这排\n硬币首次回到全正面朝上的状态 +.那么 ,E(T) = 1/π(+) = 2n.\n例 2.17.考虑反复投掷一枚均匀的硬币 ,问第一次出现连续三次正面的时候\n总投掷次数 T的期望值 .\n解.用随机变量 Xn表示第n次的投掷结果 :Xn= 1表示第n次投掷结果\n为正面 ,Xn= 0表示第n次投掷结果为反面 .根据最近三次的结果 ,定义随\n机变量Yn.如果Xn= 0 ,记Yn= 0 ;如果Xn= 1,Xn−1= 0 ,记Yn= 1 ;如\n果Xn=Xn−1= 1,Xn−2= 0 ,记Yn= 2 ;如果Xn=Xn−1=Xn−2= 1 ,记\nYn= 3 .补充定义X0= 0 .那么 ,Y0= 0 .可以发现 ,(Yn)n≥0是一个马氏链 ,\n转移矩阵为\nP=2\n666641/2 1/2 0 0\n1/2 0 1/2 0\n1/2 0 0 1/2\n1/2 0 0 1/23\n77775.26 第二章 有限状态马氏链\n那么 ,题目中提到的 T恰好等于Yn第一次到达 3的时刻 ,即\nT= inffn\u00150 :Yn= 3g.\n所求为E(TjY0= 0) .根据命题 2.5.3 ,我们有\nE(TjY0= 0) = (I\u0000Q)−1(0,0) + (I\u0000Q)−1(0,1) + (I\u0000Q)−1(0,2),\n其中 ,Q=2\n6641/2 1/2 0\n1/2 0 1/2\n1/2 0 03\n775.注意到\nM= (I\u0000Q)−1=2\n6648 4 2\n6 4 2\n4 2 23\n775.\n所以 ,所求为 8 + 4 + 2 = 14 .\n问题 .考虑反复投掷一枚 不均匀的硬币 ,正面朝上的概率是 p,问第一次出现\n连续三次正面的是否总投掷次数 T的期望值 .\n例 2.18.假设P(Xn=ijX0=i0,X1=i1,...,X n−1=in−1) =P(Xn=\nijXn−1=in−1,Xn−2=in−2,...,X n−k=in−k),n\u0015k.那么 ,(Xn)n≥0一般\n不是马氏链 .但是Yn= (Xn,Xn+1,...,X n−k+1)是马氏链 .\n例 2.19.考虑有限记忆的大象随机游走 .考虑\u00061值随机变量 Xn,n\u00151.其\n中,给定Xn−k,Xn−k+1,...,X n−1,N是f1,2,...,k g上的均匀随机变量 .取\n出Xn−N的取值 .掷一枚硬币 ,硬币正面朝上的概率是 p.如果正面朝上 ,则\n记Xn+1=Xn−N,否则 ,Xn+1=\u0000Xn−N.那么 ,(Xn,Xn+1,...,X n+k−1)n≥1\n是一个马氏链 .如果定义S0= 0 ,Sn=Pn\nm=1Xm,则(Sn)n≥0被称为有限\n记忆的大象随机游走 .那么 ,(Sn,Sn+1,...,S n+k)n≥0是一个可数状态马氏\n链.第三章 可数状态马氏链\n第 3.1节 引言\n在本章中 ,我们考虑可数状态空间 S上的 (时齐 )马氏链 .不失一般性\n的,有时我们可以把状态空间取成非负整数集 f0,1,...g.有限状态马氏链的\n一些结果可以推广到这种情形之下 .例如 ,我们一样可以定义转移概率\np(x,y) =P(Xn+1=yjXn=x).\n由于对应的转移矩阵是无限大的 ,一般我们不使用转移矩阵的符号 ,而是利\n用转移概率表达 .类似的 ,我们也可以定义 n步转移概率\npn(x,y) =P(Xm+n=yjXm", "不是马氏链 .但是Yn= (Xn,Xn+1,...,X n−k+1)是马氏链 .\n例 2.19.考虑有限记忆的大象随机游走 .考虑\u00061值随机变量 Xn,n\u00151.其\n中,给定Xn−k,Xn−k+1,...,X n−1,N是f1,2,...,k g上的均匀随机变量 .取\n出Xn−N的取值 .掷一枚硬币 ,硬币正面朝上的概率是 p.如果正面朝上 ,则\n记Xn+1=Xn−N,否则 ,Xn+1=\u0000Xn−N.那么 ,(Xn,Xn+1,...,X n+k−1)n≥1\n是一个马氏链 .如果定义S0= 0 ,Sn=Pn\nm=1Xm,则(Sn)n≥0被称为有限\n记忆的大象随机游走 .那么 ,(Sn,Sn+1,...,S n+k)n≥0是一个可数状态马氏\n链.第三章 可数状态马氏链\n第 3.1节 引言\n在本章中 ,我们考虑可数状态空间 S上的 (时齐 )马氏链 .不失一般性\n的,有时我们可以把状态空间取成非负整数集 f0,1,...g.有限状态马氏链的\n一些结果可以推广到这种情形之下 .例如 ,我们一样可以定义转移概率\np(x,y) =P(Xn+1=yjXn=x).\n由于对应的转移矩阵是无限大的 ,一般我们不使用转移矩阵的符号 ,而是利\n用转移概率表达 .类似的 ,我们也可以定义 n步转移概率\npn(x,y) =P(Xm+n=yjXm=x) =P(Xn=yjX0=x).\n关于n步转移概率 ,我们有如下结论 .\n定理 3.1.1 (Chapman-Kolmogorov 方程 ).\npn+m(x,z) =X\ny∈Spn(x,y)pm(y,z).\n证明 .利用全概率公式和马氏性 ,我们有\npn+m(x,z) =P(Xn+m=zjX0=x)\n=X\ny∈SP(Xn=yjX0=x)P(Xn+m=zjX0=x,X n=y)\n=X\ny∈SP(Xn=yjX0=x)P(Xn+m=zjXn=y)\n=X\ny∈Spn(x,y)pm(y,z).\n2728 第三章 可数状态马氏链\n为了记号上的简便 ,我们把从x出发的马氏链的概率记为 Px,期望记为\nEx,即对于事件 A,我们有\nPx(A) =P(AjX0=x),\n对于随机变量 Z,我们有\nEx(Z) =E(ZjX0=x).\n接下来 ,我们介绍几个可数状态马氏链的例子 :\n例 3.1 (在零点处带部分反射壁的随机游动 ).状态空间S=f0,1,...g.固\n定p2(0,1).定义转移概率\np(x,x+ 1) =p,p(x+ 1,x) = 1\u0000p,8x\u00150;p(0,0) = 1 \u0000p.\n例 3.2 (整数格点图上的简单随机游动 ).考虑整数格点图 Zd.其顶点集\nV=f(x1,x2,...,x d) :x1,x2,...,x d2Zg.\n如果两个顶点 x和y的ℓ1距离jx\u0000yj1=Pd\ni=1jxi\u0000yij等于 1,那么 ,在\nx和y之间连一条边 ,称x和y相邻 ,记为x\u0018y.其上的简单随机游走的\n转移概率为\np(x,y) =1\n2d1x∼y.\n例 3.3 (排队模型 ).令Xn表示在某个服务系统中的顾客数 .我们认为队列\n中的第一个顾客接受服务 ,而其他顾客排队等待 .我们不限制排队等待的顾\n客人数 .在每个时间间隔内 ,一个新的顾客到达的概率是 p,而第一个顾客的\n服务结束并离开队列的概率是 q.那么 ,(Xn)n≥0是个马氏链 ,转移概率为\np(x,x+ 1) =p(1\u0000q)\np(x,x\u00001) = (1 \u0000p)q\np(x,x) = 1\u0000p(1\u0000q)\u0000q(1\u0000p)9\n>>=\n>>;,x\u00151;\np(0,1) =p,p(0,0) = 1 \u0000p.\n对于可数状态空间上的马氏链 ,我们一样可以定义互通、互通等价类、\n不可约、 周期等概念 .对于互通的两个状态 x和y,其周期是一样的 .例3.1是\n不可约非周期的 .例3.2是不可约的 ,周期为 2.例3.3是不可约非周期的 .\n我们一样关心马氏链的极限性质 ,但是 ,对于可数状态空间 ,极限行为更\n为复杂 .例如 ,不可约非周期链并不总是收敛到平稳分布 .第 3.2节 强马氏性 29\n第 3.2节 强马氏性\n为了接下来的研究 ,在本节中 ,我们介绍马氏链的强马氏性 .马氏性表\n明对于确定的时刻 n,已知Xn,马氏链的过去 (Xm)m≤n和将来 (Xm)m≥n\n是条件独立的 .强马氏性表明上述性质中确定的时刻 n可以换成某种随机\n的时刻T.一般而言 ,这种随机的时刻需要是个停时 .为此 ,我们需要先定义\n由随机变量 X0,X1,...,X n生成的事件域\nFn=σ(X0,X1,...,X n).\n则,(Fn)n≥0构成一个域流 (filtration). 接下来 ,给定上述域流 (Fn)n≥0,我\n们定义停时的概念 :\n定义 3.2.1 (停时 ).假设T是取值在 Z≥0[ f+1g上的随机变量 .如果\n8n\u00150,fT\u0014ng 2 F n,那么 ,我们称T是停时 .\n例如 ,Tx= inffn\u00151 :Xn=xg是特殊的停时 .\n给定一个停时 T,我们可以定义事件域 FT:事件A属于FT当且仅当\n8n\u00150,A\\ fT\u0014ng 2 F n.事件域 FT表示T时刻及其之前发生的事件 .\n等价的 ,我们有\nFT=fA2 F :A\\ fT=ng 2 F ng.\n问题 .验证上述方式定义的事件之集 FT确实是事件域 .\n问题 .验证形如 \\n\ni=0fXi=xig \\ fT=ng(n2Z≥0[ f+1g )的事件生成\nFT.\n问题 .验证T是关于事件域 FT可测的随机变量 .\n问题 .给定 Borel可测函数G,证明 1T<∞G(XT)是关于 FT可测的随机变\n量.\n接下来 ,我们给出马氏链的强马氏性 .\n定理 3.2.1.假设", "确定的时刻 n,已知Xn,马氏链的过去 (Xm)m≤n和将来 (Xm)m≥n\n是条件独立的 .强马氏性表明上述性质中确定的时刻 n可以换成某种随机\n的时刻T.一般而言 ,这种随机的时刻需要是个停时 .为此 ,我们需要先定义\n由随机变量 X0,X1,...,X n生成的事件域\nFn=σ(X0,X1,...,X n).\n则,(Fn)n≥0构成一个域流 (filtration). 接下来 ,给定上述域流 (Fn)n≥0,我\n们定义停时的概念 :\n定义 3.2.1 (停时 ).假设T是取值在 Z≥0[ f+1g上的随机变量 .如果\n8n\u00150,fT\u0014ng 2 F n,那么 ,我们称T是停时 .\n例如 ,Tx= inffn\u00151 :Xn=xg是特殊的停时 .\n给定一个停时 T,我们可以定义事件域 FT:事件A属于FT当且仅当\n8n\u00150,A\\ fT\u0014ng 2 F n.事件域 FT表示T时刻及其之前发生的事件 .\n等价的 ,我们有\nFT=fA2 F :A\\ fT=ng 2 F ng.\n问题 .验证上述方式定义的事件之集 FT确实是事件域 .\n问题 .验证形如 \\n\ni=0fXi=xig \\ fT=ng(n2Z≥0[ f+1g )的事件生成\nFT.\n问题 .验证T是关于事件域 FT可测的随机变量 .\n问题 .给定 Borel可测函数G,证明 1T<∞G(XT)是关于 FT可测的随机变\n量.\n接下来 ,我们给出马氏链的强马氏性 .\n定理 3.2.1.假设 (Xn)n≥0是马氏链 ,T是停时 .那么 ,对于有界可测函数\nf,我们有\nE(f(XT,XT+1,...)1T<+∞jFT) = 1 T<+∞EXT(f(X0,X1,...))\n= 1T<+∞X\nx1XT=xEx(f(X0,X1,...)).30 第三章 可数状态马氏链\n注 3.2.2.如果我们取 T\u0011n,那么 ,得到的恰好是马氏性 .\n证明 .首先 ,我们观察到式子右端关于 FT的可测性 .然后 ,我们取A2 F T.\n那么 ,我们有\nE(f(XT,XT+1,...)1T<+∞1A) =∞X\nn=0E(f(Xn,Xn+1,...)1A∩{T=n})\n=∞X\nn=0E(E(f(Xn,Xn+1,...)1A∩{T=n}jFn))\n马氏性=∞X\nn=0E(1A∩{T=n}EXn(f(X0,X1,...)))\n=E(1T<∞1AEXT(f(X0,X1,...))).\n问题 .假设x是常返的 . (常返的定义见后面的定义 3.3.1 .)假设X0=x,\nT0= 0 .对于n\u00151,Tn是第n次返回x的时刻 .那么 ,利用强马氏\n性,可知T1\u0000T0,T2\u0000T1,...独立同分布 .更进一步的 ,定义游程en=\n(XTn,XTn+1,...,X Tn+1).那么 ,e0,e1,...也独立同分布 .\n第 3.3节 常返和非常返\n我们首先给出一个状态是常返态的定义 .\n定义 3.3.1.对于一个状态 x,如果\nPx(存在无限多个 n使得Xn=x) = 1,\n那么 ,我们称状态 x是常返的 .否则 ,称状态x是非常返的或者暂留的 .\n和周期性一样 ,两个互通的状态 x和y要么都是常返的 ,要么都是非常\n返的 .\n命题 3.3.1.假设状态x和y互通 ,x常返 ,那么 ,y也是常返的 .\n证明 .实际上 ,我们假设状态 x是常返的 .然后 ,我们记马氏链依次到达 x\n的时刻为T0,T1,... .其中 ,因为X0=x,所以 ,T0= 0 .对于k\u00151,定义\nek= (XTk−1,XTk−1+1,...,X Tk),称为第k个游程 .那么 ,这些游程独立同分\n布.而由于x和y互通 ,故以非零的概率一个游程经过状态 y.因此 ,我们有\nPx(存在无限多个 n使得Xn=y) = 1.第 3.3节 常返和非常返 31\n考虑第一次访问 y的时刻τ <+1.利用强马氏性 ,(Xτ,Xτ+1,...)和从y\n出发的马氏链同分布 .所以 ,我们有\nPy(存在无限多个 n使得Xn=y) = 1.\n于是 ,状态y也是常返的 .\n如果马氏链是不可约的 ,那么 ,所有状态的常返性相同 .如果所有状态\n都是常返的 ,我们称马氏链是常返的 ;否则 ,称之为非常返的或者暂留的 .接\n下来 ,我们给出常返或者暂留的判别方法 .首先 ,我们注意到如下结果 :\n命题 3.3.2.状态x是常返的当且仅当 Px(Tx<+1) = 1 ,其中 ,\nTx= inffn\u00151 :Xn=xg.\n接下来 ,我们用格林函数给出常返性的等价判断准则 .为此 ,回忆我们\n之前考虑过到状态 x的访问次数\nY(x) =+∞X\nn=0IfXn=xg.\n令q=Px(Tx<+1).那么 ,根据强马氏性 ,每次马氏链回到 x之后 ,都以\n概率 1\u0000q再也不回到 x.因此 ,总访问次数 Y(x)服从参数是 1\u0000q的几何\n分布 .当q= 1时,Y(x) = + 1;当q <1时,Ex(Y(x)) =1\n1−q<+1,特\n别的 ,Y(x)<+1.所以 ,状态x是常返的当且仅当 Ex(Y(x)) = + 1.而,\nEx(Y(x)) =P+∞\nn=0pn(x,x).这样 ,我们得到常返性的另一个等价判断法则 :\n命题 3.3.3.令G(x,y) =Ex(Y(y)) =P+∞\nn=0pn(x,y).那么 ,状态x是常返\n的当且仅当 G(x,x) = + 1.\n接下来 ,我们考察一些例子 .\n例 3.4 (Z上的简单随机游走 ).状态空间S=Z.转移概率p(x,x+ 1) =\np(x,x\u00001) = 1/2 .这个马氏链是不可约的 .对于n\u00150,p2n+1(x,x) = 0 ;\np2n(x,x) =1\n22n\u00122n\nn\u0013\n\u00181pnπ.\n所以 ,G(x,x) =P+∞\nn=0pn(x,x) = + 1.所以 ,Z上的简单随机游走是常返\n的.32 第三章", "(Tx<+1) = 1 ,其中 ,\nTx= inffn\u00151 :Xn=xg.\n接下来 ,我们用格林函数给出常返性的等价判断准则 .为此 ,回忆我们\n之前考虑过到状态 x的访问次数\nY(x) =+∞X\nn=0IfXn=xg.\n令q=Px(Tx<+1).那么 ,根据强马氏性 ,每次马氏链回到 x之后 ,都以\n概率 1\u0000q再也不回到 x.因此 ,总访问次数 Y(x)服从参数是 1\u0000q的几何\n分布 .当q= 1时,Y(x) = + 1;当q <1时,Ex(Y(x)) =1\n1−q<+1,特\n别的 ,Y(x)<+1.所以 ,状态x是常返的当且仅当 Ex(Y(x)) = + 1.而,\nEx(Y(x)) =P+∞\nn=0pn(x,x).这样 ,我们得到常返性的另一个等价判断法则 :\n命题 3.3.3.令G(x,y) =Ex(Y(y)) =P+∞\nn=0pn(x,y).那么 ,状态x是常返\n的当且仅当 G(x,x) = + 1.\n接下来 ,我们考察一些例子 .\n例 3.4 (Z上的简单随机游走 ).状态空间S=Z.转移概率p(x,x+ 1) =\np(x,x\u00001) = 1/2 .这个马氏链是不可约的 .对于n\u00150,p2n+1(x,x) = 0 ;\np2n(x,x) =1\n22n\u00122n\nn\u0013\n\u00181pnπ.\n所以 ,G(x,x) =P+∞\nn=0pn(x,x) = + 1.所以 ,Z上的简单随机游走是常返\n的.32 第三章 可数状态马氏链\n例 3.5 (Z2上的简单随机游走 ).状态空间S=Z2.这个马氏链 (Xn,Yn)n≥0\n是不可约的 .考虑将整个图旋转 45度.定义\nUn=Xn+Yn,Vn=Yn\u0000Xn.\n那么 ,我们有\nP(Un+1\u0000Un= 1,Vn+1\u0000Vn= 1jX0,Y0,X1,Y1,...,X n,Yn) =1\n4,\nP(Un+1\u0000Un= 1,Vn+1\u0000Vn=\u00001jX0,Y0,X1,Y1,...,X n,Yn) =1\n4,\nP(Un+1\u0000Un=\u00001,Vn+1\u0000Vn= 1jX0,Y0,X1,Y1,...,X n,Yn) =1\n4,\nP(Un+1\u0000Un=\u00001,Vn+1\u0000Vn=\u00001jX0,Y0,X1,Y1,...,X n,Yn) =1\n4.\n于是 ,我们发现 (Un)n≥0和(Vn)n≥0都是Z上的简单随机游走 ,并且两者独\n立.对于n\u00150,p2n+1(0,0) = 0 ;\np2n(0,0) =P(X2n=Y2n= 0jX0=Y0= 0)\n=P(U2n=V2n= 0jU0=V0= 0) =1\n42n\u00122n\nn\u00132\n\u00181\nnπ.\n所以 ,G(0,0) =P+∞\nn=0pn(x,x) = + 1.所以 ,Z2上的简单随机游走是常返\n的.\n例 3.6 (Zd(d\u00153)上的简单随机游走 ).状态空间S=Zd.这个马氏链\n(Xn)n≥0是不可约的 .对于n\u00150,p2n+1(0,0) = 0 ;接下来 ,我们估计\np2n(0,0),这等同于经过 2n步移动回到原点的概率 .每一步的移动一定平行\n于某个坐标轴 .记Ni为平行于坐标轴 i的移动步数 .那么 ,(N1,N2,...,N d)\n服从多项分布 .那么 ,Ni是偶数的概率大致是 1/2 .fNi是偶数 gi=1,2,...,d−1\n几乎是独立的 .所以 ,N1,N2,...,N d都是偶数的概率大约是 (1/2)d−1.给定\nN1,N2,...,N d都是偶数 ,N1,N2,...,N d的大小大约都是 2n/d. (背后是大\n数定律在起作用 .)而根据一维简单随机游走的结果 ,在第i个方向回到原点\n的条件概率是 (d\nnπ)1/2.综上 ,我们有\np2n(0,0)\u0018(1/2)d−1\u0012d\nnπ\u0013d/2\n.\n所以 ,对于d\u00153,G(0,0) =P+∞\nn=0pn(x,x)<+1.所以 ,Zd(d\u00153)上的简\n单随机游走是非常返的 .第 3.3节 常返和非常返 33\n定理 3.3.4.d= 1,2时,Zd上的简单随机游走是常返的 ;d\u00153时,Zd上的\n简单随机游走是非常返的 .\n接下来 ,我们介绍另外一种判断常返性的方法 .这种判断方法利用调和\n函数 .假设 (Xn)n≥0是S上的不可约马氏链 .固定一个状态 z.定义\nα(x) =P(9n\u00150,Xn=zjX0=x).\n那么 ,α(z) = 1 .如果 (Xn)n≥0是不可约常返的 ,那么 ,8x2S,α(x) = 1 .接\n下来 ,我们说明α(x)是Sn fzg上的调和函数 :对于x6=z,我们有\nα(x) =X\ny∈SP(X1=y,9n\u00151,Xn=zjX0=x)\n=X\ny∈Sp(x,y)P(9n\u00151,Xn=zjX1=y)\n=X\ny∈Sp(x,y)α(y).\n另外 ,可以证明 ,如果马氏链非常返 ,那么 ,\ninffα(x) :x2Sg= 0.\n实际上 ,我们记q=P(∄n\u00151,Xn=zjX0=z),那么 ,q2(0,1].另一方面 ,\n我们有\nq=P \n8n= 1,2,...,m,X n6=z,\n8n\u0015m+ 1,Xn6=z\f\f\f\f\fX0=z!\n=X\nx̸=zP0\nBB@8n= 1,2,...,m,X n6=z,\nXm=x,\n8n\u0015m+ 1,Xn6=z\f\f\f\f\f\f\f\fX0=z1\nCCA\n=X\nx̸=zP \n8n= 1,2,...,m,X n6=z,\nXm=x,\f\f\f\f\fX0=z!\n\u0002P(8n\u0015m+ 1,Xn6=zjXm=x)\n=X\nx̸=z(1\u0000α(x))P \n8n= 1,2,...,m,X n6=z,\nXm=x,\f\f\f\f\fX0=z!\n\u0014(1\u0000inffα(x) :x2Sg)P(8n= 1,2,...,m,X n6=z)\nm→∞!q(1\u0000inffα(x) :x2SgjX0=z).34 第三章 可数状态马氏链\n所以 ,我们有\ninffα(x) :x2Sg= 0.\n总之 ,当", "\u00150,Xn=zjX0=x).\n那么 ,α(z) = 1 .如果 (Xn)n≥0是不可约常返的 ,那么 ,8x2S,α(x) = 1 .接\n下来 ,我们说明α(x)是Sn fzg上的调和函数 :对于x6=z,我们有\nα(x) =X\ny∈SP(X1=y,9n\u00151,Xn=zjX0=x)\n=X\ny∈Sp(x,y)P(9n\u00151,Xn=zjX1=y)\n=X\ny∈Sp(x,y)α(y).\n另外 ,可以证明 ,如果马氏链非常返 ,那么 ,\ninffα(x) :x2Sg= 0.\n实际上 ,我们记q=P(∄n\u00151,Xn=zjX0=z),那么 ,q2(0,1].另一方面 ,\n我们有\nq=P \n8n= 1,2,...,m,X n6=z,\n8n\u0015m+ 1,Xn6=z\f\f\f\f\fX0=z!\n=X\nx̸=zP0\nBB@8n= 1,2,...,m,X n6=z,\nXm=x,\n8n\u0015m+ 1,Xn6=z\f\f\f\f\f\f\f\fX0=z1\nCCA\n=X\nx̸=zP \n8n= 1,2,...,m,X n6=z,\nXm=x,\f\f\f\f\fX0=z!\n\u0002P(8n\u0015m+ 1,Xn6=zjXm=x)\n=X\nx̸=z(1\u0000α(x))P \n8n= 1,2,...,m,X n6=z,\nXm=x,\f\f\f\f\fX0=z!\n\u0014(1\u0000inffα(x) :x2Sg)P(8n= 1,2,...,m,X n6=z)\nm→∞!q(1\u0000inffα(x) :x2SgjX0=z).34 第三章 可数状态马氏链\n所以 ,我们有\ninffα(x) :x2Sg= 0.\n总之 ,当马氏链是不可约非常返时 ,α(x)满足如下条件\n0\u0014α(x)\u00141, (3.1)\nα(z) = 1, (3.2)\ninffα(x) :x2Sg= 0, (3.3)\nα(x) =X\ny∈Sp(x,y)α(y),8x6=z. (3.4)\n即使p(x,y)是不可约的 ,满足 (3.1 ), ( 3.2 ), ( 3.3 )和(3.4 )的函数α(x)也不一\n定是唯一的 .对于非常返的情况 ,如下定义的函数是一个解 :\nα(x) =P(9n\u00150,Xn=zjX0=x).\n对于不可约常返的情况 ,利用鞅的方法 ,可以证明不存在满足 (3.1 ), ( 3.2 ),\n(3.3 )和(3.4 )的函数α(x).这给出了判断常返和非常返的另一个方法 .\n命题 3.3.5.一个不可约马氏链是非常返的当且仅当存在同时满足 (3.1 ),\n(3.2 ),(3.3 )和(3.4 )的函数α(x).\n证明 .假设存在同时满足 (3.1 ), ( 3.2 ), ( 3.3 )和(3.4 )的函数α(x).我们用反证\n法证明非常返性 .为此 ,我们先假设这个不可约马氏链是常返的 .那么 ,对于\n任意的x2S,Px(Tz<1) = 1 .由(3.3 ),我们可以取 x使得α(x)\u00141\n2.记\nT=Tz.记Fn=σ(Xm,m\u0014n).我们首先证明 Mn=α(Xn∧T)是鞅 ,其中 ,\nn^T= min(n,T).显然 ,Mn关于Fn可测 .由(3.1 ),Mn可积 .最后 ,我们\n有\nE(Mn+1jFn) =E(α(X(n+1)∧T)jFn)\n=E(1T≤nα(XT) + 1 T>nα(Xn+1)jFn)\n= 1T≤nα(XT) + 1 T>nX\nyα(y)p(Xn,y)\n= 1T≤nα(XT) + 1 T>nα(Xn)\n=α(Xn∧T)\n=Mn.第 3.4节 正常返和零常返 35\n令n! 1 ,M∞= limn→∞Mn= limn→∞α(Xn∧T) =α(XT) =α(z) = 1 .\n利用有界收敛定理 , lim n→∞E(Mn) =E(M∞) = 1 .但是 ,根据鞅的性质 ,\nE(Mn) =E(M0) =α(x)\u00141/2 .由此矛盾 ,我们立即知道此不可约马氏链\n是非常返的 .\n最后 ,我们假设这个不可约马氏链是非常返的 .我们令\nα(x) =Px(9n\u00150,Xn=z).\n前面已经说明 α(x)满足 (3.1 ), ( 3.2 ), ( 3.3 )和(3.4 ).\n例 3.7.考虑例 3.1 .我们已经知道这个马氏链不可约 .令z= 0 .那么 ,\n(3.4 )可以写成\nα(x) = (1 \u0000p)α(x\u00001) +pα(x+ 1),x\u00151.\n上述差分方程的解的一般形式为\nα(x) =c1+c2x,p= 1/2; (3.5)\nα(x) =c1+c2\u00121\u0000p\np\u0013x\n,p6= 1/2. (3.6)\n利用 (3.1 )和(3.2 ),我们知道解可以写成\nα(x) = 1,p\u00141/2; (3.7)\nα(x) =c+ (1\u0000c)\u00121\u0000p\np\u0013x\n,p> 1/2, (3.8)\n其中 ,0\u0014c\u00141.如果p\u00141/2 ,上述解不满足 (3.3 ).故马氏链常返 .对于\np>1/2 ,取c= 0 ,即可得到满足 (3.1 ), ( 3.2 ), ( 3.3 )和(3.4 )的函数\nα(x) =\u00121\u0000p\np\u0013x\n.\n所以 ,当p>1/2时,马氏链非常返 .\n第 3.4节 正常返和零常返\n回忆一个状态 x是常返的 ,如果\nPx(Tx<+1) = 1,36 第三章 可数状态马氏链\n其中 ,\nTx= inffn\u00151 :Xn=xg.\n如果Ex(Tx)<+1,那么 ,特别的 ,Px(Tx<+1) = 1 .\n定义 3.4.1 (正常返和零常返 ).如果Ex(Tx)<+1,那么 ,我们称x是正常\n返的 .否则 ,如果Px(Tx<+1) = 1 ,但是Ex(Tx) = + 1,我们称x是零常\n返的 .\n例 3.8.对于有限状态的不可约马氏链 ,每个状态都是正常返的 .这是因\n为此时的不可约马氏链一定有平稳分布 π,其中 ,8x2S,π(x)>0.而\nEx(Tx) = 1/π(x).\n我们将给出正常返和零常返的区分方法 ,并说明互通的状态有相同的\n正/零常返类型 .\n接下来 ,我们先考虑不可约马氏链 .假设状态x是一个正常返的状态", "知道解可以写成\nα(x) = 1,p\u00141/2; (3.7)\nα(x) =c+ (1\u0000c)\u00121\u0000p\np\u0013x\n,p> 1/2, (3.8)\n其中 ,0\u0014c\u00141.如果p\u00141/2 ,上述解不满足 (3.3 ).故马氏链常返 .对于\np>1/2 ,取c= 0 ,即可得到满足 (3.1 ), ( 3.2 ), ( 3.3 )和(3.4 )的函数\nα(x) =\u00121\u0000p\np\u0013x\n.\n所以 ,当p>1/2时,马氏链非常返 .\n第 3.4节 正常返和零常返\n回忆一个状态 x是常返的 ,如果\nPx(Tx<+1) = 1,36 第三章 可数状态马氏链\n其中 ,\nTx= inffn\u00151 :Xn=xg.\n如果Ex(Tx)<+1,那么 ,特别的 ,Px(Tx<+1) = 1 .\n定义 3.4.1 (正常返和零常返 ).如果Ex(Tx)<+1,那么 ,我们称x是正常\n返的 .否则 ,如果Px(Tx<+1) = 1 ,但是Ex(Tx) = + 1,我们称x是零常\n返的 .\n例 3.8.对于有限状态的不可约马氏链 ,每个状态都是正常返的 .这是因\n为此时的不可约马氏链一定有平稳分布 π,其中 ,8x2S,π(x)>0.而\nEx(Tx) = 1/π(x).\n我们将给出正常返和零常返的区分方法 ,并说明互通的状态有相同的\n正/零常返类型 .\n接下来 ,我们先考虑不可约马氏链 .假设状态x是一个正常返的状态 .\n根据有限马氏链的结果 ,我们猜测马氏链有一个平稳分布 π.通过给出此平\n稳分布的等价表达式 ,我们可以看到平稳分布的唯一性 .\n假设马氏链的初始分布是 π.回忆Y(y,M ) =PM\nn=0IfXn=yg.那么 ,\n我们有\nE\u0012Y(y,M )\nM+ 1\u0013\n=π(y).\n对于k\u00151,令Tk表示马氏链第 k次到达x的时间 .用N=Y(x,M )表示\n直到时刻M ,马氏链到达状态 x的总次数 .那么 ,我们有\nTN\u0014M <T N+1.\n记T0= 0 .定义Zi(y) =PTi+1−1\nn=TiIfXn=yg.那么 ,Zi(y)表示从时刻 Ti开\n始到时刻Ti+1\u00001为止 ,马氏链访问状态 y的次数 .那么 ,我们有\nPN−1\nk=1Zi(y)\nT1+PN\nk=1(Tk+1\u0000Tk)\u0014Y(y,M )\nM+ 1\u0014T1+PN\nk=1Zi(y)PN−1\nk=1(Tk+1\u0000Tk). (3.9)\n注意到T2\u0000T1,T3\u0000T2,...独立同分布 ,公有期望为 Ex(Tx).而Z1(y),Z2(y),...\n也独立同分布 ,公有期望为 Ex(PTx−1\nn=0IfXn=yg).注意到当M趋于无穷\n时,N也趋于无穷 .利用大数定律 , (3.9 )的上下界的极限都是\nEx Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).第 3.4节 正常返和零常返 37\n所以 ,我们有\nlim\nM→∞Y(y,M )/(M+ 1) =Ex Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).\n而E\u0010\nY(y,M )\nM+1\u0011\n=π(y).故对Y(y,M )/(M+ 1)应用有界收敛定理 ,得到\nπ(y) =Ex Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).\n于是 ,我们证明了如下命题 :\n命题 3.4.1.考虑一个可数状态空间上的不可约马氏链 .假设状态x是正常\n返的 .那么 ,如果马氏链有平稳分布 π,那么 ,π一定有如下表达\nπ(y) =Ex Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).\n接下来的问题是上述命题中提供的平稳分布的唯一选项是否确实是平\n稳分布 ?答案是肯定的 .\n命题 3.4.2.考虑一个可数状态空间上的不可约马氏链 .假设状态x是正常\n返的 .定义\nπ(y) =Ex Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).\n那么 ,π(y)确实是平稳分布 .\n证明 .令µx(y) =Ex\u0010PTx−1\nn=0IfXn=yg\u0011\n.那么 ,注意到\nEx(Tx) =X\nyµx(y).\n所以 ,π确实是一个概率分布 .接下来 ,我们只需要证明 :\nµx(y) =X\nz∈Sµx(z)p(z,y).\n为此 ,定义\nµx(z,y) =Ex Tx−1X\nn=0IfXn=z,X n+1=yg!\n.38 第三章 可数状态马氏链\n注意到\nX\nzµx(z,y) =Ex Tx−1X\nn=0IfXn+1=yg!\n=Ex TxX\nn=1IfXn=yg!\n=Ex Tx−1X\nn=0IfXn=yg!\n=µx(y).\n另一方面 ,根据 F ubini定理 ,我们有\nµx(z,y) =+∞X\nn=0Px(n<T x,Xn=z,X n+1=y).\n注意到Tx>n和Xn=z只和X0,X1,...,X n有关 .所以 ,在时刻n使用\n马氏性 ,可得\nPx(n<T x,Xn=z,X n+1=y) =p(z,y)Px(n<T x,Xn=z).\n所以 ,对n求和并再次使用 F ubini定理 ,我们有\nµx(z,y) =p(z,y)µx(z).\n综上 ,我们有\nµx(y) =X\nzµx(z,y) =X\nzµx(z)p(z,y).\n命题得证 .\n注 3.4.3.仔细考察命题 3.4.2的证明 ,我们实际上证明了如下结论 :考虑一\n个可数状态空间上的不可约马氏链 .假设状态x是常返的.定义\nµx(y) =Ex Tx−1X\nn=0IfXn=yg!\n.\n那么 ,µx(y)是平稳测度 ,即\nµx(y) =X\nzµx(z)p(z,y).第 3.4节 正常返和零常返 39\n当x是正常返时 ,µx(\u0001)是有限测度 ,总质量是Ex(Tx),可以归一化为平稳分\n布.一般情况下 ,只能知道µx是σ-有限的 .等价的 ,8y2S,µx(y)<+1.\n这是因为\n1 =µx(x) =X\nzµx(z)pm(z,x).\n利用马氏链的不可约性 ,对于任何z2S,存在m\u00150,使得pm(z,x)>0.\n故,8z2S,µx(z)<+1.\n综合命题 3.4.1", " Tx−1X\nn=0IfXn=yg!\n=µx(y).\n另一方面 ,根据 F ubini定理 ,我们有\nµx(z,y) =+∞X\nn=0Px(n<T x,Xn=z,X n+1=y).\n注意到Tx>n和Xn=z只和X0,X1,...,X n有关 .所以 ,在时刻n使用\n马氏性 ,可得\nPx(n<T x,Xn=z,X n+1=y) =p(z,y)Px(n<T x,Xn=z).\n所以 ,对n求和并再次使用 F ubini定理 ,我们有\nµx(z,y) =p(z,y)µx(z).\n综上 ,我们有\nµx(y) =X\nzµx(z,y) =X\nzµx(z)p(z,y).\n命题得证 .\n注 3.4.3.仔细考察命题 3.4.2的证明 ,我们实际上证明了如下结论 :考虑一\n个可数状态空间上的不可约马氏链 .假设状态x是常返的.定义\nµx(y) =Ex Tx−1X\nn=0IfXn=yg!\n.\n那么 ,µx(y)是平稳测度 ,即\nµx(y) =X\nzµx(z)p(z,y).第 3.4节 正常返和零常返 39\n当x是正常返时 ,µx(\u0001)是有限测度 ,总质量是Ex(Tx),可以归一化为平稳分\n布.一般情况下 ,只能知道µx是σ-有限的 .等价的 ,8y2S,µx(y)<+1.\n这是因为\n1 =µx(x) =X\nzµx(z)pm(z,x).\n利用马氏链的不可约性 ,对于任何z2S,存在m\u00150,使得pm(z,x)>0.\n故,8z2S,µx(z)<+1.\n综合命题 3.4.1和命题 3.4.2 ,我们得到如下结果 :\n定理 3.4.4.考虑一个可数状态空间上的不可约马氏链 .假设状态x是正常\n返的 .那么 ,马氏链有唯一的平稳分布 π.其中 ,π有如下表达\nπ(y) =Ex Tx−1X\nn=0IfXn=yg!\n/Ex(Tx).\n接下来 ,我们继续考虑一个可数状态空间上的不可约马氏链 .假设马氏\n链有平稳分布 π,那么 ,利用不可约性 ,可以证明 8x2S,π(x)>0.和有限\n状态马氏链的情形类似 (参见 2.4节),那么 ,所有状态都是正常返的 ,并且 ,从\nx出发到首次返回 x的间隔的期望等于 π(x)的倒数 .\n定理 3.4.5.考虑一个可数状态空间上的不可约马氏链 .假设马氏链有平稳\n分布π.那么 ,所有状态都是正常返的 .更进一步的 ,我们有\nEx(Tx) = 1/π(x).\n证明 .考虑从平稳分布 π出发的马氏链 .那么 ,8n\u00151,我们有\nπ(x) =X\nyπ(y)pn(y,x).\n至少存在一个 y,使得π(y)>0.利用不可约性 ,8x,9n\u00151使得pn(y,x)>\n0,从而\nπ(x) =X\nyπ(y)pn(y,x)>0.\n记Y(x,M ) =PM\nn=0IfXn=xg.那么 ,一方面 ,利用平稳性 ,我们有\nπ(x) =E(Y(x,M ))/(M+ 1).40 第三章 可数状态马氏链\n另一方面 ,考虑接连返回 x的时刻 ,利用不可约性、强马氏性和强大数定律 ,\n我们有\nlim\nM→∞E(Y(x,M ))/(M+ 1) = 1/Ex(Tx).\n综合这两点即可得证 .\n结合定理 3.4.4和定理 3.4.5 ,我们有如下推论 :\n推论 3.4.6.考虑一个可数状态空间上的不可约马氏链 .那么 ,以下三个命\n题等价 :\n1.存在x2S,x正常返 .\n2.存在平稳分布 .\n3.8x2S,x正常返 .\n回忆常返性是个互通等价类的性质 ,即若x和y互通 ,那么 ,x常返等\n价于y常返 .利用推论 3.4.6 ,不难发现 ,正常返也是互通等价类的性质 ,即若\nx和y互通 ,那么 ,x正常返等价于 y正常返 .\n命题 3.4.7.考虑一个可数状态空间上的马氏链 .假设x和y互通 ,那么 ,x\n正常返等价于 y正常返 .\n接下来 ,我们考虑零常返的情形 .由于常返和正常返都是互通等价类的\n性质 ,所以 ,零常返也是 ,即若x和y互通 ,则x零常返等价于 y零常返 .接\n下来 ,我们考虑一个可数状态空间上的不可约零常返的马氏链 .那么 ,根据\n注3.4.3 ,该马氏链有一个平稳测度 µx(\u0001),其中 ,\nµx(y) =Ex Tx−1X\nn=0IfXn=yg!\n.\n根据推论 3.4.6 ,由于马氏链不是正常返的 ,所以 ,不存在平稳分布 .故µx(\u0001)\n不是有限测度 ,即X\nyµx(y) = + 1.\n另一方面 ,如果马氏链是正常返的 ,µx(\u0001)是有限测度 ,总质量为P\nyµx(y) =\nE(TxjX0=x)<+1.所以 ,我们可以根据P\nyµx(y)的有限性区分正常返\n和零常返 .有时 ,直接计算µx(y)比较复杂 ,然而 ,却容易得到一个马氏链的\n平稳测度ν.自然的 ,我们关心µx和ν的区别 ,关心平稳测度在某种意义下第 3.4节 正常返和零常返 41\n的唯一性 .若平稳测度唯一 ,那么 ,可以从容易得到的 ν推知µx(y),进而判\n断马氏链是正常返还是零常返的 .经过简单的思考 ,我们发现平稳测度并不\n是唯一的 ,一个平稳测度的常数倍一定也是平稳测度 .但是 ,可以证明任何\n两个平稳测度一定差个常数倍 .\n命题 3.4.8.考虑一个可数状态空间上的不可约常返马氏链 .假设ν是σ-有\n限的平稳测度 .那么 ,\nν(y) =ν(x)µx(y),8y2S.\n证明 .注意到\nν(y) =X\nzν(z)pn(z,y).\n所以 ,我们有\nν(y) =X\nzν(z)Pz(Xn=y).\n注意到\nPz(Xn=y) =Pz(Xn=y,Tx>n)\n+Pz(Xn=y,Tx", "4.6 ,由于马氏链不是正常返的 ,所以 ,不存在平稳分布 .故µx(\u0001)\n不是有限测度 ,即X\nyµx(y) = + 1.\n另一方面 ,如果马氏链是正常返的 ,µx(\u0001)是有限测度 ,总质量为P\nyµx(y) =\nE(TxjX0=x)<+1.所以 ,我们可以根据P\nyµx(y)的有限性区分正常返\n和零常返 .有时 ,直接计算µx(y)比较复杂 ,然而 ,却容易得到一个马氏链的\n平稳测度ν.自然的 ,我们关心µx和ν的区别 ,关心平稳测度在某种意义下第 3.4节 正常返和零常返 41\n的唯一性 .若平稳测度唯一 ,那么 ,可以从容易得到的 ν推知µx(y),进而判\n断马氏链是正常返还是零常返的 .经过简单的思考 ,我们发现平稳测度并不\n是唯一的 ,一个平稳测度的常数倍一定也是平稳测度 .但是 ,可以证明任何\n两个平稳测度一定差个常数倍 .\n命题 3.4.8.考虑一个可数状态空间上的不可约常返马氏链 .假设ν是σ-有\n限的平稳测度 .那么 ,\nν(y) =ν(x)µx(y),8y2S.\n证明 .注意到\nν(y) =X\nzν(z)pn(z,y).\n所以 ,我们有\nν(y) =X\nzν(z)Pz(Xn=y).\n注意到\nPz(Xn=y) =Pz(Xn=y,Tx>n)\n+Pz(Xn=y,Tx\u0014n).\n在Tx\u0014n的情况下 ,考虑最后一次访问 x的时刻 :\nPz(Xn=y,Tx\u0014n)\n=nX\nk=0Pz(Xk=x,8m=k+ 1,k+ 2,...,n,X m6=x,X n=y)\n=nX\nk=0Pz(Xk=x)\n\u0002Px(8m=k+ 1,k+ 2,...,n,X m6=x,X n=y)\n=nX\nk=0pk(z,x)Px(8m= 1,2,...,n \u0000k,X m6=x,X n−k=y)\n=nX\nk=0pk(z,x)Px(Tx>n\u0000k,X n−k=y).\n接下来 ,我们有\nX\nzν(z)Pz(Xn=y,Tx\u0014n)42 第三章 可数状态马氏链\n=nX\nk=0X\nzν(z)pk(z,x)Px(Tx>n\u0000k,X n−k=y)\n=ν(x)nX\nk=0Px(Tx>n\u0000k,X n−k=y)\n=νxnX\nk=0Px(Tx>k,X k=y).\n所以 ,对于任意的 n\u00150,我们有\nν(y) =X\nzν(z)Pz(Xn=y)\u0015ν(x)nX\nk=0Px(Tx>k,X k=y)n→∞!ν(x)µx(y).\n所以 ,对于任意的 y,我们有\nν(y)\u0015ν(x)µx(y).\n利用上述不等式 ,µx(x) =P\nyµx(y)pn(y,x)和µx(x) = 1 ,我们有\nν(x) =X\nyν(y)pn(y,x)\u0015X\nyν(x)µx(y)pn(y,x) =ν(x)µx(x) =ν(x).\n由于等式取到 ,所以 ,对于任意的 n和y,\nν(y)pn(y,x) =ν(x)µx(y)pn(y,x).\n由于马氏链不可约 ,对于任意的 y,存在n,使得pn(y,x)>0.所以 ,必然有\nν(y) =ν(x)µx(y).\n综合上述讨论 ,对于不可约常返链 ,一定存在平稳测度 .而一旦我们找\n到一个平稳测度 ,那么 ,这个平稳测度总质量的有限性可以帮助我们区分正\n常返和零常返 .\n命题 3.4.9.考虑可数状态空间上的一个不可约常返马氏链 .如果存在一个\nσ-有限但是总质量无限的平稳测度 ν,那么 ,该马氏链是零常返的 .反之亦\n然,即若马氏链零常返 ,那么 ,可以找到一个 σ-有限但是总质量无限的平稳\n测度ν.\n例 3.9.考虑Zd(d= 1,2)上的简单随机游走 .我们前面证明了这个随机游\n走是常返的 .可以证明 Zd上的均匀测度是个平稳测度 .所以 ,其上的简单随\n机游走是零常返的 .第 3.4节 正常返和零常返 43\n注 3.4.10. 不可约非常返的马氏链也可以有平稳测度 .例如 ,对于d\u00153,\nZd上的简单随机游走是不可约非常返的 ,而均匀测度是平稳测度 .\n如果马氏链不是不可约的 ,那么 ,情况更为复杂 .但是 ,我们有如下结果 :\n命题 3.4.11.如果ν是马氏链的平稳 分布 ,那么 ,如果ν(x)>0,那么 ,x是\n正常返的 .\n例 3.10.再次考虑有部分反射壁的随机游走 .前面已经说明 ,这个马氏链\n是不可约的 .如果p > 1/2 ,那么 ,马氏链是非常返的 .接下来 ,我们考虑\np\u00141/2的情形 ,也就是常返的情形 .为了判断是正常返还是零常返 ,我们求\n其平稳测度 ν.对于一维集合 Z≥0上最邻近随机游走 ,我们使用细致平衡方\n程进行求解 :注意到如果细致平衡方程\nν(x)p(x,y) =ν(y)p(y,x)\n成立 ,那么 ,对x求和可以发现 ν必然是平稳测度 .因此 ,我们转而求解细\n致平衡方程 .由于游走是最邻近转移的 ,我们只需要求解\nν(x)p(x,x+ 1) =ν(x+ 1)p(x+ 1,x),\n即,\n(1\u0000p)ν(x+ 1) =pν(x).\n这个方程有解如下 :\nν(x) =\u0012p\n1\u0000p\u0013x\n.\np= 1/2时,ν的总质量等于无穷 ,所以 ,游走是零常返的 .而p<1/2时,ν\n的总质量有限 ,故此时游走是正常返的 .\n上述细致平衡方法可以应用到其他一维最近邻随机游走的平稳测度的\n计算上 .\n例 3.11.令状态空间 S=f0,1,...g.定义转移概率 p(0,1) =a0,p(0,0) =\n1\u0000a0,\np(n,n+ 1) =an,p(n,n\u00001) =bn,p(n,n) = 1\u0000an\u0000bn,n\u00151.\n那么 ,根据细致平衡方程 ,可以得到一个平稳测度 :\nν(n) =a", " .前面已经说明 ,这个马氏链\n是不可约的 .如果p > 1/2 ,那么 ,马氏链是非常返的 .接下来 ,我们考虑\np\u00141/2的情形 ,也就是常返的情形 .为了判断是正常返还是零常返 ,我们求\n其平稳测度 ν.对于一维集合 Z≥0上最邻近随机游走 ,我们使用细致平衡方\n程进行求解 :注意到如果细致平衡方程\nν(x)p(x,y) =ν(y)p(y,x)\n成立 ,那么 ,对x求和可以发现 ν必然是平稳测度 .因此 ,我们转而求解细\n致平衡方程 .由于游走是最邻近转移的 ,我们只需要求解\nν(x)p(x,x+ 1) =ν(x+ 1)p(x+ 1,x),\n即,\n(1\u0000p)ν(x+ 1) =pν(x).\n这个方程有解如下 :\nν(x) =\u0012p\n1\u0000p\u0013x\n.\np= 1/2时,ν的总质量等于无穷 ,所以 ,游走是零常返的 .而p<1/2时,ν\n的总质量有限 ,故此时游走是正常返的 .\n上述细致平衡方法可以应用到其他一维最近邻随机游走的平稳测度的\n计算上 .\n例 3.11.令状态空间 S=f0,1,...g.定义转移概率 p(0,1) =a0,p(0,0) =\n1\u0000a0,\np(n,n+ 1) =an,p(n,n\u00001) =bn,p(n,n) = 1\u0000an\u0000bn,n\u00151.\n那么 ,根据细致平衡方程 ,可以得到一个平稳测度 :\nν(n) =a0a1\u0001 \u0001 \u0001an−1\nb1b2\u0001 \u0001 \u0001bn.44 第三章 可数状态马氏链\n细致平衡算法还可以应用到某些一维最近邻游走的变形的平稳测度的\n计算上 .\n问题 .考虑S=f0,1,...g上的马氏链 ,转移概率p(0,0) = 1/3 ,p(0,1) =\n1/3 ,p(0,2) = 1/3 ,p(1,0) = 1/3 ,p(1,1) = 1/3 ,p(1,2) = 1/3 ,p(2,1) = 1/2 ,\np(n,n+ 1) =p(n+ 1,n) = 1/2,n\u00152.\n(提示 .利用细致平衡条件解出 ν(2),ν(3),... ,然后 ,根据平稳分布的定义解\n出ν(0),ν(1) .)\n第 3.5节 不可约正常返链的极限定理\n在本节中 ,我们考虑可数状态空间上不可约正常返链的极限定理 .我们\n首先考虑非周期的情形 .\n定理 3.5.1.考虑可数状态空间上的不可约非周期正常返马氏链 .那么 ,存\n在唯一的平稳分布 π,并且\nlim\nn→∞pn(x,y) =π(y),8x,y2S.\n证明的技巧在于构造并利用平稳马氏链和从 x出发的马氏链的耦合 .\n证明 .首先 ,我们构造状态空间 S\u0002S上的一个马氏链 (Xn,Yn)n≥0,其转移\n概率为\nq((x1,y1),(x2,y2)) =p(x1,x2)p(y1,y2).\n我们假设X0=x,而Y0的分布是平稳分布 π.那么 ,(Xn)n≥0和(Yn)n≥0是\n两个独立的转移概率同为 p的马氏链 .其中 ,Xn是从x出发的马氏链 ,而\nYn是平稳马氏链 .定义相遇时刻\nT= inffn\u00150 :Xn=Yng.\n构造第三个马氏链 (Zn)n≥0:\nZn=(\nXn,n\u0014T;\nYn,n\u0015T.\n可以验证 (Zn)n≥0和(Xn)n≥0同分布 ,也是从x出发的马氏链 .实际上 ,我\n们有\nP(Z0=x0,Z1=x1,...,Z n=xn)第 3.5节 不可约正常返链的极限定理 45\n=nX\nk=0P(T=k,Z 0=x0,Z1=x1,...,Z n=xn)\n+P(T >n,Z 0=x0,Z1=x1,...,Z n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=xk,Yk+1=xk+1,...,Y n=xn)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=Yk=xk)\n\u0002P(Yk+1=xk+1,...,Y n=xnjXk=Yk=xk)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=Yk=xk)\n\u0002P(Yk+1=xk+1,...,Y n=xnjYk=xk)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=xk)\n\u0002P(Xk+1=xk+1,...,X n=xnjXk=xk)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=xk,Xk+1=xk+1,...,X n=xn)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=P(X0=x0,X1=x1,...,X n=xn).\n接下来 ,注意到\npn(x,y) =P(Xn=y) =P(Zn=y),ν(y) =P(Yn=y).\n所以 ,我们有\njpn(x,y)\u0000ν(y)j=jP(Zn=y)\u0000P(Yn=y)j\n=jP(Zn=y,T >n )\u0000P(Yn=y,T >n )j \u00142P(T >n ).\n所以 ,只需要证明 P(T < +1) = 1 ,即可有 limn→∞P(T > n ) = 0 .为此 ,\n注意到 (Xn,Yn)n≥0是不可约的马氏链 .实际上 ,任取x,y, ˜x,˜y2S,利用独46 第三章 可数状态马氏链\n立性 ,我们有\nP(Xn= ˜x,Yn= ˜yjX0=x,Y 0=y) =P(Xn= ˜xjX0=x)P(Yn= ˜yjY0=y).\n由于 (Xn)n≥0和(Yn)n≥0都是不可约非周期的 ,所以 ,存在N=N(x,˜x),\nM=M(y,˜y),对于任意的 n\u0015N,P(Xn= ˜xjX0=x)>0,对于任意的\nn\u0015M ,P(Yn= ˜yjY0=y)>0.因此 ,对于充分大的 n,总有P(Xn=\n˜x,Yn= ˜yjX0=x,Y 0=y)>0.这说明 (Xn,Yn)n≥0是不可约非周期马氏链 .\n定义 Π(x,y) =π(x)π(y),x,y2S.那么 ,Π(x,y)是(Xn,Yn", "1,...,X n=xn)\n=nX\nk=0P(T=k,X 0=x0,...,X k=xk,Xk+1=xk+1,...,X n=xn)\n+P(T >n,X 0=x0,X1=x1,...,X n=xn)\n=P(X0=x0,X1=x1,...,X n=xn).\n接下来 ,注意到\npn(x,y) =P(Xn=y) =P(Zn=y),ν(y) =P(Yn=y).\n所以 ,我们有\njpn(x,y)\u0000ν(y)j=jP(Zn=y)\u0000P(Yn=y)j\n=jP(Zn=y,T >n )\u0000P(Yn=y,T >n )j \u00142P(T >n ).\n所以 ,只需要证明 P(T < +1) = 1 ,即可有 limn→∞P(T > n ) = 0 .为此 ,\n注意到 (Xn,Yn)n≥0是不可约的马氏链 .实际上 ,任取x,y, ˜x,˜y2S,利用独46 第三章 可数状态马氏链\n立性 ,我们有\nP(Xn= ˜x,Yn= ˜yjX0=x,Y 0=y) =P(Xn= ˜xjX0=x)P(Yn= ˜yjY0=y).\n由于 (Xn)n≥0和(Yn)n≥0都是不可约非周期的 ,所以 ,存在N=N(x,˜x),\nM=M(y,˜y),对于任意的 n\u0015N,P(Xn= ˜xjX0=x)>0,对于任意的\nn\u0015M ,P(Yn= ˜yjY0=y)>0.因此 ,对于充分大的 n,总有P(Xn=\n˜x,Yn= ˜yjX0=x,Y 0=y)>0.这说明 (Xn,Yn)n≥0是不可约非周期马氏链 .\n定义 Π(x,y) =π(x)π(y),x,y2S.那么 ,Π(x,y)是(Xn,Yn)n≥0的平稳分\n布.根据推论 3.4.6 ,(Xn,Yn)n≥0是正常返的 .由于 (Xn,Yn)n≥0是不可约的 ,\n无论从何种初始分布出发 ,对于任意的 x2S,马氏链 (Xn,Yn)n≥0都会在有\n限的时间内访问状态 (x,x).因此 ,P(T < +1) = 1 .\n进一步的 ,类似于有限马氏链的证明 ,我们可以得到周期情形下的极限\n定理 :\n定理 3.5.2.考虑可数状态空间上的不可约正常返马氏链 .那么 ,存在唯一\n的平稳分布 π,并且\nlim\nn→∞1\nddX\nk=1pn+k(x,y) =π(y),8x,y2S.\n第 3.6节 分支过程\n考虑一个群体增长的随机模型 .我们用Xn表示时刻n时,群体中的个\n体数 .到n+ 1时刻 ,每个个体随机产生一定随机数量的后代 .产生后代后 ,\n上一代的个体生命结束 ,离开群体 .我们对后代产生的过程做两个假设 :\n1.每个个体产生的后代数目同分布 ,恰好产生k个后代的概率是 pk.\n2.每个个体产生的后代数目独立 .\n那么 ,(Xn)n≥0是状态空间 S=Z≥0上的马氏链 .其转移概率\np(i,j) =P(Y1+Y2+\u0001 \u0001 \u0001+Yi=j),\n其中 ,Y1,Y2,...独立同分布 ,并且P(Y1=k) =pk.这个马氏链不是不可约\n的,0是吸收态 .如果Xn= 0 ,那么 ,8m\u0015n,Xm= 0 .我们关心群体灭绝\n这一事件E:\nE=f9n\u00150 :Xn= 0g,第 3.6节 分支过程 47\n它表示马氏链被 0吸收 .\n我们令µ=P+∞\nk=0kpk.那么 ,µ表示每个个体后代数量的期望 .那么 ,\n根据重期望公式 ,我们有\nEXn+1=E(E(Xn+1jXn))\n=E +∞X\nj=0jp(Xn,j)!\n=E(XnE(Y1))\n=µEX n.\n故,EXn=µnEX 0.如果µ<1,那么 , lim n→∞EXn= 0 .而,P(Xn\u00151)\u0014\nEXn.所以 , lim n→∞P(Xn\u00151) = 0 .故,P(E) =P([nfXn= 0g) = 1 ,\n即以概率 1,群体必然灭绝 .当µ= 1时,群体规模的期望值保持不变 ;当\nµ>1时,群体规模的期望值指数增长 .此时 ,我们不能清楚的看到群体灭绝\n的概率 .\n为了避免平凡的情况 ,我们假设\np0>0,p0+p1<1.\n不失一般性的 ,我们假设X0= 1 .\n注意到我们总有\nP(E) =P([nfXn= 0g) = lim\nn→∞P(Xn= 0).\n因此 ,灭绝概率和 Xn的分布有关 .我们考虑Xn的分布列的生成函数\nϕXn(s):\nϕXn(s)≜E(sXn).\n那么 ,我们有\nϕXn+1(s) =E(sXn+1)\n=E(E(sXn+1jXn))\n=E(f(s)Xn)\n=ϕXn(f(s)),\n其中 ,f(s) =E(sY1) =P+∞\nk=0pksk是个体后代数的母函数 .因此 ,我们有\nϕXn(s) =f\u000ef\u000e \u0001 \u0001 \u0001 \u000ef|{z}\nn个(s).48 第三章 可数状态马氏链\n而我们有\nP(Xn= 0) =ϕXn(0) =f\u000ef\u000e \u0001 \u0001 \u0001 \u000ef|{z}\nn个(0).\n所以 ,P(E)等于 0在映射f的迭代映射下的极限 .为此 ,我们关心映射 f\n的动力学性质 .我们将f的分析学性质总结如下 :\n命题 3.6.1.假设p0>0,p0+p1<1.那么 ,f(0)>0,f(1) = 1 ,f′(1) =µ,\nf在[0,1]上连续 ,f在[0,1]上严格单调增 ,并且f在[0,1]上严格凸 .\n证明 .f(1) =E(1Y1) = 1 .f(0) =P(Y1= 0) =p0>0.由控制收敛\n定理 ,f在[0,1]上连续 .对于s > 0,f′(s) =P+∞\nk=1kpksk−1>0,所以 ,\nf在[0,1]上严格单调增 .另外 ,f′(1) =P+∞\nk=1kpk=µ.对于s > 0,\nf′′(s) =P+∞\nk=2k(k\u00001)pksk−2>0,所以 ,f在[0,1]上严格凸 .\n当µ\u00141时,利用f的性质 ,知道f在[0,1]上只有一个不动点 ,该不\n动点是 1,且该不", "=ϕXn(f(s)),\n其中 ,f(s) =E(sY1) =P+∞\nk=0pksk是个体后代数的母函数 .因此 ,我们有\nϕXn(s) =f\u000ef\u000e \u0001 \u0001 \u0001 \u000ef|{z}\nn个(s).48 第三章 可数状态马氏链\n而我们有\nP(Xn= 0) =ϕXn(0) =f\u000ef\u000e \u0001 \u0001 \u0001 \u000ef|{z}\nn个(0).\n所以 ,P(E)等于 0在映射f的迭代映射下的极限 .为此 ,我们关心映射 f\n的动力学性质 .我们将f的分析学性质总结如下 :\n命题 3.6.1.假设p0>0,p0+p1<1.那么 ,f(0)>0,f(1) = 1 ,f′(1) =µ,\nf在[0,1]上连续 ,f在[0,1]上严格单调增 ,并且f在[0,1]上严格凸 .\n证明 .f(1) =E(1Y1) = 1 .f(0) =P(Y1= 0) =p0>0.由控制收敛\n定理 ,f在[0,1]上连续 .对于s > 0,f′(s) =P+∞\nk=1kpksk−1>0,所以 ,\nf在[0,1]上严格单调增 .另外 ,f′(1) =P+∞\nk=1kpk=µ.对于s > 0,\nf′′(s) =P+∞\nk=2k(k\u00001)pksk−2>0,所以 ,f在[0,1]上严格凸 .\n当µ\u00141时,利用f的性质 ,知道f在[0,1]上只有一个不动点 ,该不\n动点是 1,且该不动点稳定 .当µ>1时,利用f的性质 ,知道f在[0,1]上\n有两个不动点 .其中 ,1是不稳定不动点 ,另一个不动点是稳定不动点 .令ρ\n是映射f的最小的非负不动点 .那么 ,可以证明 0在映射f的迭代下的极\n限就是ρ.于是我们得到灭绝概率的如下结论 :\n定理 3.6.2.假设X0= 1 ,p0>0,p0+p1<1.那么 ,灭绝概率P(E) =ρ,\n其中 ,ρ是映射f的最小的非负不动点 .当µ\u00141时,ρ= 1 ;当µ> 1时,\nρ<1.第四章 连续时间马氏链\n第 4.1节 泊松过程\n考虑某段时间到达某个服务器的访问数 .用N(t)表示 [0,t)时刻到来\n的访问数 .那么 ,这是一个连续时间的随机过程 ,一般用泊松过程建模 .泊松\n过程 (N(t))t≥0是一类偶发事件的计数过程 ,其中 ,N(t)表示 (0,t]时间段\n内偶然事件的发生次数 .对于此过程我们一般有如下假设 :\n1.事件发生的速率是时齐的 .\n2.不同时间段内事件的发生是互不影响的 .\n3.不可能有两个以上的事件在同一时刻发生 .\n在数学上 ,我们对泊松过程 N(t)做如下假设 :\n1.N(0) = 0 .\n2.8t\u00150,N(t)2Z≥0.\n3.N(t+s)\u0000N(s)的分布和s无关 .\n4.对于s1\u0014t1\u0014s2\u0014t2\u0014 \u0001 \u0001 \u0001sn\u0014tn,N(t1)\u0000N(s1),N(t2)\u0000\nN(s2),...,N (tn)\u0000N(sn)独立 .\n5. limt→0P(N(t)\u00152)/t= 0 ,并且存在某个 λ2(0,+1),使得\nlim\nt→0P(N(t) = 1)/t=λ.\n根据假设 ,泊松过程的有限维分布\nP(N(t1) =n1,N(t2) =n2,...,N (tk) =tk)\n4950 第四章 连续时间马氏链\n可以通过P(N(t) =n)表达 .所以 ,我们首先推导 N(t)的分布 .为此 ,我\n们将时间区间 [0,t)离散化 ,将其分割为等长的 n个小区间 ,第i个小区间\n为[(i\u00001)t/n,it/n).用Xi表示第i个小的时间区间内事件发生的次数 .记\nYi= 1Xi≥1.那么 ,Y1+Y2+\u0001 \u0001 \u0001+Yn服从二项分布 B(n,P(X1\u00151)) .而\nP(X1\u00151)n→∞\u0018λt/n.根据泊松逼近定理 ,当n! 1时,Y1+Y2+\u0001 \u0001 \u0001+Yn\n依分布收敛于参数是 λt的泊松分布 .接下来 ,我们说明Y1+Y2+\u0001 \u0001 \u0001+Yn\n和X1+X2+\u0001 \u0001 \u0001+Xn不同的概率趋于 0:\nP(nX\nk=1Yi6=nX\nk=1Xi)\u0014P(9k,Yk6=Xk)\n\u0014nX\nk=1P(Yk6=Xk)\n\u0014nX\nk=1P(Xk\u00152)\n=nP(X1\u00152)\n=o(1),n! 1.\n而N(t) =X1+X2+\u0001 \u0001 \u0001+Xn.故,可知N(t)服从参数是 λt的泊松分布 :\nP(N(t) =n) =λn\nn!e−λ.\n于是 ,我们得到泊松过程的另一严格定义 :\n定义 4.1.1.泊松过程N(t)是在 [0,+1)上的随机计数过程 ,满足以下条\n件:\n1.N(0) = 0 ;\n2.8t\u00150,N(t)2Z≥0;\n3.t7!N(t)右连续 ;\n4.8t1\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014tn,N(t1),N(t2)\u0000N(t1),...,N (tn)\u0000N(tn−1)独立 ;\n5.9λ>0,P(N(t+s)\u0000N(s) =n) =λn\nn!e−λ.\n接下来 ,我们利用微分方程的方法从原始的定义再次推导出 N(t)的分\n布.该新方法有助于理解连续时间马氏链 .首先 ,我们推导P(N(t) = 0)的\n表达式 :记f0(t) =P(N(t) = 0) .那么 ,我们有第 4.1节 泊松过程 51\nf0(t+h) =P(N(t+h) = 0) =P(N(t) = 0,N(t+h)\u0000N(t) = 0)\n=P(N(t) = 0)P(N(t+h)\u0000N(t) = 0) =f0(t)P(N(h) = 0)\n=f0(t)(1\u0000P(N(h) = 1) \u0000P(N(h)\u00152))\n=f0(t)(1\u0000λh+o(h)) =f0(t)\u0000λf0(t)h+o(h).\n所以 ,我们得到微分方程\nf′\n0(t) =\u0000λf′\n0(t),\n初值条件f0(0) =P(N(0) = 0) = 1 .解得该微分方程的解为\nP(N(t) = 0", "\u0001+Xn.故,可知N(t)服从参数是 λt的泊松分布 :\nP(N(t) =n) =λn\nn!e−λ.\n于是 ,我们得到泊松过程的另一严格定义 :\n定义 4.1.1.泊松过程N(t)是在 [0,+1)上的随机计数过程 ,满足以下条\n件:\n1.N(0) = 0 ;\n2.8t\u00150,N(t)2Z≥0;\n3.t7!N(t)右连续 ;\n4.8t1\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014tn,N(t1),N(t2)\u0000N(t1),...,N (tn)\u0000N(tn−1)独立 ;\n5.9λ>0,P(N(t+s)\u0000N(s) =n) =λn\nn!e−λ.\n接下来 ,我们利用微分方程的方法从原始的定义再次推导出 N(t)的分\n布.该新方法有助于理解连续时间马氏链 .首先 ,我们推导P(N(t) = 0)的\n表达式 :记f0(t) =P(N(t) = 0) .那么 ,我们有第 4.1节 泊松过程 51\nf0(t+h) =P(N(t+h) = 0) =P(N(t) = 0,N(t+h)\u0000N(t) = 0)\n=P(N(t) = 0)P(N(t+h)\u0000N(t) = 0) =f0(t)P(N(h) = 0)\n=f0(t)(1\u0000P(N(h) = 1) \u0000P(N(h)\u00152))\n=f0(t)(1\u0000λh+o(h)) =f0(t)\u0000λf0(t)h+o(h).\n所以 ,我们得到微分方程\nf′\n0(t) =\u0000λf′\n0(t),\n初值条件f0(0) =P(N(0) = 0) = 1 .解得该微分方程的解为\nP(N(t) = 0) =f0(t) =e−λt.\n接下来 ,我们计算P(N(t) =n):记fn(t) =P(N(t) =n).那么 ,根据全概\n率公式 ,我们有\nfn(t+h) =P(N(t+h) =n) =nX\nk=0P(N(t) =n\u0000k)P(N(t+h)\u0000N(t) =k)\n=nX\nk=0P(N(t) =n\u0000k)P(N(h) =k)\n=P(N(t) =n)P(N(h) = 0) +P(N(t) =n\u00001)P(N(h) = 1) +o(h)\n=fn(t)(1\u0000λh+o(h)) +fn−1(t)(λh+o(h)) +o(h)\n=fn(t) +λ(fn−1(t)\u0000fn(t))h+o(h).\n于是 ,我们得到微分方程 :8n\u00151,\nf′\nn(t) =λ(fn−1(t)\u0000fn(t)),fn(0) = 0.\n可以归纳的证明 ,对于n\u00151,\nP(N(t) =n) =fn(t) =λn\nn!e−λ.\n另一种描述泊松过程的方法是考虑事件发生的间隔时间 .用Tn表示\nN(t)首次到达n的时刻 :\n8n\u00151,Tn= infft\u00150 :N(t) =ng.\n那么 ,N(t) =n等价于Tn\u0014t<T n+1.我们可以计算 (T1,T2,...,T n)的联\n合密度函数 f(t1,t2,...,t n).实际上 ,因为每个时刻不能有多于 1个事件发52 第四章 连续时间马氏链\n生,T1,T2,...,T n两两互不相同 .对于任意的 t1<t 2<\u0001 \u0001 \u0001<tn,取h充分\n小,\nf(t1,t2,...,t n)hn\n\u0018P(T12(t1,t1+h],T22(t2,t2+h],...,T n2(tn,tn+h])\n=P0\nBBBB@N(t1) = 0,N(t1+h)\u0000N(t1) = 1,\nN(t2)\u0000N(t1+h) = 0,N(t2+h)\u0000N(t2) = 1,\n...,\nN(tn)\u0000N(tn−1+h) = 0,N(tn+h)\u0000N(tn) = 11\nCCCCA\n=P(N(t1) = 0)P(N(t1+h)\u0000N(t1) = 1)\nP(N(t2)\u0000N(t1+h) = 0)P(N(t2+h)\u0000N(t2) = 1)\n\u0001 \u0001 \u0001\nP(N(tn)\u0000N(tn−1+h) = 0)P(N(tn+h)\u0000N(tn) = 1)\n=e−λ(tn+h)λnhn.\n所以 ,我们有\nf(t1,t2,...,t n) =λne−λtn,tn>tn−1>\u0001 \u0001 \u0001>t 1>0.\n令τ1=T1,τ2=T2\u0000T1,... .那么 ,可以发现τ1,τ2,...独立同分布于\n参数为λ的指数随机变量 .这样 ,我们得到构造泊松过程的新方法 :首\n先,构造独立同分布的参数是 λ的指数随机变量 τ1,τ2,... .定义T0= 0 ,\n8n\u00151,Tn=Pn\ni=1τi.如下定义泊松过程 :8t\u00150,存在唯一的 n使得\nTn\u0014t<T n+1,那么 ,我们定义N(t) =n.\n第 4.2节 有限状态空间\n在本节中 ,我们考虑有限状态空间上的连续时间马氏链 (Xt)t≥0.它有\n两个基本要素 :\n1.转移概率为 q(x,y)的离散马氏链 (Yn)n≥0,\n2.连续等待时间 (τn)n≥0.\n马氏链从某个 (随机的 )状态X0=Y0出发 ,在X0=Y0等待并停留 τ1时\n间,然后 ,跳到Y1.其中 ,τ1的条件分布是参数为 λ(Y0)的指数分布 .然后 ,第 4.2节 有限状态空间 53\n马氏链在Y1等待并停留 τ2时间 ,然后 ,跳到Y2.其中 ,τ2的条件分布是参\n数为λ(Y1)的指数分布 .如此反复 .每当马氏链到达一个新状态 Yn,那么 ,\n它等待并停留 τn+1时间 ,然后 ,跳到Yn+1.其中 ,给定之前的情况 ,即给定\nY0,Y1,...,Y n,τ1,τ2,...,τ n,新的等待时间 τn+1的条件分布是参数为 λ(Yn)\n的指数分布 .我们假设给定离散转移过程 (Yn)n≥0,等待时间 (τn)n≥1是条\n件独立的指数随机变量 ,其中 ,τn的条件分布的参数是 λ(Yn−1).\n同样的 ,我们用Px和Ex分别表示从 x出发的概率和期望 .即,对于任\n意事件A,我们用Px(A)表示P(AjX0=x);对于任意可积的随机变量 Z,\n我们用Ex(Z)表示E(ZjX0=x).\n例 4.1.我们取个特殊的离散马氏链 (Yn)n≥0,其中 ,Yn=n.我们定义函数\nλ(y)的取值恒等于 λ.那么 ,Xt=N(t),其中 ,N(t)是参数为λ的泊松过\n程.\n接下来 ,我们指出这样构造的 (Xt)t≥0具有马氏性 :\n定理 4.2.1.假设Ft=σ(Xu,0\u0014u\u0014t).", "个 (随机的 )状态X0=Y0出发 ,在X0=Y0等待并停留 τ1时\n间,然后 ,跳到Y1.其中 ,τ1的条件分布是参数为 λ(Y0)的指数分布 .然后 ,第 4.2节 有限状态空间 53\n马氏链在Y1等待并停留 τ2时间 ,然后 ,跳到Y2.其中 ,τ2的条件分布是参\n数为λ(Y1)的指数分布 .如此反复 .每当马氏链到达一个新状态 Yn,那么 ,\n它等待并停留 τn+1时间 ,然后 ,跳到Yn+1.其中 ,给定之前的情况 ,即给定\nY0,Y1,...,Y n,τ1,τ2,...,τ n,新的等待时间 τn+1的条件分布是参数为 λ(Yn)\n的指数分布 .我们假设给定离散转移过程 (Yn)n≥0,等待时间 (τn)n≥1是条\n件独立的指数随机变量 ,其中 ,τn的条件分布的参数是 λ(Yn−1).\n同样的 ,我们用Px和Ex分别表示从 x出发的概率和期望 .即,对于任\n意事件A,我们用Px(A)表示P(AjX0=x);对于任意可积的随机变量 Z,\n我们用Ex(Z)表示E(ZjX0=x).\n例 4.1.我们取个特殊的离散马氏链 (Yn)n≥0,其中 ,Yn=n.我们定义函数\nλ(y)的取值恒等于 λ.那么 ,Xt=N(t),其中 ,N(t)是参数为λ的泊松过\n程.\n接下来 ,我们指出这样构造的 (Xt)t≥0具有马氏性 :\n定理 4.2.1.假设Ft=σ(Xu,0\u0014u\u0014t).那么 ,对于任意的有界可测函数\nF,我们有\nE(F(Xt+s,s\u00150)jFt) =G(Xt),\n其中 ,G(x) =Ex(F(Xt,t\u00150)) .\n证明 .对于连续时间马氏链 ,定义J0= 0 .记第一次跳跃时间\nJ1= infft>0 :Xt6=X0g.\n然后归纳的定义第 n次跳跃的时间\nJn= infft>J n−1:Xt6=XJn−1g.\n对于n\u00151,定义第n个等待时间\nτn=Jn\u0000Jn−1.\n对于n\u00150,定义Yn=XJn.用N(t)表示直到t时刻累计的跳跃次数 :\nN(t) = supfn\u00150 :Jn\u0014tg.给定 (Xu)u∈[0,t]相当于给定 N(t)的某个取值\nn\u00150,然后给定τ1=t1,τ2=t2,...,τ n=tn,给定Y0,Y1,...,Y n.为了得\n到(Xu)u≥t,我们还需要知道 Yn+1,Yn+2,... ,需要知道τn+1,τn+2,... .对于\n(Xu)u≥t,其离散跳跃过程由 Yn,Yn+1,...给出 .根据离散马氏链的马氏性 ,54 第四章 连续时间马氏链\n给定Y0,Y1,...,Y n,(Yn+k)k≥0的条件分布由从 Yn开始的离散马氏链给出 .\n对于 (Xu)u≥t,其等待时间依次为Pn\ni=1ti+τn+1\u0000t,τn+2,τn+3,... .给定\n(Yn)n≥0,τn+1+k的条件分布是参数为 λ(Yn+k)的指数分布 .故,我们只需要\n再说明给定 (Xu)u∈[0,t]和(Yn)n≥0,Pn\ni=1ti+τn+1\u0000t服从参数为 λ(Yn)的\n指数分布 .这是因为给定 (Xu)u∈[0,t],我们要求τn+1> t\u0000Pn\ni=1ti.而指数\n分布具有无记忆性 ,所以 ,给定 (Xu)u∈[0,t]和(Yn)n≥0,Pn\ni=1ti+τn+1\u0000t的\n条件分布是 λ(Yn)的指数分布 .最后 ,我们发现 ,给定 (Xu)u∈[0,t],(Xu+t)u≥0\n的条件分布和从 Xt开始的连续时间马氏链相同 .\n接下来 ,令pt(x,y) =Px(Xt=y).那么 ,利用马氏性 ,(Xt)t≥0的有限维\n分布可以由 pt(x,y)给出 :对于t1<t 2<\u0001 \u0001 \u0001<tn,我们有\nP(Xt1=x1,Xt2=x2,...,X tn=xn)\n=P(Xt1=x1,Xt2=x2,...,X tn−1=xn−1)ptn−tn−1(xn−1,xn)\n=X\nx0P(X0=x0)pt1(x0,x1)pt2−t1(x1,x2)\u0001 \u0001 \u0001ptn−tn−1(xn−1,xn).\n所以 ,pt(x,y)对于了解 (Xt)t≥0的分布起着至关重要的作用 .我们希望求解\npt(x,y).对于泊松过程 ,我们建立了 pt(x,y)的微分方程进行求解 .类似的 ,\n我们希望建立 pt(x,y)的微分方程 .我们将证明 pt(x,y)满足向前和向后方\n程,它们来自 [Nor98 ].\n定理 4.2.2 (向后方程 ).pt(x,y)是下列向后方程的唯一解 :\nd\ndtpt(x,y) =X\nz∈Sα(x,z)pt(z,y),p0(x,y) =δx,y.\n其中 ,α(x,z)被称为无穷小生成元 ,由下式给出 :\nα(x,y)≜(\nλ(x)q(x,y),y6=x;\n\u0000λ(x)(1\u0000q(x,x)), y =x.(4.1)\n注 4.2.3.由无穷小生成元的定义 ,我们发现\n1.对于y6=x,α(x,y)\u00150;而α(x,x)\u00140;\n2.P\ny∈Sα(x,y) = 0 .\n定理 4.2.4 (向前方程 ).pt(x,y)是下列向前方程的唯一解 :\nd\ndtpt(x,y) =X\nz∈Spt(x,z)α(z,y),p0(x,y) =δx,y.第 4.2节 有限状态空间 55\n其中 ,α(x,z)是无穷小生成元 .\n我们在本节最后给出向前和向后方程的证明 .接下来 ,我们继续求解\npt(x,y).如果我们把 pt(x,y)写成矩阵形式 Pt,把α(x,y)也写成矩阵形式\nA,那么 ,向后方程可以写成\nd\ndtPt=APt,P0=I,\n其中 ,I表示单位矩阵 ;而向前方程可以写成\nd\ndtPt=PtA,P 0=I.\n利用常微分方程的标准结果 ,上述两个方程的解都是 Pt=etA.\n例 4.2.考虑S=f0,1g上的马氏链 ,其中 ,α(0,1) = 1 ,α(1,0) = 2 .由\n注4.2.3 ,其无穷小生成元的矩阵形式为\nA= \n\u00001 1\n2\u00002!\n.\n转移概率矩阵 Pt=etA.为", "列向后方程的唯一解 :\nd\ndtpt(x,y) =X\nz∈Sα(x,z)pt(z,y),p0(x,y) =δx,y.\n其中 ,α(x,z)被称为无穷小生成元 ,由下式给出 :\nα(x,y)≜(\nλ(x)q(x,y),y6=x;\n\u0000λ(x)(1\u0000q(x,x)), y =x.(4.1)\n注 4.2.3.由无穷小生成元的定义 ,我们发现\n1.对于y6=x,α(x,y)\u00150;而α(x,x)\u00140;\n2.P\ny∈Sα(x,y) = 0 .\n定理 4.2.4 (向前方程 ).pt(x,y)是下列向前方程的唯一解 :\nd\ndtpt(x,y) =X\nz∈Spt(x,z)α(z,y),p0(x,y) =δx,y.第 4.2节 有限状态空间 55\n其中 ,α(x,z)是无穷小生成元 .\n我们在本节最后给出向前和向后方程的证明 .接下来 ,我们继续求解\npt(x,y).如果我们把 pt(x,y)写成矩阵形式 Pt,把α(x,y)也写成矩阵形式\nA,那么 ,向后方程可以写成\nd\ndtPt=APt,P0=I,\n其中 ,I表示单位矩阵 ;而向前方程可以写成\nd\ndtPt=PtA,P 0=I.\n利用常微分方程的标准结果 ,上述两个方程的解都是 Pt=etA.\n例 4.2.考虑S=f0,1g上的马氏链 ,其中 ,α(0,1) = 1 ,α(1,0) = 2 .由\n注4.2.3 ,其无穷小生成元的矩阵形式为\nA= \n\u00001 1\n2\u00002!\n.\n转移概率矩阵 Pt=etA.为了求etA,通常的做法是将 A写成A=QJQ−1,\n其中 ,J是A的 Jordan标准型 .那么 ,etJ很好计算 .另外 ,\netA=+∞X\nn=0(tA)n/n! =+∞X\nn=0tnQJnQ−1/n! =QetJQ−1.\n对于我们的这个例子 ,我们有\nJ= \n0 0\n0\u00003!\n,Q= \n1 1\n1\u00002!\n,Q−1= \n2/3 1/3\n1/3\u00001/3!\n.\n那么 ,我们有\netJ= \n1 0\n0e−3t!\n,Pt=QetJQ−1= \n2/3 1/3\n2/3 1/3!\n+e−3t \n1/3 \u00001/3\n\u00002/3 2/3!\n.\n可以得到\nlim\nt→∞Pt= \nπ\nπ!\n,\n其中 ,π= (2/3,1/3) .我们发现 ,π是Pt的极限分布 .56 第四章 连续时间马氏链\n和离散的情形一样 ,我们可以定义互通关系和不可约性 .只需要将其定\n义为离散过程 (Yn)n≥0的互通关系和不可约性即可 .对于连续时间马氏链 ,\n我们总是认为其非周期 .关于有限状态的连续时间不可约马氏链的极限分\n布,我们有如下结果 :\n定理 4.2.5.考虑一个有限状态的连续时间不可约马氏链 .那么 ,存在唯一\n一个概率分布 π,满足\nlim\nt→∞pt(x,y) =π(y),8x,y2S.\n利用π是pt(\u0001,\u0001)的极限 ,可以验证这里的 π是平稳分布 ,即\nX\nx∈Sπ(x)ps(x,y) =π(y),8s\u00150,8y2S.\n这等价于X\nx∈Sπ(x)α(x,y) = 0,8y2S. (4.2)\n我们把满足 (4.2 )的概率分布 π称为平稳分布 .\n注 4.2.6.需要注意的是 (Xt)t≥0的平稳分布 π并不一定是嵌入的离散马氏\n链(Yn)n≥0的平稳分布 .\n实际上 ,利用线性代数 ,可以验证如下结论 :\n命题 4.2.7.考虑有限状态空间上的不可约马氏链 .那么 ,我们有如下结论 :\n1.存在唯一一个平稳分布 π.\n2.将π表示成行向量形式 ,那么 ,π实际上是A的左特征向量 ,对应的\n特征值为 0.\n3.A的其他特征值的实数部分均严格小于零 .\n许多分析离散时间马氏链的方法对于连续时间马氏链是类似的 .\n最后 ,我们证明向前和向后方程 .为此 ,我们需要引入强马氏性 .为了严\n谨描述马氏性 ,我们需要将停时的定义推广到连续时间随机过程的情形 .考\n虑(Ft)t≥0是一族单调不降的事件域 :8s\u0014t,Fs\u001a F t.我们称之为 域流\n(filtration) .\n定义 4.2.1 (停时 ).如果随机变量 T取值为 [0,+1],满足8t2[0,+1),\n(T\u0014t)2 Ft,那么 ,我们称T是 (关于域流 Ft)的停时 .第 4.2节 有限状态空间 57\n给定一个停时 T,我们如下可以定义 FT:A2 F T当且仅当对于任何\nt2[0,+1),(T\u0014t)\\A2 F t.事件域 FT表示在时刻 T之前发生的事件\n全体 .\n问题 .验证FT是个事件域 .\n问题 .验证T关于FT可测 .\n问题 .验证 1T<∞XT关于FT可测 .\n定理 4.2.8 (强马氏性 ).取Ft=σ(Xu,0\u0014u\u0014t).考虑停时T.对于任何\n有界可测函数 F,我们有\nE(F(Xu+T,u\u00150)jFT)1T<+∞=G(XT)1T<+∞,\n其中 ,我们有G(x) =Ex(F(Xu,u\u00150)) .\n强马氏性表示在 T有限的情形 ,给定T时刻之前发生的事情 ,在T时\n刻开始的过程 (Xu+T)u≥0的条件分布正是从 XT开始的连续时间马氏链的\n分布 .\n利用马氏性 ,我们可以知道 pt的半群性质 :\n命题 4.2.9.\npt+s(x,y) =X\nzpt(x,z)ps(z,y).\n通过半群性质 ,一旦我们知道 pt(x,y)在t= 0处的导数 ,即可表达\npt(x,y)在一般时刻 t时的导数 .我们将证明如下结果 :\n命题 4.2.10.\nd\ndtpt(x,y)\f\f\f\nt=0=α(x,y).\n证明 .首先 ,不难发现 limt→0pt(x,y) =δx,y .接下来 ,用J1表示第一次跳跃\n的时刻 .那么 ,对停时J1用强马氏性 ,我们有\npt(x,y) =Px(Xt=y)\n=Px(Xt=y,J 1>t)\n+X\nzPx(J1\u0014t,XJ1=z,X t=y)\n=δx,ye−λ(x)t+X\nz", " T当且仅当对于任何\nt2[0,+1),(T\u0014t)\\A2 F t.事件域 FT表示在时刻 T之前发生的事件\n全体 .\n问题 .验证FT是个事件域 .\n问题 .验证T关于FT可测 .\n问题 .验证 1T<∞XT关于FT可测 .\n定理 4.2.8 (强马氏性 ).取Ft=σ(Xu,0\u0014u\u0014t).考虑停时T.对于任何\n有界可测函数 F,我们有\nE(F(Xu+T,u\u00150)jFT)1T<+∞=G(XT)1T<+∞,\n其中 ,我们有G(x) =Ex(F(Xu,u\u00150)) .\n强马氏性表示在 T有限的情形 ,给定T时刻之前发生的事情 ,在T时\n刻开始的过程 (Xu+T)u≥0的条件分布正是从 XT开始的连续时间马氏链的\n分布 .\n利用马氏性 ,我们可以知道 pt的半群性质 :\n命题 4.2.9.\npt+s(x,y) =X\nzpt(x,z)ps(z,y).\n通过半群性质 ,一旦我们知道 pt(x,y)在t= 0处的导数 ,即可表达\npt(x,y)在一般时刻 t时的导数 .我们将证明如下结果 :\n命题 4.2.10.\nd\ndtpt(x,y)\f\f\f\nt=0=α(x,y).\n证明 .首先 ,不难发现 limt→0pt(x,y) =δx,y .接下来 ,用J1表示第一次跳跃\n的时刻 .那么 ,对停时J1用强马氏性 ,我们有\npt(x,y) =Px(Xt=y)\n=Px(Xt=y,J 1>t)\n+X\nzPx(J1\u0014t,XJ1=z,X t=y)\n=δx,ye−λ(x)t+X\nzEx(1J1≤t,XJ1=z\u0002pt−J1(z,y))58 第四章 连续时间马氏链\n=δx,ye−λ(x)t+X\nzZt\n0pt−s(z,y)q(x,z)λ(x)e−λ(x)sds\n=δx,ye−λ(x)t+X\nzZt\n0(δz,y+o(1))q(x,z)λ(x)e−λ(x)sds\n=δx,ye−λ(x)t+q(x,y)(1\u0000e−λ(x)t) +o(t)\n=δx,y+λ(x)t(\u0000δx,y+q(x,y)) +o(t)\n=p0(x,y) +α(x,y)t+o(t).\n向后方程的证明 .由命题 4.2.9 ,\npt+h(x,y) =X\nzph(x,z)pt(z,y).\n再由命题 4.2.10 ,\nph(x,z) =δx,z+hα(x,z) +o(h).\n综上 ,我们有\npt+h(x,y) =pt(x,y) +hX\nzα(x,z)pt(z,y) +o(h).\n所以 ,我们有\nd\ndtpt(x,y) =X\nzα(x,z)pt(z,y).\n向前方程的证明 .由命题 4.2.9 ,\npt+h(x,y) =X\nzpt(x,z)ph(z,y).\n再由命题 4.2.10 ,\nph(z,y) =δz,y+hα(z,y) +o(h).\n综上 ,我们有\npt+h(x,y) =pt(x,y) +hX\nzpt(x,z)α(z,y) +o(h).\n所以 ,我们有\nd\ndtpt(x,y) =X\nzpt(x,z)α(z,y).第 4.3节 生灭过程 59\n第 4.3节 生灭过程\n考虑群体规模随着时间的涨落 .它可以通过生灭过程 (birth-and-death\nprocess) 建模 .状态空间S=Z≥0.我们用Xt表示t时刻群体中的个\n体总数 .我们假设在每个时刻只能有至多一个新生或死亡 .那么 ,从状态\nn(n\u00151)开始演化 ,下一个不同的状态只能是 n+ 1或者n\u00001. (从0出发 ,\n下一个不同的状态只能是 1.)为了描述这个连续时间马氏链 ,我们假设\nα(n,n+ 1) =λn,α(n,n\u00001) =µn,\n其中 ,µ0= 0 .这里 ,(λn)n≥0被称为是新生速率 ,(µn)n≥0被称为是死亡速\n率.用转移概率表示 ,当t!0时,我们有\nP(Xt=n+ 1jX0=n) =λnt+o(t),\nP(Xt=n\u00001jX0=n) =µnt+o(t),\nP(Xt=njX0=n) = 1\u0000(λn+µn)t+o(t).\n例 4.3.泊松过程是一种特殊的生灭过程 ,其中 ,λn=λ,µn= 0 .\n例 4.4 (Markov 排队模型 ).我们用Xt表示t时刻队列中的顾客数 .假设\n顾客的到达被一个参数为 λ的泊松过程描述 .假设每个顾客的服务时间是\n参数为µ的指数随机变量 .接下来 ,我们考虑三种不同的情形 :\n(a)M/M/1排队系统 .这种情形下 ,只有一个服务员 ,只有排在最前面的\n顾客接受服务 .此时 ,(Xt)t≥0是个生灭过程 .其中 ,λn=λ,µn=µ.\n(b)M/M/k排队系统 .这种情况下 ,有k名服务员 ,只有排在最前面\n的k个顾客接受服务 .这也是一个生灭过程 ,其中 ,λn=λ,µn=\nmin(k,n)µ.\n(c)M/M/ +1排队系统 .这种情况下 ,有无穷多名服务员 ,所有顾客都\n在接受服务 .此生灭过程的参数 λn=λ,µn=nµ .\n例 4.5 (群体模型 ).我们用连续时间马氏链表示群体中个体总数的演化 .我\n们假设每个个体产生新后代的速率是 λ,每个个体死亡的速率是 µ.假设\n所有个体的行为是相互独立的 .那么 ,这是一个生灭过程 ,其中 ,λn=nλ ,\nµn=nµ .如果µ= 0 ,此过程是纯生过程 ,被称为 Y ule过程 .60 第四章 连续时间马氏链\n例 4.6 (带移民的群体模型 ).这是一个生灭过程 ,其中 ,λn=nλ+ν,µn=\nnµ .其中 ,ν是移民到达的速率 .\n例 4.7 (快速增长的群体模型 ).这是一个生灭过程 ,其中 ,λn=n2λ,µn= 0 .\n这个模型群体规模增长十分迅速 ,可以在有限时间内到达无穷个个体的状\n态.\n对于生灭过程 ,它不可约当且仅当\nλn>0,8n\u00150,并且µn>0,8n\u00151.\n生灭过程被称为是常返的当且仅当它对应的离散马氏链是常返的 .生灭\n过程对应的离散马氏链的转移概率是\np(n,n+ 1) =λn\nλn+µn,p(n,n\u00001) = 1 \u0000p(n,n+ 1).\n定理 4.3.1.假设生灭过程不可约 .", "µ.\n(c)M/M/ +1排队系统 .这种情况下 ,有无穷多名服务员 ,所有顾客都\n在接受服务 .此生灭过程的参数 λn=λ,µn=nµ .\n例 4.5 (群体模型 ).我们用连续时间马氏链表示群体中个体总数的演化 .我\n们假设每个个体产生新后代的速率是 λ,每个个体死亡的速率是 µ.假设\n所有个体的行为是相互独立的 .那么 ,这是一个生灭过程 ,其中 ,λn=nλ ,\nµn=nµ .如果µ= 0 ,此过程是纯生过程 ,被称为 Y ule过程 .60 第四章 连续时间马氏链\n例 4.6 (带移民的群体模型 ).这是一个生灭过程 ,其中 ,λn=nλ+ν,µn=\nnµ .其中 ,ν是移民到达的速率 .\n例 4.7 (快速增长的群体模型 ).这是一个生灭过程 ,其中 ,λn=n2λ,µn= 0 .\n这个模型群体规模增长十分迅速 ,可以在有限时间内到达无穷个个体的状\n态.\n对于生灭过程 ,它不可约当且仅当\nλn>0,8n\u00150,并且µn>0,8n\u00151.\n生灭过程被称为是常返的当且仅当它对应的离散马氏链是常返的 .生灭\n过程对应的离散马氏链的转移概率是\np(n,n+ 1) =λn\nλn+µn,p(n,n\u00001) = 1 \u0000p(n,n+ 1).\n定理 4.3.1.假设生灭过程不可约 .则,生灭过程是非常返的当且仅当\n+∞X\nn=1µ1µ2\u0001 \u0001 \u0001µn\nλ1λ2\u0001 \u0001 \u0001λn<+1. (4.3)\n证明 .我们利用命题 3.3.5来证明 .我们取z= 0 .我们定义α(0) = 1 .方\n程 (3.4 )可以写成\nα(n) =λn\nλn+µnα(n+ 1) +µn\nλn+µnα(n\u00001),8n\u00151.\n稍作变形 ,可以得到\nα(n+ 1)\u0000α(n) =µn\nλn(α(n)\u0000α(n\u00001)).\n于是 ,我们得到\nαn+1\u0000α(n) = (α(1)\u0000α(0))µ1µ2\u0001 \u0001 \u0001µn\nλ1λ2\u0001 \u0001 \u0001λn.\n因此 ,我们有\nα(n+ 1) =α(0) + (α(1)\u0000α(0))nX\nj=0µ1µ2\u0001 \u0001 \u0001µj\nλ1λ2\u0001 \u0001 \u0001λj.\n= 1 + (α(1)\u00001)nX\nj=0µ1µ2\u0001 \u0001 \u0001µj\nλ1λ2\u0001 \u0001 \u0001λj第 4.3节 生灭过程 61\n如果 (4.3 )成立 ,令c=P+∞\nn=1µ1µ2···µn\nλ1λ2···λn<+1,那么 ,取α(1) = 1 \u00001/c.那\n么, (3.1 )和(3.3 )都成立 .那么 ,根据命题 3.3.5 ,马氏链非常返 .如果 (4.3 )不成\n立,即\n+∞X\nn=1µ1µ2\u0001 \u0001 \u0001µn\nλ1λ2\u0001 \u0001 \u0001λn= +1,\n那么 ,无论α(1) = 1还是α(1)<1,都不能有 (3.1 )和(3.3 )同时成立 .故根据\n命题 3.3.5 ,马氏链常返 .\n接下来 ,我们判断马氏链何时正常返 .其中 ,状态x被称为正常返的当\n且仅当Ex(Tx)<1,其中 ,Tx是生灭过程离开状态 x后第一次返回 x的时\n刻.为此 ,我们试图寻找平稳分布 π.由平稳分布满足的方程可以发现 ,π是\n平稳分布等价于\nπ(n) =λ0λ1\u0001 \u0001 \u0001λn−1\nµ1µ2\u0001 \u0001 \u0001µnπ(0),\n并且P\nxπ(x) = 1 .这等价于P+∞\nn=0λ0λ1···λn−1\nµ1µ2···µn<+1.对于连续时间可数状\n态马氏链 ,仅有平稳分布的存在性 ,并不能保证正常返 ,还需要加上非爆炸的\n条件 ,见 [Nor98 ,定理 3.5.3].但是 ,当生灭过程常返时 ,一定是非爆炸的 .所\n以,生灭过程正常返当且仅当其常返 ,并且平稳分布存在 .于是 ,我们得到如\n下定理 :\n定理 4.3.2.假设生灭过程不可约 .则,生灭过程正常返当且仅当\nq=+∞X\nn=0λ0λ1\u0001 \u0001 \u0001λn−1\nµ1µ2\u0001 \u0001 \u0001µn<+1.\n当q<+1时,平稳分布\nπ(n) =λ0λ1\u0001 \u0001 \u0001λn−1\nµ1µ2\u0001 \u0001 \u0001µnq−1.\n例 4.8.作为例子 ,考虑M/M/1排队系统 .根据定理 4.3.1和定理 4.3.2 ,排\n队系统常返当且仅当 λ\u0014µ,排队系统正常返当且仅当 λ<µ .当λ<µ时,\n平稳分布为\nπ(n) =\u0012\n1\u0000λ\nµ\u0013\u0012λ\nµ\u0013n\n.\n特别的 ,对于平稳链 ,队伍长度的期望值是\n+∞X\nn=0nπ(n) =λ\nµ\u0000λ.62 第四章 连续时间马氏链\n例 4.9.考虑M/M/1排队系统 .根据定理 4.3.2 ,排队系统总是正常返的 ,\n平稳分布为\nπ(n) =e−λ/µ(λ/µ)n/n!.\n平稳分布是参数为 λ/µ的泊松分布 .平稳状态下 ,队伍的平均长度为 λ/µ.\n例 4.10.考虑M/M/k排队系统 .根据定理 4.3.1和定理 4.3.2 ,排队系统常\n返当且仅当 λ\u0014kµ ,排队系统正常返当且仅当 λ<kµ .但是 ,当λ<kµ时,\n平稳分布π并没有简单的表达式 .\n例 4.11.考虑例 4.6中的带移民的群体模型 ,这个生灭链不可约 .根据定\n理4.3.1和定理 4.3.2 ,排队系统常返当且仅当 λ<µ或者ν\u0014λ=µ,排队系\n统正常返当且仅当 λ<µ .\n接下来 ,我们考虑 Y ule过程 .假设一开始群体中有 1个个体 .令\nPt(n) =P(Xt=n).那么 ,P0(1) = 1 ,并�", "子 ,考虑M/M/1排队系统 .根据定理 4.3.1和定理 4.3.2 ,排\n队系统常返当且仅当 λ\u0014µ,排队系统正常返当且仅当 λ<µ .当λ<µ时,\n平稳分布为\nπ(n) =\u0012\n1\u0000λ\nµ\u0013\u0012λ\nµ\u0013n\n.\n特别的 ,对于平稳链 ,队伍长度的期望值是\n+∞X\nn=0nπ(n) =λ\nµ\u0000λ.62 第四章 连续时间马氏链\n例 4.9.考虑M/M/1排队系统 .根据定理 4.3.2 ,排队系统总是正常返的 ,\n平稳分布为\nπ(n) =e−λ/µ(λ/µ)n/n!.\n平稳分布是参数为 λ/µ的泊松分布 .平稳状态下 ,队伍的平均长度为 λ/µ.\n例 4.10.考虑M/M/k排队系统 .根据定理 4.3.1和定理 4.3.2 ,排队系统常\n返当且仅当 λ\u0014kµ ,排队系统正常返当且仅当 λ<kµ .但是 ,当λ<kµ时,\n平稳分布π并没有简单的表达式 .\n例 4.11.考虑例 4.6中的带移民的群体模型 ,这个生灭链不可约 .根据定\n理4.3.1和定理 4.3.2 ,排队系统常返当且仅当 λ<µ或者ν\u0014λ=µ,排队系\n统正常返当且仅当 λ<µ .\n接下来 ,我们考虑 Y ule过程 .假设一开始群体中有 1个个体 .令\nPt(n) =P(Xt=n).那么 ,P0(1) = 1 ,并且Pt(0) = 0 (t\u00150).对于\nn\u00151,令Tn= infft\u00150 :Xt=ng表示群体中个体的总数目首次到达 n的\n时刻 .则,T1= 0 .对于n\u00151,令τn=Tn+1\u0000Tn.那么 ,(τn)n≥1独立 ,其\n中,τn服从参数是 nλ的指数分布 .可以归纳的证明\nP(Tn\u0014t) = (1 \u0000e−λt)n−1.\n故,\nP(Xt\u0015n) =P(Tn\u0014t) = (1 \u0000e−λt)n−1.\n所以 ,我们有\nPt(n) =P(Xt\u0015n)\u0000P(Xt\u0015n+ 1) =e−λt(1\u0000e−λt)n−1,n\u00151.\n于是 ,我们得到\nE(Xt) =+∞X\nn=1nPt(n) =eλt.\n接下来 ,我们估计Tn:\nE(Tn) =n−1X\nk=1E(τk) =n−1X\nk=11\nkλ\u0018λlnn,\nVar(Tn) =n−1X\nk=1Var(τk)\u0014n−1X\nk=11\nk2λ2<+1.第 4.4节 一般情形 63\n所以 ,我们有\nTn\nλlnnP!1.\n特别的 ,因为T∞= supn≥1Tn= +1,所以 ,对于任何有限的时间 ,群体中的\n个体总数有限 .\n最后 ,我们考虑例 4.7 .我们仍然假设 X0= 1 ,并类似的定义 Tn和τn.\n那么 ,τn服从参数为 λn2的指数分布 .考虑T∞=P+∞\nn=1τn.那么 ,\nE(T∞) =+∞X\nn=11\nλn2<+1.\n所以 ,P(T∞<+1) = 1 .即以概率 1,在有限的时间内 ,群体规模会增长至\n无穷多 ,发生人口爆炸现象 .此例说明 ,在可数状态空间上的连续时间马氏\n链的研究中 ,我们应该留意有限时间内的爆炸现象 .\n第 4.4节 一般情形\n假设有一个可数的状态空间 S.我们考虑其上的 最小连续时间马氏链\n(Xt)t≥0.它可以由一个转移概率为 q(x,y)的离散时间马氏链 (Yn)n≥0和一\n列等待时间 (τn)n≥1构造出来 .给定 (Yn)n≥0,(τn)n≥1是独立的指数随机\n变量 ,其中 ,τn的参数为λ(Yn−1).具体的由 (Yn)n≥0和(τn)n≥1构造过程\n(Xt)t≥0的方法和第 4.2节开头给出的构造方法相同 .更具体的 ,令J0= 0 .\n对于n\u00151,定义\nJn=τ1+τ2+\u0001 \u0001 \u0001+τn.\n对于n\u00150和Jn\u0014t\u0014Jn+1,我们定义Xt=Yn.不同于有限状态的\n情形 ,对于可数状态空间的一般情形 ,有可能发生 J∞<+1,其中 ,J∞=\nP+∞\nn=1τn.一旦J∞<+1发生 ,则代表着有限的时间内发生了无穷多次的\n跳跃 .一旦发生无穷多次跳跃 ,我们终止马氏链 (Xt)t≥0,将马氏链永久的转\n移到墓地∂.即,我们人为的创造一个不在状态空间 S中的点∂.我们称∂\n是墓地 (cemetery). 并且我们定义\n8t\u0015J∞,Xt=∂.\n可以看到 ,∂可以看作 (Xt)t≥0的吸收态 .我们把J∞<+1的现象称\n为爆炸现象 .例如 ,对于例 4.7中考虑的快速增长的群体模型 ,我们以概率 164 第四章 连续时间马氏链\n可以观察到爆炸现象 .但是 ,对于我们关心的绝大多数可数状态空间上的连\n续时间马氏链 ,其上是没有爆炸现象的 .\n如果我们在可能的爆炸发生后 ,立即终止马氏过程 ,或者等价的 ,将其送\n入墓地∂.那么 ,这样得到的过程被称为是最小的 .我们也可以选择在爆炸\n后重新开始一个新的转移过程 .这样也可以得到一个连续时间马氏链 .而最\n小马氏链之所以被称为是最小的 ,是因为它实际的存活时间是最短的 .\n书 [Nor98 ]的第 2.7节探讨了爆炸现象 .\n可以用类似于有限状态空间的方法验证 ,如上构造的最小马氏链具有定\n理4.2.1中描述的马氏性 .除此以外 ,非最小的马氏链也必须具有马氏性 .这\n是马氏链这一名字的由来 .一般而言 ,我们把可数状态空间 S上的右连续\n的具有马氏性的过程 (Xt)t≥0称为是可数状态空间上的连续时间马氏链 .有\n一", "状态空间 S中的点∂.我们称∂\n是墓地 (cemetery). 并且我们定义\n8t\u0015J∞,Xt=∂.\n可以看到 ,∂可以看作 (Xt)t≥0的吸收态 .我们把J∞<+1的现象称\n为爆炸现象 .例如 ,对于例 4.7中考虑的快速增长的群体模型 ,我们以概率 164 第四章 连续时间马氏链\n可以观察到爆炸现象 .但是 ,对于我们关心的绝大多数可数状态空间上的连\n续时间马氏链 ,其上是没有爆炸现象的 .\n如果我们在可能的爆炸发生后 ,立即终止马氏过程 ,或者等价的 ,将其送\n入墓地∂.那么 ,这样得到的过程被称为是最小的 .我们也可以选择在爆炸\n后重新开始一个新的转移过程 .这样也可以得到一个连续时间马氏链 .而最\n小马氏链之所以被称为是最小的 ,是因为它实际的存活时间是最短的 .\n书 [Nor98 ]的第 2.7节探讨了爆炸现象 .\n可以用类似于有限状态空间的方法验证 ,如上构造的最小马氏链具有定\n理4.2.1中描述的马氏性 .除此以外 ,非最小的马氏链也必须具有马氏性 .这\n是马氏链这一名字的由来 .一般而言 ,我们把可数状态空间 S上的右连续\n的具有马氏性的过程 (Xt)t≥0称为是可数状态空间上的连续时间马氏链 .有\n一般的方法可以证明 ,这样的连续时间马氏链还具有定理 4.2.8描述的强马氏\n性.我们经常需要使用马氏性和强马氏性 .\n从实用的角度出发 ,我们先把主要精力放在研究最小马氏链之上 .我们\n已经看到最小马氏链完全由 q(x,y)和λ(x)确定 .由这两者 ,我们可以定义\n无穷小生成元 :\nα(x,y)≜(\nλ(x)q(x,y),y6=x;\n\u0000λ(x)(1\u0000q(x,x)), y =x.(4.4)\n无穷小生成元的刻画条件是以下三条 :\n1.P\nyα(x,y) = 0 .\n2.α(x,x)<0.\n3.8y6=x,α(x,y)\u00150.\n给定无穷小生成元 ,我们也可以计算出一个对应的 q(x,y)和λ(x).实际上 ,\n我们可以令\nλ(x) =\u0000α(x,x),8x2S,q(x,y) =α(x,y)\n\u0000α(x,x),8x6=y.\n可以证明最小马氏链的分布完全由无穷小生成元决定 .不失一般性的 ,在后\n面的篇幅里 ,我们假设\nq(x,x) = 0,8x2S.\n对于一般的马氏链 ,我们定义转移概率\npt(x,y) =Px(Xt=y).第 4.4节 一般情形 65\n对于最小马氏链 ,可以证明pt(x,y)满足向后方程 .\n定理 4.4.1 (向后方程 ).pt(x,y)是下列向后方程的最小非负解 :\nd\ndtpt(x,y) =X\nz∈Sα(x,z)pt(z,y),p0(x,y) =δx,y.\n其中 ,α(x,z)是无穷小生成元 .\n证明 .定义ft(z,x,y ) =Px(J1\u0014t,XJ1=z,X t=y).那么 ,在时刻J1使用\n强马尔可夫性 ,可以得到\nft(z,x,y ) =Ex(1J1≤t,XJ1=z\u0002pt−J1(z,y))\n=Zt\n0pt−s(z,y)q(x,z)λ(x)e−λ(x)sds\nu=t−s=e−λ(x)tZt\n0pu(z,y)λ(x)q(x,z)eλ(x)udu.\n定义gt(x,y) =Px(J1>t,X t=y).则,\ngt(x,y) =δx,ye−λ(x)t.\n利用 F ubini定理 ,我们有\npt(x,y) =gt(x,y) +X\nzft(z,x,y )\n=δx,ye−λ(x)t+e−λ(x)tZt\n0X\nzpu(z,y)λ(x)q(x,z)eλ(x)udu. (4.5)\n所以 ,我们有\nd\ndtpt(x,y) =\u0000δx,yλ(x)e−λ(x)t+X\nzpt(z,y)λ(x)q(x,z)\n+ (\u0000λ(x))e−λ(x)tZt\n0X\nzpu(z,y)λ(x)q(x,z)eλ(x)udu\n=\u0000λ(x)pt(x,y) +X\nzpt(z,y)λ(x)q(x,z)\n=X\nzα(x,z)pt(z,y).\n另外 ,容易验证p0(x,y) =δx,y .所以 ,pt(x,y)满足向后方程 .显然 ,pt(x,y)\n非负 .只需要验证 pt(x,y)是最小的非负解 .假设ft(x,y)也是向后方程的66 第四章 连续时间马氏链\n非负解 .令ht(x,y) =e−α(x,x)tft(x,y).那么 ,h0(x,y) =f0(x,y) =δx,y ,并\n且\nd\ndtht(x,y) =\u0000α(x,x)e−α(x,x)tft(x,y) +e−α(x,x)td\ndtft(x,y)\n=e−α(x,x)tX\nz̸=xα(x,z)ft(z,y).\n所以 ,\nht(x,y) =h0(x,y) +Zt\n0e−α(x,x)uX\nz̸=xα(x,z)fu(z,y)du\n=δx,y+Zt\n0e−α(x,x)uX\nz̸=xα(x,z)fu(z,y)du.\n因此 ,\nft(x,y) =δx,yeα(x,x)t+Zt\n0eα(x,x)(t−u)X\nz̸=xα(x,z)fu(z,y)du. (4.6)\n注意到\nδx,yeα(x,x)t=Px(J1>t,X t=y).\n那么 ,我们有\nft(x,y)\u0015Px(J1>t,X t=y).\n可以归纳的证明 8n\u00151,\nft(x,y)\u0015Px(Jn>t,X t=y).\n实际上 ,令p(n)\nt(x,y) =Px(Jn>t,X t=y).在时刻J1使用强马氏性 ,可以\n证明\np(n+1)\nt (x,z) =δx,yeα(x,x)t+Zt\n0eα(x,x)(t−u)X\nz̸=xα(x,z)p(n)\nu(z,y)du. (4.7)\n利用 (4.6 )和(4.7 ),可以从ft(x,y)\u0015Px(Jn> t,X t=y)推出ft(x,y)\u0015\nPx(Jn+1>t,X t=y).最后 ,令n! 1 ,可得\nft(x,y)\u0015Px(J∞>t,X t=y) =Px(Xt=y) =pt(x,y).\n对于最小马氏链 ,还可以证明其满足向前方程 :第 4.4节 一般情形 67\n定理 4.4.2 (向前方程 ).pt(x,y)是下列向前方程的最小非负解 :\nd\ndtpt(x,y) =X\nz∈Spt(x,z)α(z,y),p0(x,y) =δx,y.\n其中 ,α(z,y)是无穷小生成", ")tX\nz̸=xα(x,z)ft(z,y).\n所以 ,\nht(x,y) =h0(x,y) +Zt\n0e−α(x,x)uX\nz̸=xα(x,z)fu(z,y)du\n=δx,y+Zt\n0e−α(x,x)uX\nz̸=xα(x,z)fu(z,y)du.\n因此 ,\nft(x,y) =δx,yeα(x,x)t+Zt\n0eα(x,x)(t−u)X\nz̸=xα(x,z)fu(z,y)du. (4.6)\n注意到\nδx,yeα(x,x)t=Px(J1>t,X t=y).\n那么 ,我们有\nft(x,y)\u0015Px(J1>t,X t=y).\n可以归纳的证明 8n\u00151,\nft(x,y)\u0015Px(Jn>t,X t=y).\n实际上 ,令p(n)\nt(x,y) =Px(Jn>t,X t=y).在时刻J1使用强马氏性 ,可以\n证明\np(n+1)\nt (x,z) =δx,yeα(x,x)t+Zt\n0eα(x,x)(t−u)X\nz̸=xα(x,z)p(n)\nu(z,y)du. (4.7)\n利用 (4.6 )和(4.7 ),可以从ft(x,y)\u0015Px(Jn> t,X t=y)推出ft(x,y)\u0015\nPx(Jn+1>t,X t=y).最后 ,令n! 1 ,可得\nft(x,y)\u0015Px(J∞>t,X t=y) =Px(Xt=y) =pt(x,y).\n对于最小马氏链 ,还可以证明其满足向前方程 :第 4.4节 一般情形 67\n定理 4.4.2 (向前方程 ).pt(x,y)是下列向前方程的最小非负解 :\nd\ndtpt(x,y) =X\nz∈Spt(x,z)α(z,y),p0(x,y) =δx,y.\n其中 ,α(z,y)是无穷小生成元 .\n为了证明向前方程 ,我们需要一个关于独立指数分布的结果 :\n引理 4.4.3.假设X1,X2,...,X n是独立的指数分布 ,其中 ,Xi的参数是λi.\n用f表示X1+X2+\u0001 \u0001 \u0001+Xn的密度函数 .令\ng(t) =P(X1+X2+\u0001 \u0001 \u0001+Xn−1\u0014t<X 1+X2+\u0001 \u0001 \u0001+Xn)\n那么 ,f(t) =λng(t).\n定理 4.4.2的证明 .首先 ,我们有\nPx(Jn\u0014t<J n+1,XJ0=x0,XJ1=x1,...,X Jn=xn)\n=E(IfY0=x0,...,Y n=xngP(Jn\u0014t<J n+1j(Yn)n≥0)) (4.8)\n而,\nP(Jn\u0014t<J n+1j(Yn)n≥0)\n=P(τ1+τ2+\u0001 \u0001 \u0001+τn\u0014t<τ 1+τ2+\u0001 \u0001 \u0001+τn+1), (4.9)\n其中 ,τ1,τ2,...,τ n+1独立 ,并且τi服从参数为 λ(xi−1)的指数分布 .用gn(t)\n表示τ1+τ2+\u0001 \u0001 \u0001+τn的密度函数 .根据引理 4.4.3 ,我们有\n(4.9 )=1\nλ(xn)gn+1(t)\n=Zt\n0e−λ(xn)sgn(t\u0000s)ds\n=Zt\n0e−λ(xn)sλ(xn−1)\n\u0002P(τ1+τ2+\u0001 \u0001 \u0001+τn−1\u0014t\u0000s<τ 1+τ2+\u0001 \u0001 \u0001+τn)ds\n=Zt\n0e−λ(xn)sλ(xn−1)P(Jn−1\u0014t\u0000s<J nj(Yn)n≥0)ds.\n代入 (4.8 ),可以得到\n(4.8 )=Zt\n0α(xn−1,xn)e−λ(xn)s68 第四章 连续时间马氏链\n\u0002Px(Jn−1\u0014t\u0000s<J n,XJ0=x0,...,X Jn−1=xn−1)ds. (4.10)\n取xn=y,对x0,x1,...,x n−1求和 ,从(4.10 )我们得到 ,\nPx(Jn\u0014t<J n+1,Xt=y)\n=X\nz̸=yZt\n0Px(Jn−1\u0014t\u0000s<J n,Xt−s=z)α(z,y)e−λ(y)sds. (4.11)\n对(4.11 )中的n求和 ,我们可以得到\npt(x,y) =Px(t<J 1,Xt=y)\n++∞X\nn=1Px(Jn\u0014t<J n+1,Xt=y)\n=δx,ye−λ(y)t+Zt\n0X\nz̸=ypt−s(x,z)α(z,y)e−λ(y)sds\n=δx,ye−λ(y)t+Zt\n0X\nz̸=ypu(x,z)α(z,y)e−λ(y)(t−u)ds\n=e−λ(y)t(δx,y+Zt\n0X\nz̸=ypu(x,z)α(z,y)eλ(y)uds).\n所以 ,我们有\npt(x,y)eλ(y)t=δx,y+Zt\n0X\nz̸=ypu(x,z)α(z,y)eλ(y)uds. (4.12)\n根据 (4.5 ),对于任意的 x和y,pt(x,y)eλ(x)t单调不降 .所以 ,对于任意的\n0\u0014u\u0014t\u0014r,我们有\nX\nz̸=ypu(x,z)α(z,y)\u0014eλ(x)(r−u)X\nz̸=ypr(x,z)α(z,y). (4.13)\n由于pt(x,y)eλ(y)t对任何t都是有限的 ,根据 (4.12 ),存在r\u0015t,使得\nX\nz̸=ypr(x,z)α(z,y)<+1. (4.14)\n否则 ,8u2[t,2t],P\nz̸=ypu(x,z)α(z,y)eλ(y)u= +1.那么 ,由(4.12 ),\np2t(x,y)eλ(y)2t= +1,第 4.4节 一般情形 69\n矛盾 !从而 ,利用 (4.13 )和(4.14 ),P\nz̸=ypu(x,z)α(z,y)对u2[0,t]一致收敛 .\n根据向后方程 ,关于u的函数u7!pu(x,z)连续 .所以 , (4.12 )中的被积函数\npu(x,z)α(z,y)eλ(y)u关于u连续 .所以 ,对(4.12 )的两边求导可得\neλ(y)td\ndtpt(x,y)+λ(y)eλ(y)tpt(x,y) =X\nz̸=ypt(x,z)α(z,y)eλ(y)t,p0(x,y) =δx,y.\n化简可得 :\nd\ndtpt(x,y) =X\nz̸=ypt(x,z)α(z,y),p0(x,y) =δx,y.\n接下来 ,我们假设ft(x,y)也是向前方程的非负解 .我们将证明 8x,y2S,\nft(x,y)\u0015pt(x,y).\n为此 ,我们首先对 (4.11 )中的n部分求和 ,得到\nPx(Xt=y,t<J n+1) =δx,ye−λ(y)t\n+X\nz̸=yZt\n0Px(Xt−s=z,t\u0000s<J n)α(z,y)e−λ(y)sds.\n另一方面 ,利用向前方程 ,可以说明\nft(x,y) =δx,ye−λ(y)t+Zt\n0X\nz̸=yft−s(x,z)α(z,y)e−λ(y)sds.\n最后 ,类似于定理 4.4.1的证明 ,可以归纳的证明\nft(x,y)\u0015Px(Xt=y,t<J n+1),\n最后", "则 ,8u2[t,2t],P\nz̸=ypu(x,z)α(z,y)eλ(y)u= +1.那么 ,由(4.12 ),\np2t(x,y)eλ(y)2t= +1,第 4.4节 一般情形 69\n矛盾 !从而 ,利用 (4.13 )和(4.14 ),P\nz̸=ypu(x,z)α(z,y)对u2[0,t]一致收敛 .\n根据向后方程 ,关于u的函数u7!pu(x,z)连续 .所以 , (4.12 )中的被积函数\npu(x,z)α(z,y)eλ(y)u关于u连续 .所以 ,对(4.12 )的两边求导可得\neλ(y)td\ndtpt(x,y)+λ(y)eλ(y)tpt(x,y) =X\nz̸=ypt(x,z)α(z,y)eλ(y)t,p0(x,y) =δx,y.\n化简可得 :\nd\ndtpt(x,y) =X\nz̸=ypt(x,z)α(z,y),p0(x,y) =δx,y.\n接下来 ,我们假设ft(x,y)也是向前方程的非负解 .我们将证明 8x,y2S,\nft(x,y)\u0015pt(x,y).\n为此 ,我们首先对 (4.11 )中的n部分求和 ,得到\nPx(Xt=y,t<J n+1) =δx,ye−λ(y)t\n+X\nz̸=yZt\n0Px(Xt−s=z,t\u0000s<J n)α(z,y)e−λ(y)sds.\n另一方面 ,利用向前方程 ,可以说明\nft(x,y) =δx,ye−λ(y)t+Zt\n0X\nz̸=yft−s(x,z)α(z,y)e−λ(y)sds.\n最后 ,类似于定理 4.4.1的证明 ,可以归纳的证明\nft(x,y)\u0015Px(Xt=y,t<J n+1),\n最后令n! 1即可 .\n对于一般的马氏链 ,可以证明向后方程总是成立的 ,但是向前方程不一\n定总是成立的 .但是 ,对于我们遇到的绝大部分马氏链 ,向前方程也可以被\n证明是成立的 .70 第四章 连续时间马氏链第五章 可逆马氏链\n第 5.1节 可逆过程\n在本章中 ,我们将学习一类特殊的马氏链 :可逆链 .很多重要的链都是\n可逆的 ,我们利用这一事实来理解它们的行为特征 .\n假设有一个连续时间马氏链 (Xt)t≥0,它在可数状态空间 S上取值 ,具\n有转移速率 α(x,y).若π是S上的一个测度 ,使得\nπ(x)α(x,y) =π(y)α(y,x),\n那么 ,我们称这个链关于测度 π是可逆的 .\n类似的 ,设(Xn)n≥0是一个离散时间马氏链 ,具有可数的状态空间 S,\n其转移概率为 p(x,y).若π是S上的一个测度 ,满足\nπ(x)p(x,y) =π(y)p(y,x),\n则,我们称 (Xn)n≥0关于测度π是可逆的 .\n我们主要讨论连续时间的马氏链 ,但是类似的讨论一样适用于离散时间\n马氏链 .\n例 5.1.如果α(x,y) =α(y,x),那么 ,我们称这个链是对称的 .对称的马氏\n链关于均匀测度 π(x) = 1 (x2S)是可逆的 .\n例 5.2.我们考虑一个图上的连续时间马氏链 .其转移速率为\nα(x,y) =1\nd(x),\n其中 ,d(x)是图上和x相邻的顶点个数 .那么 ,如果我们取\nπ(x) =d(x),x2S,\n那么 ,马氏链过于测度 π可逆 .\n7172 第五章 可逆马氏链\n例 5.3.设G= (V,E)是任意的一个图 ,并令g:E![0,+1).这样的一\n个结构通常被称为一个 网络 (network) .其中 ,g(e)是边e的权重 .在电路学\n中,g(e)是边e的电导 ,其倒数为边 e的电阻 .一个网络可以产生一个对称\n的链 .假设边e连接顶点x和y.那么 ,我们定义\nα(x,y) =α(y,x) =g(e).\n那么 ,这个图上的连续时间马氏链关于均匀测度可逆 .\n例 5.4.我们考虑一个生灭链 .状态空间为 S=f0,1,2,...g.出生率和死亡\n率分别为λn和µn,即\nα(n,n+ 1) =λn,α(n,n\u00001) =µn.\n令π(0) = 1 ,对于n\u00151,定义\nπ(n) =λ0λ1\u0001 \u0001 \u0001λn−1\nµ1µ2\u0001 \u0001 \u0001µn.\n则该生灭链关于测度 π是可逆的 .\n例 5.5.设G= (V,E)是一个图 .给定一个图的顶点集 V上的正测度\nπ:V!(0,+1).我们希望构造一个关于 π可逆的马氏链 .为此 ,如果\nfx,yg不是图上的一条边 ,我们定义转移速率 α(x,y) = 0 ;而如果 fx,yg是\n图上的一条边 ,我们定义\nα(x,y) = minf1,π(y)\nπ(x)g.\n那么 ,这样定义的马氏链关于测度 π可逆 .这样定义的马氏链通常被称为\nMetropolis 链.\n我们需要指出如果马氏链关于测度 π可逆 ,那么 ,测度π必然是马氏链\n的一个平稳测度 .实际上 ,我们有\nX\nx̸=yπ(x)α(x,y) =X\nx̸=yπ(y)α(y,x) =π(y)α(y),8y2S.\n特别的 ,如果α是不可约的 ,那么 ,π在差一个常数倍的意义下是唯一的不变\n测度 .所以 ,对于一个不可约、关于 π可逆的马氏链 ,如果P\nxπ(x)<+1,\n那么 ,马氏链是正常返的 ;如果P\nxπ(x) = + 1,那么 ,马氏链是非常返或者\n零常返的 .\n下面我们给出一个不可逆马氏链的例子 .第 5.2节 收敛到平稳分布 73\n例 5.6.考虑状态空间 S=f0,1,2g.转移速率\nα(0,1) =α(1,2) =α(2,0) = 1,α(1,0) =α(2,1) =α(0,2) = 2.\n那么 ,马氏链不可约 ,并且有不变概率测度 π.其中 ,π(1) =π(2) =π(3) =\n1/3 .如果该马氏链是可逆的 ,必然关于π可逆 .但是 ,π(0)α(0,1)6=\nπ(1)α(1,0).矛盾 !\n第 5.2节 收�", "一条边 ,我们定义\nα(x,y) = minf1,π(y)\nπ(x)g.\n那么 ,这样定义的马氏链关于测度 π可逆 .这样定义的马氏链通常被称为\nMetropolis 链.\n我们需要指出如果马氏链关于测度 π可逆 ,那么 ,测度π必然是马氏链\n的一个平稳测度 .实际上 ,我们有\nX\nx̸=yπ(x)α(x,y) =X\nx̸=yπ(y)α(y,x) =π(y)α(y),8y2S.\n特别的 ,如果α是不可约的 ,那么 ,π在差一个常数倍的意义下是唯一的不变\n测度 .所以 ,对于一个不可约、关于 π可逆的马氏链 ,如果P\nxπ(x)<+1,\n那么 ,马氏链是正常返的 ;如果P\nxπ(x) = + 1,那么 ,马氏链是非常返或者\n零常返的 .\n下面我们给出一个不可逆马氏链的例子 .第 5.2节 收敛到平稳分布 73\n例 5.6.考虑状态空间 S=f0,1,2g.转移速率\nα(0,1) =α(1,2) =α(2,0) = 1,α(1,0) =α(2,1) =α(0,2) = 2.\n那么 ,马氏链不可约 ,并且有不变概率测度 π.其中 ,π(1) =π(2) =π(3) =\n1/3 .如果该马氏链是可逆的 ,必然关于π可逆 .但是 ,π(0)α(0,1)6=\nπ(1)α(1,0).矛盾 !\n第 5.2节 收敛到平稳分布\n在一些自然的条件下 ,马氏链会收敛到平稳分布 .有时 ,我们需要估\n计马氏链收敛到平稳分布的速度 .在本节中 ,我们考虑关于一个概率测度\nπ可逆的马氏链 .为了简单起见 ,我们假设状态空间有限 .将其取为S=\nf1,2,...,N g.除此以外 ,我们假设马氏链是对称的 .\n为了描述收敛速度 ,我们需要度量两个概率测度 π和ν之间的距离 .一\n个十分自然的定义是如下的 全变差 (total variation) 距离 :\njjπ\u0000νjjTV= maxfjπ(A)\u0000ν(A)j:A\u001aSg.\n一般情况下 ,我们要求上式中的 A是S上的可测集 .但是对于状态空间 S,\n我们假设其所有子集都是可测的 .\n容易知道 ,在全变差距离的定义中 ,最大值在A=fx2S:π(x)\u0015\nν(x)g上取到 .因此 ,\njjπ\u0000νjjTV=1\n2X\nx∈Sjπ(x)\u0000ν(x)j.\n关于全变差距离 ,可以证明如下关于耦合的结论 :\n命题 5.2.1.\njjπ\u0000νjjTV= inffP(X6=Y) :X的边缘分布是 π,Y的边缘分布是 νg.\n另外 ,还可以考虑 L2距离 ,或称均方 (mean squared) 距离 .这种距离\n虽然不是很自然 ,但在很多场合都易于分析 .我们定义\njjπ\u0000νjjL2= (X\nx∈S1\nN(Nπ(x)\u0000Nν(x))2)1\n2.74 第五章 可逆马氏链\n我们假设无穷小生成元 A= (α(x,y))x,y∈S对称 .那么 ,A是一个实对\n称矩阵 .那么 ,A的所有特征值都是实数 .更进一步的 ,将特征值递降排列 .\n假设马氏链是不可约的 .那么 ,我们有\n0 =λ1>λ 2\u0015λ3\u0015 \u0001 \u0001 \u0001 \u0015λN.\n其中 ,λ2<0是因为不可约性质 .我们假设 (vj)j=1,2,...,N是对应的左特征向\n量.那么 ,v1可以取成每个分量都等于 1/N的向量 .那么 ,v1是概率测度 ,\n记为π.所有的左特征向量彼此正交 .对于概率测度 ν,它可以表示成\nν=X\njcjvj.\n通过和π取RN上的内积 ,我们可以知道\n1/N=hν,πi=c1hπ,πi=c1/N.\n所以 ,c1= 1 .现在 ,把转移概率 Pt=etA作用在ν上得到 :\nνPt=X\njcjvjetA=X\njcjetλjvj.\n由此 ,我们得到\njjνPt\u0000πjj2\n2=jjNX\nj=2cjetλjvjjj2\n2=NX\nj=2c2\njjjvjjj2\n2e2tλj\n\u0014e2tλ2NX\nj=2c2\njjjvjjj2\n2=e2tλ2jjν\u0000πjj2\n2.\n再利用 jj \u0001 jj L2=N1/2jj \u0001 jj 2\njjνPt\u0000πjjL2\u0014etλ2jjν\u0000πjjL2.\n于是 ,一旦我们有了 jλ2j的下界 ,那么 ,就可以得到收俩速度的上界估计 .\n例 5.7.考虑离散圆周上的随机游动 .状态空间S=f1,2,...,N g.若\njx\u0000yj= 1模N,\n则速率α(x,y) = 1/2 .则该链关于 S上的均匀概率测度可逆 .此例中无穷\n小生成元矩阵 A的特征值可以被完全确定 ,\nλj= cos\u00122π\nN(j\u00001)\u0013\n\u00001,j= 1,2,...,N.第 5.3节 马尔可夫链算法 75\n其中 ,当N很大时 ,λ2= cos(2π/N)\u00001近似等于 1\u00002π2N−2.对于ν=δ1,\n为了接近均匀概率测度 π,大约要花费 N2个时间单位 .\n例 5.8.考虑超立方体上的随机游走 .其中超立方的维数是 N.状态空间\nS=f0,1gN.对于两个不同的 x,y2S,它们是两个向量 ,如果它们恰有 1\n个分量不同 ,我们定义α(x,y) = 1 ,其他情况下 ,α(x,y) = 0 .显然 ,这个马\n氏链关于S上的均匀概率测度是可逆的 .可以看到 ,对于j= 0,1,...,N ,\n\u00002j/N是一个重数为\u0000N\nj\u0001\n的特征值 .所以 ,此时 ,λ2=\u00002/N.为了到达平\n稳分布 ,需要和N同阶的步数 .\n第 5.3节 马尔可夫链算法\n马氏链理论的一个近期的应用是对随机系统的蒙特卡罗 (Monte Carlo)\n模拟 .作为一个例子 ,假定我们对元素为 0或者 1的 “随", "虑离散圆周上的随机游动 .状态空间S=f1,2,...,N g.若\njx\u0000yj= 1模N,\n则速率α(x,y) = 1/2 .则该链关于 S上的均匀概率测度可逆 .此例中无穷\n小生成元矩阵 A的特征值可以被完全确定 ,\nλj= cos\u00122π\nN(j\u00001)\u0013\n\u00001,j= 1,2,...,N.第 5.3节 马尔可夫链算法 75\n其中 ,当N很大时 ,λ2= cos(2π/N)\u00001近似等于 1\u00002π2N−2.对于ν=δ1,\n为了接近均匀概率测度 π,大约要花费 N2个时间单位 .\n例 5.8.考虑超立方体上的随机游走 .其中超立方的维数是 N.状态空间\nS=f0,1gN.对于两个不同的 x,y2S,它们是两个向量 ,如果它们恰有 1\n个分量不同 ,我们定义α(x,y) = 1 ,其他情况下 ,α(x,y) = 0 .显然 ,这个马\n氏链关于S上的均匀概率测度是可逆的 .可以看到 ,对于j= 0,1,...,N ,\n\u00002j/N是一个重数为\u0000N\nj\u0001\n的特征值 .所以 ,此时 ,λ2=\u00002/N.为了到达平\n稳分布 ,需要和N同阶的步数 .\n第 5.3节 马尔可夫链算法\n马氏链理论的一个近期的应用是对随机系统的蒙特卡罗 (Monte Carlo)\n模拟 .作为一个例子 ,假定我们对元素为 0或者 1的 “随机矩阵 ”感兴趣 .作\n为一个概率空间 ,我们可以选择样本空间 S为元素为 0或者 1的N\u0002N矩\n阵全体 .一个自然概率测度可以是在所有 2N2个这样的矩阵上的均匀概率\n测度 .我们可以很容易的写一个算法 ,使得我们我们可以随机的生成这样的\n一个矩阵 :首先 ,选择N2个均匀的随机数 U(i,j),1\u0014i,j\u0014N.然后设\nM(i,j) =(\n1, U (i,j)>0.5,\n0, U (i,j)\u00140.5.\n现在 ,假设我们改变概率空间 .我们只对S上没有两个相邻 1的矩阵感\n兴趣 .我们用T表示这样的矩阵的子集 ,即\nT=(\nM2S:8i,j,如果M(i,j) = 1,那么M(i\u00001,j)\n=M(i+ 1,j) =M(i,j\u00001) =M(i,j+ 1) = 0)\n.\n我们希望从 T中等可能的抽取一个矩阵出来 .尽管很容易定义 T上的均匀\n概率分布 ,但是却很难确定 T中的元素个数 c(N).可以证明存在一个常数\nβ2(1,2),使得\nlim\nN→∞C(N)1\nN2=β.\n所以 ,T中的元素个数大约是 βN2.但是 ,我们并不知道 β的具体取值 .\n虽然构造一个有效算法 ,使得我们可以从 T中等可能抽取矩阵非常困\n难,但是我们可以构造一个近似的有效算法 ,可以近似等可能的从 T中抽取\n一个矩阵出来 .我们要做的是 ,考虑一个状态空间为 T的马氏链 ,它以均匀76 第五章 可逆马氏链\n测度为不变分布 .我们可以从任何矩阵开始该链 ,运行足够长时间后 ,其分\n布将接近均匀分布 .我们选取此时刻的状态矩阵即可 .\n对于这个例子 ,我们给出一个算法 :\n(1)从任何一个 T中的矩阵M开始 ,例如 ,可以从零矩阵开始 .我们记马\n氏链的当前状态为 M .\n(2)从马氏链的当前状态矩阵中随机选取一个元素 ,记其位置为 (i,j).\n(3)改变矩阵M的位置 (i,j)上的元素 ,得到一个新的矩阵 .如果新的矩\n阵属于T,我们接受这个改变 ,令其为马氏链的新的取值 ;否则 ,如果新\n的矩阵不属于 T,我们拒绝这个改变 ,我们对马氏链的取值不做改变 .\n然后返回第 (2)步.\n这个算法是状态空间 T上的离散时间马氏链的一个模拟 .对于两个仅仅是\n一个元素不同的矩阵 M,M′2T,其转移概率为\np(M,M′) =N−2.\n显然 ,p是个对称矩阵 ,是一个可逆的马氏链 .并且可以看出此马氏链是不可\n约的 ,有唯一的不变分布 .此不变分布恰好是 T上的均匀分布 .\n当然 ,我们需要知道让链运行多长的时间可以保证其接近不变分布 .这\n个问题可以归结为马氏链的第二特征值问题 .\n例 5.9.假定G= (V,E)是一个连通图 ,使得每个顶点最多与 K个其他顶\n点相连 .假定在V上有一个正的函数 f,且令π是由f定义出的概率测度\nπ(v) =f(v)P\nw∈Vf(w).\n如果fv,wg 2E,我们称v和w相邻 ,记v\u0018w.设\np(v,w) = 1 v∼w1\nKmin\u0012\n1,f(w)\nf(v)\u0013\n,\n且\np(v,v) = 1\u0000X\nw:w∼vP(v,w).\n那么 ,可以发现以 p为转移概率的马氏链关于概率测度 π是可逆的 .这样的\n马氏链通常被称为 Metropolis 链,而这种形式的算法通常被称为 Metropolis\n算法 .注意在这个算法中 ,我们并不需要计算P\nw∈Vf(w).第 5.4节 常返的判定准则 77\n存在一个类似的算法 ,被称为吉布斯采样器 .\n例 5.10.假定我们有 n个变量 (x1,x2,...,x n),每个变量可以在 K个值\nfa1,a2,...,a kg中取一个值 .令状态空间 S=fa1,a2,...,a kgn.假定有一个\nS上的正函数 f.由此 ,定义一个S上的概率测度 π:\nπ(x1,x2,...,x n) =f(x1,x2,...,x n)P\nSf(y1,y2,...,y n).\n我们的算法是随机选一个分量 j2 f1,2,...,n g,然后根据以下条件概率把\nxj换成z:\nf(x1,...,x j−1,z,x j+1,...,x n)PK\nk=1f(x1,...,x j−1,", "值问题 .\n例 5.9.假定G= (V,E)是一个连通图 ,使得每个顶点最多与 K个其他顶\n点相连 .假定在V上有一个正的函数 f,且令π是由f定义出的概率测度\nπ(v) =f(v)P\nw∈Vf(w).\n如果fv,wg 2E,我们称v和w相邻 ,记v\u0018w.设\np(v,w) = 1 v∼w1\nKmin\u0012\n1,f(w)\nf(v)\u0013\n,\n且\np(v,v) = 1\u0000X\nw:w∼vP(v,w).\n那么 ,可以发现以 p为转移概率的马氏链关于概率测度 π是可逆的 .这样的\n马氏链通常被称为 Metropolis 链,而这种形式的算法通常被称为 Metropolis\n算法 .注意在这个算法中 ,我们并不需要计算P\nw∈Vf(w).第 5.4节 常返的判定准则 77\n存在一个类似的算法 ,被称为吉布斯采样器 .\n例 5.10.假定我们有 n个变量 (x1,x2,...,x n),每个变量可以在 K个值\nfa1,a2,...,a kg中取一个值 .令状态空间 S=fa1,a2,...,a kgn.假定有一个\nS上的正函数 f.由此 ,定义一个S上的概率测度 π:\nπ(x1,x2,...,x n) =f(x1,x2,...,x n)P\nSf(y1,y2,...,y n).\n我们的算法是随机选一个分量 j2 f1,2,...,n g,然后根据以下条件概率把\nxj换成z:\nf(x1,...,x j−1,z,x j+1,...,x n)PK\nk=1f(x1,...,x j−1,ak,xj+1,...,x n).\n也就是说 ,我们考虑转移概率\np((x1,x2,...,x n),(y1,y2,...,y n))\n=1\nnf(x1,...,x j−1,yj,xj+1,...,x n)PK\nk=1f(x1,...,x j−1,ak,xj+1,...,x n),\n(x1,x2,...,x n)和(y1,y2,...,y n)只有第j个分量不同 .\n这样得到的马氏链是关于 π可逆的马氏链 .为了运行这个马氏链 ,我们不需\n要计算归一化常数X\nSf(y1,y2,...,y n).\n这样的两种算法都可以应用到 Ising模型等统计物理模型的模拟中 .\n第 5.4节 常返的判定准则\n在本节中 ,我们给出带对称速率的随机游走的有用的单调性结果 .假设\n有一个图G= (V,E)和图上的两个对称的速率函数 α和β.\n定理 5.4.1.假设β(x,y)\u0014α(x,y).假设α对应一个常返的马氏链 .那么 ,\nβ也对应一个常返的马氏链 .\n注意到把α(x,y)降为 0相当于从图 G= (V,E)中删掉边 fx,yg.所\n以,我们有如下推论 :\n推论 5.4.2.假设G= (V,E)常返 ,那么 ,G′= (V,E′)也常返 ,其中 ,\nE′\u001aE.78 第五章 可逆马氏链\n接下来 ,我们证明定理 5.4.1 .由于有限状态空间上的对称马氏链总是常\n返的 ,所以 ,我们假设V是个可数无穷集 .另外 ,我们可以假设存在 x0使得\nβ(x0)≜P\ny:y̸=x0β(x0,y)>0.否则 ,马氏链将停留在出发点 ,一定是常返的 .\n假定我们把 V中的点写为 fx0,x1,...,x n,...g.取An=fxn,xn+1,...g.从\nx0开始一个马氏链 ,用hn(x0;α)表示从x0出发的马氏链离开 x0后,在返\n回x0之前到达An的概率 .那么 ,\nlim\nn→∞hn(x0;α) =P(8n\u00151,Xn6=x0jX0=x).\n所以 ,马氏链常返当且仅当\nlim\nn→∞hn(x0;α) = 0.\n我们将证明如下引理 .\n引理 5.4.3.\nhn(x0,β)\u0014α(x0)\nβ(x0)hn(x0;α).\n利用这一引理足以说明定理 5.4.1成立 .接下来 ,我们试图证明引理 5.4.3 .\n我们定义狄氏型\nEα(g) =X\nx,y∈Vα(x,y)(g(x)\u0000g(y))2,\n其中 ,g(x0) = 1 ,gjAn\u00110.容易证明 Eα(g)存在最小值 Eα(x0;A).假设最\n小值在g取到 .那么 ,g一定是临界值 .利用变分法 ,可以发现临界值满足 :\n对于所有满足 hj{x0}∪An= 0的函数h,\nX\nx,y∈Vα(x,y)(g(x)\u0000g(y))(h(x)\u0000h(y)) = 0.\n这等价于\nX\nx,y∈Vα(x,y)(g(x)h(x) +g(y)h(y)\u0000g(x)h(y)\u0000g(y)h(x)) = 0.\n利用α(x,y)的对称性 ,这又等价于\nX\nx∈Vh(x)X\ny∈Vα(x,y)(g(x)\u0000g(y)) = 0.第 5.4节 常返的判定准则 79\n由h(x)的任意性 ,我们有 8x/2 fx0g [An,\nX\ny∈Vα(x,y)(g(x)\u0000g(y)) = 0. (5.1)\n满足 (5.1 )的函数被称为在 fx0g [An外调和的函数 .根据调和函数的极大值\n原理 ,给定边界值条件 g(x0) = 1 ,gjAn= 0 ,这样的调和函数是唯一的 .更进\n一步的这样的函数有如下概率表达 :\ng(x) =P((Xt)t≥0在到达An之前到达x0jX0=x).\n根据第一次离开 x0后到达的状态分类讨论 ,利用调和函数的性质和边界值\n条件 ,我们看到\nhn(x0;α) =X\ny̸=x0α(x0,y)\nα(x0)(1\u0000g(y))\n=X\ny̸=x0α(x0,y)\nα(x0)g(x0)(g(x0)\u0000g(y))\n=1\nα(x0)X\nx∈Vg(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n\u00001\nα(x0)X\nx/∈{x0}∪Ang(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n\u00001\nα(x0)X\nx∈Ang(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n=1\nα(x0)Eα(g)\u00000\u00000\n=1\nα(x0)Eα(x0;An).\n对于同一个 g,我们有\nEβ(g)\u0014 Eα(g).\n所以 ,对于最小值 ,我们有\nEβ(x0;An)\u0014 Eα(x0;An).\n因", "对称性 ,这又等价于\nX\nx∈Vh(x)X\ny∈Vα(x,y)(g(x)\u0000g(y)) = 0.第 5.4节 常返的判定准则 79\n由h(x)的任意性 ,我们有 8x/2 fx0g [An,\nX\ny∈Vα(x,y)(g(x)\u0000g(y)) = 0. (5.1)\n满足 (5.1 )的函数被称为在 fx0g [An外调和的函数 .根据调和函数的极大值\n原理 ,给定边界值条件 g(x0) = 1 ,gjAn= 0 ,这样的调和函数是唯一的 .更进\n一步的这样的函数有如下概率表达 :\ng(x) =P((Xt)t≥0在到达An之前到达x0jX0=x).\n根据第一次离开 x0后到达的状态分类讨论 ,利用调和函数的性质和边界值\n条件 ,我们看到\nhn(x0;α) =X\ny̸=x0α(x0,y)\nα(x0)(1\u0000g(y))\n=X\ny̸=x0α(x0,y)\nα(x0)g(x0)(g(x0)\u0000g(y))\n=1\nα(x0)X\nx∈Vg(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n\u00001\nα(x0)X\nx/∈{x0}∪Ang(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n\u00001\nα(x0)X\nx∈Ang(x)X\ny∈Vα(x,y)(g(x)\u0000g(y))\n=1\nα(x0)Eα(g)\u00000\u00000\n=1\nα(x0)Eα(x0;An).\n对于同一个 g,我们有\nEβ(g)\u0014 Eα(g).\n所以 ,对于最小值 ,我们有\nEβ(x0;An)\u0014 Eα(x0;An).\n因此 ,我们有\nβ(x0)hn(x0;β)\u0014α(x0)hn(x0;α).\n例 5.11.利用推论 5.4.2 ,从Zd中删去一些边 ,可以知道六边形网格上的连\n续时间简单随机游走是常返的 .80 第五章 可逆马氏链第六章 更新过程\n第 6.1节 引言\n设(Tn)n≥1是独立同分布的非负随机变量序列 .通常 ,我们把Tn看成\n一个零件的寿命 ,或者某事件相继发生的时间间隔 .和(Tn)n≥1相关的 ,我\n们定义一个计数过程 Nt:\nNt= maxfn:T1+T2+\u0001 \u0001 \u0001+Tn\u0014tg.\n这里 ,T1,T1+T2,...是事件的发生时刻 ,Nt表示直到t时刻发生的事件总\n次数 .我们称Nt是与 (Tn)n≥1相联系的更新过程 (renewal process). 如果\n我们Tn看成一个零件的寿命 ,那么 ,我们假设在时刻 0时,我们有一个全新\n的零件 ,Nt表示直到t时刻我们更换零件的次数 .\n自然的 ,也有可能在时刻 0时,零件已经被使用了一段时间 .我们假设\n它的剩余寿命是 Y.那么 ,Y和T1可能不同分布 .我们假设接下来的全新\n零件的寿命是独立同分布的 (Tn)n≥1.我们用Nt表示直到t时刻的累计更\n换零件的次数 .那么 ,数学上 ,如果Y >t ,那么 ,Nt= 0 ;如果Y\u0014t,那么 ,\nNt= minfn:Y+T1+T2+\u0001 \u0001 \u0001+Tn>tg.\n此时 ,我们把Nt称为 (延迟的 )更新过程 ((delayed) renewal process). 它可\n以看成是之前狭义的更新过程的一个推广 .在本章中 ,为了简单起见 ,我们\n假设\nµ=E(Tn)2(0,+1).\n例 6.1 (泊松过程 ).泊松过程是一个更新过程 .其中 ,Tn服从参数为 λ的指\n数分布 .\n例 6.2.考虑一个起始于状态 y的不可约、正常返离散时间马氏链 (Xn)n≥0.\n用Nt表示直到 [t]时刻 ,马氏链累计访问状态 x的次数 .那么 ,Nt是一个\n8182 第六章 更新过程\n(延迟的 )更新过程 .其中 ,\nY= minfn:Xn=xg,\n而Tn是第n次访问x和第n+ 1次访问x的时间间隔 .如果y=x,那么 ,\nY= 0 .此时 ,Nt恰好是一个更新过程 .\n例 6.3 (M/G/1 排队系统 ).M/G/1排队系统和 M/M/1排队系统有相似\n之处 .都是只有一个服务员的排队系统 .这里的 M表示指数分布 ,对于\nM/M/1系统 ,顾客的到达被一个参数为 λ的泊松过程所描述 .上一个顾客\n到达的时刻和下一个顾客到达时刻的间隔是参数为 λ的指数随机变量 .这\n对应于 M/M/1排队系统里的第 1个 M.第二个 M指每个顾客的服务时间\n是独立的参数为 µ的指数随机变量 .而在 M/G/1排队系统中 , G代表一般\n的,它表示顾的服务时间虽然还是独立的 ,但是却服从一般的分布 ,不一定\n是指数分布 .我们假设顾客服务时间的均值是 µ.对于实际的排队系统 ,服\n务时间往往没有无记忆性 ,所以 ,我们不再作指数分布的假设 .因而 ,我们将\nM/M/1排队系统推广到 M/G/1排队系统 .我们用Yt表示时刻t时,队列\n中的顾客数 .那么 ,由于服务时间不再是指数分布 ,一般而言 ,Yt不再是连续\n时间马氏链 .但是 ,Yt却和一个更新过程有关系 .假设Y0= 0 .设\nR1= infft>0 :Yt= 1g,\nS1= infft>0 :YR1+t= 0g,\nT1=R1+S1.\n类似的 ,当n\u00151时,我们定义\nRn= infft>0 :YT1+T2+···+Tn−1+t= 1g,\nSn= infft>0 :YT1+T2+···+Tn−1+Rn+t= 0g,\nTn=Rn+Sn.\n可将Rn看作是系统的闲期的片段长度 ,Sn是系统的忙期片段的长度 ,Tn\n是系统的第 n个周期 .在E(Tn)<+1的假设下 ,fTngn≥1是独立同分布\n的期望有限的正随机变量 ,对应一个更新过程 .其中 ,Rn服从参数为 λ的指\n数分布 ,但是Sn的分布较为复杂 .第 6.2节 更新方程 83\n更新过程Nt本身不是连续时间马氏链 .为了预测下一次事件发生的时\n刻,我们必须直到上一次事件发生的时刻 .由此 ,启发我们定义年龄过", "虽然还是独立的 ,但是却服从一般的分布 ,不一定\n是指数分布 .我们假设顾客服务时间的均值是 µ.对于实际的排队系统 ,服\n务时间往往没有无记忆性 ,所以 ,我们不再作指数分布的假设 .因而 ,我们将\nM/M/1排队系统推广到 M/G/1排队系统 .我们用Yt表示时刻t时,队列\n中的顾客数 .那么 ,由于服务时间不再是指数分布 ,一般而言 ,Yt不再是连续\n时间马氏链 .但是 ,Yt却和一个更新过程有关系 .假设Y0= 0 .设\nR1= infft>0 :Yt= 1g,\nS1= infft>0 :YR1+t= 0g,\nT1=R1+S1.\n类似的 ,当n\u00151时,我们定义\nRn= infft>0 :YT1+T2+···+Tn−1+t= 1g,\nSn= infft>0 :YT1+T2+···+Tn−1+Rn+t= 0g,\nTn=Rn+Sn.\n可将Rn看作是系统的闲期的片段长度 ,Sn是系统的忙期片段的长度 ,Tn\n是系统的第 n个周期 .在E(Tn)<+1的假设下 ,fTngn≥1是独立同分布\n的期望有限的正随机变量 ,对应一个更新过程 .其中 ,Rn服从参数为 λ的指\n数分布 ,但是Sn的分布较为复杂 .第 6.2节 更新方程 83\n更新过程Nt本身不是连续时间马氏链 .为了预测下一次事件发生的时\n刻,我们必须直到上一次事件发生的时刻 .由此 ,启发我们定义年龄过程 At:\nAt=(\nt, Nt= 0,\nt\u0000PNt\nj=1Tj, N t>0.\n过程 (Nt,At)是一个马氏过程 .\n利用标准的极限定理可以得到更新过程的极限定理 .\n定理 6.1.1 (大数定律 ).以概率 1,我们有\nlim\nt→∞Nt\nt=1\nµ.\n定理 6.1.2 (中心极限定理 ).如果等待时间 Ti的均值为µ,方差为σ2,那\n么,当t! 1时,\nNt\u0000µ−1t\nσµ3/2p\nt\n依分布收敛于标准正态随机变量 .\n第 6.2节 更新方程\n我们对更新过程的极限行为感兴趣 .我们记\nU(t) =E(Nt) + 1.\n我们将给出两个更新定理 .\n定理 6.2.1 (更新定理 I).\nlim\nt→∞U(t)\nt=1\nµ.\n接下来 ,我们介绍更新定理 II.为此 ,我们需要区分等待时间分布的两\n种不同情况 .\n定义 6.2.1.对于一个非负的随机变量 X,如果存在a>0,使得\nP(X是a的整数倍 ) = 1,\n那么 ,我们称X服从格点分布 ,并称满足条件的最大的 a>0为分布的 周期\n(period) .否则 ,称X不服从格点分布 .84 第六章 更新过程\n定理 6.2.2 (更新定理 II) .如果T1,T2,...不服从格点分布 ,那么 ,8r>0,\nlim\nt→∞U(t+r)\u0000U(t) =r/µ.\n如果T1,T2,...服从周期为 a的格点分布 ,那么 ,\nlim\nn→∞U((n+ 1)a)\u0000U(na) =a/µ.\n由更新定理 II,可以推出如下关键更新定理 :\n定理 6.2.3 (关键更新定理 ).假设h(t)是一个有界函数 ,且R+∞\n0jh(t)jdt<\n+1,那么 ,\nlim\nt→∞Zt\n0h(t\u0000s)dU(s) =1\nµZ+∞\n0h(t)dt.\n我们将利用关键更新定理推导 At的极限分布 ,以此来展示关键更新定\n理的使用方式 .为此 ,我们假设等待间隔的分布是非格点的 .\n推导的第一步在于建立 更新方程 (renewal equation) .所谓更新方程指\n的是如下形式的积分方程 :\nϕ(t) =h(t) +Zt\n0ϕ(t\u0000s)dF(s), t\u00150\n其中 ,F是等待间隔的分布函数 ,h被认为是我们已经充分了解的已知函数 ,\nϕ是未知函数 .\n我们令ϕ(t) =P(At\u0014x).我们来推导 ϕ(t)满足的更新方程 .我们根据\nT1的取值是否小于等于 t分类讨论 :\nϕ(t) =P(At\u0014x)\n=P(At\u0014x,T 1>t) +P(At\u0014x,T 1\u0014t)\n= 1 [0,x](t)P(T1>t) +P(At\u0014x,T 1\u0014t)\n= 1 [0,x](t)(1\u0000F(t)) +E(P(At\u0014x,T 1\u0014tjT1)).\n利用 (Tn)n≥1独立同分布的性质 ,我们有\nP(At\u0014xjT1=s) =P(At−s\u0014x) =ϕ(t\u0000s),0\u0014s\u0014t.\n因此 ,我们有\nE(P(At\u0014x,T 1\u0014tjT1)) =E(ϕ(t\u0000T1)1T1≤t)第 6.2节 更新方程 85\n=Zt\n0ϕ(t\u0000s)dF(s).\n综上 ,ϕ(t)满足更新方程 ,其中 ,h(t) = 1 [0,x](t)(1\u0000F(t)).\n接下来 ,我们对t\u00150求解更新方程 .为此 ,我们需要一些条件 .我们假\n设Rt\n0h(t\u0000s)dU(s)是有限的 ,并且8t\u00150,\nsup\ns∈[0,t]jϕ(s)j<+1.\n为了求解更新方程 ,我们首先将更新方程写成\nϕ(t) =h(t) +ϕ\u0003F(t).\n将这个等式代入等式右端的 ϕ中,可以得到\nϕ(t) =h(t) + (h+ϕ\u0003F)\u0003F(t) =h(t) +h\u0003F(t) +ϕ\u0003F\u0003F(t).\n反复将更新方程代入新得到的等式右端 ,可以知道\nϕ(t) =h(t) +n−1X\nj=1h\u0003F(j)(t) +ϕ\u0003F(n)(t),\n其中 ,F(j)(t)是T1+T2+\u0001 \u0001 \u0001+Tj的分布函数 .我们将证明如下断言 :\n断言 6.2.4.\nϕ\u0003F(n)(t)n→∞!0,8t\u00150.\n从而 ,可以解得\nϕ(t) =h(t) ++∞X\nj=1h\u0003F(j)(t). (6.1)\n注意到\nU(t) =E(Nt+ 1)\n= 1 ++∞X\nn=1P(Nt\u0015n)\n= 1 ++∞X\nn=1P(T1+T2+\u0001 \u0001 \u0001+Tn\u0014t)\n= 1 ++∞X\nn=1F(n)(t)86 第六章 更新过程\n由此知道\nh\u0003U(t) =Zt\n0h(t\u0000s)dU(s) =h(t) ++∞X\nj=1h\u0003F(j)(t).\n所以 ,\nϕ(t) =Zt\n0h(t\u0000s", "\n=Zt\n0ϕ(t\u0000s)dF(s).\n综上 ,ϕ(t)满足更新方程 ,其中 ,h(t) = 1 [0,x](t)(1\u0000F(t)).\n接下来 ,我们对t\u00150求解更新方程 .为此 ,我们需要一些条件 .我们假\n设Rt\n0h(t\u0000s)dU(s)是有限的 ,并且8t\u00150,\nsup\ns∈[0,t]jϕ(s)j<+1.\n为了求解更新方程 ,我们首先将更新方程写成\nϕ(t) =h(t) +ϕ\u0003F(t).\n将这个等式代入等式右端的 ϕ中,可以得到\nϕ(t) =h(t) + (h+ϕ\u0003F)\u0003F(t) =h(t) +h\u0003F(t) +ϕ\u0003F\u0003F(t).\n反复将更新方程代入新得到的等式右端 ,可以知道\nϕ(t) =h(t) +n−1X\nj=1h\u0003F(j)(t) +ϕ\u0003F(n)(t),\n其中 ,F(j)(t)是T1+T2+\u0001 \u0001 \u0001+Tj的分布函数 .我们将证明如下断言 :\n断言 6.2.4.\nϕ\u0003F(n)(t)n→∞!0,8t\u00150.\n从而 ,可以解得\nϕ(t) =h(t) ++∞X\nj=1h\u0003F(j)(t). (6.1)\n注意到\nU(t) =E(Nt+ 1)\n= 1 ++∞X\nn=1P(Nt\u0015n)\n= 1 ++∞X\nn=1P(T1+T2+\u0001 \u0001 \u0001+Tn\u0014t)\n= 1 ++∞X\nn=1F(n)(t)86 第六章 更新过程\n由此知道\nh\u0003U(t) =Zt\n0h(t\u0000s)dU(s) =h(t) ++∞X\nj=1h\u0003F(j)(t).\n所以 ,\nϕ(t) =Zt\n0h(t\u0000s)dU(s).\n这样我们就解出了更新方程 .接下来 ,我们给出断言 6.2.4的证明 :\n断言 6.2.4的证明 .注意到\nϕ\u0003F(n)(t) =Zt\n0ϕ(t\u0000s)dF(n)(s)\n=E(ϕ(t\u0000(T1+T2+\u0001 \u0001 \u0001+Tn))1T1+T2+···+Tn≤t).\n我们有M(t)<+1,使得\njϕ(t\u0000(T1+T2+\u0001 \u0001 \u0001+Tn))j \u0014 sup\ns∈[0,t]jϕ(s)j=M(t)<+1.\n最后 ,我们只需要注意到 limn→∞P(T1+T2+\u0001 \u0001 \u0001+Tn\u0014t) = 0 ,8t\u00150.\n最后 ,我们应用关键更新定理 ,即可得到\nlim\nt→∞P(At\u0014x) = lim\nt→∞ϕ(t) =1\nµZ+∞\n0h(t)dt=Zx\n0(1\u0000F(t))dt/µ.\n我们定义\nΨA(x) =(Rx\n0(1\u0000F(t))dt/µ, x \u00150,\n0, x<0.\n可以验证 ΨA(x)是一个分布函数 ,密度函数为\nψA(x) =1\nµ(1\u0000F(x)),x> 0.\n例 6.4.假设等待时间服从 (0,1)上的均匀分布 .那么 ,\nψA(x) =8\n>><\n>>:0,x\u00140,\n2(1\u0000x),0<x< 1,\n0,x\u00151.\n从这个例子看出 ,年龄的极限分布和等待时间的极限分布并不相同 .第 6.2节 更新方程 87\n现在我们考虑另外两个过程 ,剩余寿命 (residual life)\nBt= inffs\u00150 :Nt+s>N tg\n和全寿命 (total life)\nCt=At+Bt.\n我们先考虑剩余寿命 Bt的极限分布 .根据T1是否大于t进行讨论 ,我们有\nϕB,x(t) =P(Bt\u0014x) =P(Bt\u0014x,T 1>t) +P(Bt\u0014x,T 1\u0014t)\n=P(t<T 1\u0014t+x) +E(P(Bt\u0014x,T 1\u0014tjT1))\n=F(t+x)\u0000F(t) +E(ϕB,x(t\u0000T1)1T1≤t)\n=F(t+x)\u0000F(t) +Zt\n0ϕB,x(t\u0000s)dF(s).\n这样 ,我们就建立了更新方程 .求解更新方程 ,我们得到\nP(Bt\u0014x) =Zt\n0(F(t+x\u0000s)\u0000F(t\u0000s))dU(s).\n利用关键更新定理 ,我们得到\nΨB(x) = lim\nt→∞P(Bt\u0014x) =1\nµZ+∞\n0(F(t+x)\u0000F(t))dt\n=Zx\n0(1\u0000F(t))dt/µ.\n可以发现 ,剩余寿命Bt和年龄At有相同的极限分布 .\n接下来 ,我们考虑全寿命 Ct和全寿命的分布 P(Ct\u0014x).同样的 ,我们\n根据T1是否大于t进行讨论 ,我们有\nϕC,x(t)≜P(Ct\u0014x) =P(Ct\u0014x,T 1>t) +P(Ct\u0014x,T 1\u0014t)\n= 1 [0,x](t)P(t<T 1\u0014x) +E(P(Ct\u0014x,T 1\u0014tjT1))\n= 1 [0,x](t)(F(x)\u0000F(t)) +E(ϕC,x(t\u0000T1)1T1≤t)\n= 1 [0,x](t)(F(x)\u0000F(t)) +Zt\n0ϕC,x(t\u0000s)dF(s).\n于是 ,我们得到了更新方程 .求解更新方程 ,并应用关键更新定理 ,我们得到\nΨC(x) = lim\nt→∞Zt\n01[0,x](t\u0000s)(F(x)\u0000F(t\u0000s))dU(s)88 第六章 更新过程\n=1\nµZ+∞\n01[0,x](t)(F(x)\u0000F(t))dt\n=1\nµ(xF(x)\u0000Zx\n0F(t)dt).\n这里 ,ΨC(x)是一个分布函数 ,对应的密度函数为\nψC(x) =1\nµxf(x).\n系统零件的寿命独立同分布 ,期望值是µ.对于很大的时刻 t,剩余寿命\n的期望值大概是\nZ+∞\n0xψB(x)dx=1\nµZ+∞\n0x(1\u0000F(x))dx=1\n2µZ+∞\n0x2dF(x),\n和µ并不相同 ,甚至有可能超过 µ.更有甚者 ,当零件寿命的期望存在 ,方差\n等于正无穷的时候 ,还会出现剩余寿命的期望等于无穷的情况 .\n第 6.3节 平稳更新过程\n令ΨB(x)是剩余寿命的极限分布 ,即\nΨB(x) =Zx\n0(1\u0000F(t))dt.\n假设 (Tn)n≥1独立同分布 ,共同的分布函数是 F.假设Y的分布函数是\nΨB(x),且Y和(Tn)n≥1独立 .那么 ,根据Y,T 1,T2,...定义延迟更新过程\nNt:当t<Y时,Nt= 0 ;当t\u0015Y时,\nNt= minfn:Y+T1+T2+\u0001 \u0001 \u0001+Tn>tg.\n那么 ,(Nt)t≥0有平稳的增量 :8s\u00150,(Nt+s\u0000Ns)t≥0和(Nt)t≥0", "(x) = lim\nt→∞Zt\n01[0,x](t\u0000s)(F(x)\u0000F(t\u0000s))dU(s)88 第六章 更新过程\n=1\nµZ+∞\n01[0,x](t)(F(x)\u0000F(t))dt\n=1\nµ(xF(x)\u0000Zx\n0F(t)dt).\n这里 ,ΨC(x)是一个分布函数 ,对应的密度函数为\nψC(x) =1\nµxf(x).\n系统零件的寿命独立同分布 ,期望值是µ.对于很大的时刻 t,剩余寿命\n的期望值大概是\nZ+∞\n0xψB(x)dx=1\nµZ+∞\n0x(1\u0000F(x))dx=1\n2µZ+∞\n0x2dF(x),\n和µ并不相同 ,甚至有可能超过 µ.更有甚者 ,当零件寿命的期望存在 ,方差\n等于正无穷的时候 ,还会出现剩余寿命的期望等于无穷的情况 .\n第 6.3节 平稳更新过程\n令ΨB(x)是剩余寿命的极限分布 ,即\nΨB(x) =Zx\n0(1\u0000F(t))dt.\n假设 (Tn)n≥1独立同分布 ,共同的分布函数是 F.假设Y的分布函数是\nΨB(x),且Y和(Tn)n≥1独立 .那么 ,根据Y,T 1,T2,...定义延迟更新过程\nNt:当t<Y时,Nt= 0 ;当t\u0015Y时,\nNt= minfn:Y+T1+T2+\u0001 \u0001 \u0001+Tn>tg.\n那么 ,(Nt)t≥0有平稳的增量 :8s\u00150,(Nt+s\u0000Ns)t≥0和(Nt)t≥0的分布相\n同.这是因为剩余寿命 Bt的分布不随 t发生改变 .\n第 6.4节 离散更新过程\n在本节中 ,我们假设等待时间 (Tn)n≥1的分布是格点的 .不失一般性的 ,\n通过选取合适的时间单位 ,我们总可以假设周期为 1.于是 ,我们考虑在非负\n整数时间更新的离散更新过程 .我们将推导年龄过程、剩余寿命和全寿命的第 6.4节 离散更新过程 89\n极限分布 .这些结果可以作为第 6.2节中非格点分布情形下的相关结果的重\n要补充 .\n由于 (Tn)n≥1的周期为 1,所以 ,它们是离散型随机变量 .对于这种随机\n变量 ,相较于分布函数 F,更方便的描述和处理方式是使用分布列 (pn)n≥0.\n其中 ,pn=P(Ti=n).为简便起见 ,我们假设p0= 0 .\n回忆我们用 µ表示等待时间 Tn的期望 .此时 ,我们有\nµ=E(Tn) =+∞X\nn=1npn.\n对于j\u00150,我们定义离散时间计数过程 Nj:\nNj=(\n0, T1>j;\nmaxfn:T1+T2+\u0001 \u0001 \u0001+Tn\u0014jg, T 1\u0014j.\n类似的 ,我们可以定义年龄过程 Aj:当j <T 1时,Aj=j;否则 ,\nAj=j\u0000X\nk≤NjTk.\n我们观察到一个关键的事实 :(Aj)j≥0实际上是个离散时间马氏链 .更\n确切的 ,其转移概率为\np(n,0) =λn+1,p(n,n+ 1) = 1 \u0000λn+1,\n其中 ,\nλn=P(Ti=njTi>n\u00001) =pn/+∞X\nk=npk.\n令K为满足pk>0的最大的k.那么 ,当K < +1时,马氏链 (Aj)j≥1\n的状态空间为 S=f0,1,...,K \u00001g.不难发现 ,该马氏链不可约 .由于等\n待时间的周期为 1,马氏链 (Aj)j≥0也是非周期的 .当K= +1时,马氏链\n(Aj)j≥1的状态空间为 S=N.该马氏链仍然是不可约、非周期的 .(Aj)j≥0\n回到 0的间隔为 (Tn)n≥1,所以 ,马氏链 (Aj)j≥1正常返当且仅当 µ<+1.\n我们总假设 µ<+1.根据定理 3.5.1 ,Aj有极限分布 ,该极限分布是马氏链\n(Aj)j≥0唯一的平稳分布 π.所以 ,我们接下来求解 π.根据平稳分布满足的\n方程 ,应该有 8n\u00151\nπ(n\u00001)p(n\u00001,n) =π(n),90 第六章 更新过程\n+∞X\nn=0π(n)p(n,0) =π(0).\n解得\nπ(n) =P(Ti>n)\nE(Ti)=1\nµ+∞X\nk=n+1pk.\n因此 ,我们有\nψA(n) = lim\nj→∞P(Aj=n) =π(n) =1\u0000F(n)\nµ.\n接下来 ,我们考虑剩余寿命 ,\nBj= minfk>0 :Nj+k>N jg.\n我们可以计算 Bj的极限分布 ,\nψB(n) = lim\nj→∞P(Bj=n)\n= lim\nj→∞+∞X\nm=0P(Aj=m)P(Bj=njAj=m)\n= lim\nj→∞+∞X\nm=0P(Aj=m)P(Ti=n+mjTi>m)\n=+∞X\nm=0π(m)P(Ti=n+mjTi>m)\n=+∞X\nm=0P(Ti>m)\nE(Ti)P(Ti=n+mjTi>m)\n=P(Ti\u0015n)\nE(Ti)\n=1\u0000F(n\u00001)\nµ.\n可见 ,\nψB(n) =ψA(n\u00001).\n剩余寿命的极限分布和年龄的极限分布除了相差 1以外是完全相同的 .而\n相差 1是因为剩余寿命的最小值为 1,而年龄过程的最小值为 0.\n全寿命\nCj=Aj+Bj.第 6.4节 离散更新过程 91\n那么 ,\nψC(n) = lim\nj→∞P(Cj=n)\n= lim\nj→∞+∞X\nm=0P(Aj=m)P(Cj=njAj=m)\n=+∞X\nm=0π(m)P(Ti=njTi>m)1m<n\n=+∞X\nm=0P(Ti>m)\nE(Ti)P(Ti=njTi>m)1m<n\n=n−1X\nm=0pn\nµ\n=npn\nµ.\n例 6.5 (伯努利过程 ).令0< p < 1,设X1,X2,...为相互独立的随机变量\n且\nP(Xi= 1) = 1 \u0000P(Xi= 0) =p.\n令Nj=X1+X2+\u0001 \u0001 \u0001+Xj表示前j次试验中 “成功 ”的次数 .那么 ,等待\n时间 (Tn)n≥1独立同分布于参数为 p的几何分布 ,均值为 1/p.根据之前的\n结果 ,年龄过程", "X\nm=0P(Aj=m)P(Bj=njAj=m)\n= lim\nj→∞+∞X\nm=0P(Aj=m)P(Ti=n+mjTi>m)\n=+∞X\nm=0π(m)P(Ti=n+mjTi>m)\n=+∞X\nm=0P(Ti>m)\nE(Ti)P(Ti=n+mjTi>m)\n=P(Ti\u0015n)\nE(Ti)\n=1\u0000F(n\u00001)\nµ.\n可见 ,\nψB(n) =ψA(n\u00001).\n剩余寿命的极限分布和年龄的极限分布除了相差 1以外是完全相同的 .而\n相差 1是因为剩余寿命的最小值为 1,而年龄过程的最小值为 0.\n全寿命\nCj=Aj+Bj.第 6.4节 离散更新过程 91\n那么 ,\nψC(n) = lim\nj→∞P(Cj=n)\n= lim\nj→∞+∞X\nm=0P(Aj=m)P(Cj=njAj=m)\n=+∞X\nm=0π(m)P(Ti=njTi>m)1m<n\n=+∞X\nm=0P(Ti>m)\nE(Ti)P(Ti=njTi>m)1m<n\n=n−1X\nm=0pn\nµ\n=npn\nµ.\n例 6.5 (伯努利过程 ).令0< p < 1,设X1,X2,...为相互独立的随机变量\n且\nP(Xi= 1) = 1 \u0000P(Xi= 0) =p.\n令Nj=X1+X2+\u0001 \u0001 \u0001+Xj表示前j次试验中 “成功 ”的次数 .那么 ,等待\n时间 (Tn)n≥1独立同分布于参数为 p的几何分布 ,均值为 1/p.根据之前的\n结果 ,年龄过程的渐进分布为\nψA(n) =1\u0000F(n)\nµ=p(1\u0000p)n.\n即年龄比服从几何分布的随机变量少 1.所以 ,由于ψB(n) =ψA(n\u00001),所\n以,剩余寿命的渐进分布为参数为 p的几何分布 .对于总寿命 ,其渐进分布\nψC(n) =npn/µ=np2(1\u0000p)n−1,\n恰好是具有分布列 ψA(\u0001)和分布列ψB(n)的随机变量的独立和 .由此 ,我们\n看到年龄和剩余寿命渐进独立 .\n例 6.6.我们假设F是f1,2,..., 10g上的均匀分布 .那么 ,µ=11\n2.年龄的\n渐进分布为\nψA(n) =1\u0000F(n)\nµ=10\u0000n\n55, n = 0,1,..., 9.92 第六章 更新过程\n所以 ,剩余寿命的渐进分布为\nψB(n) =ψA(n\u00001) =11\u0000n\n55, n = 1,2,..., 10.\n而总寿命的渐进分布为\nψC(n) =npn\nµ=n\n55,n= 1,2,..., 10.\n可见 ,在这种情形下 ,年龄和剩余寿命并不是渐进独立的 .第七章 高斯向量和高斯过程\n第 7.1节 高斯随机向量\n定义 7.1.1.假设X1,X2,...,X n是n个独立同分布的标准正态随机变\n量.记X= (X1,X2,...,X n)t.令Am×n是一个m\u0002n的实矩阵 .令\nµ= (µ1,µ2,...,µ m)T是m维实列向量 .令Y= (Y1,Y2,...,Y m)t=AX+µ.\n那么 ,Y被称为是多维正态随机变量 ,也称之为高斯随机向量 .\n注 7.1.1.由高斯随机向量的定义可以发现高斯随机向量的仿射变换仍然是\n高斯随机向量 ,这是因为仿射变换和仿射变换的复合仍然是仿射变换 .\n命题 7.1.2.假设Y是高斯随机向量 .考虑Y的特征函数\nφ(t) =φ(t1,t2,...,t m) =E(ei⟨t,Y⟩) =E(ei∑m\nj=1tjYj).\n那么 ,我们有\nφ(t) =ei⟨µ,t⟩−1\n2⟨t,Σt⟩\n=ei∑m\nj=1µjtj−1\n2∑m\nj,k=1Σjktjtk.\n其中 ,µj=E(Yj),8j= 1,2,...,m ,Σij= Cov(Yi,Yj).\n注 7.1.3.因为特征函数和分布互相决定 ,所以 ,从上面的命题 ,我们看到\n高斯向量的分布完全由均值向量 µ和协方差矩阵 Σ所决定 .此分布记为\nN(µ,Σ) .\n利用高斯随机向量的定义以及高斯随机向量的特征函数 ,不难得到如下\n高斯随机向量的判断方法 .\n定理 7.1.4.随机向量 (Y1,Y2,...,Y m)是高斯的 ,当且仅当其任意线性组合\n都是高斯随机变量 .\n9394 第七章 高斯向量和高斯过程\n利用特征函数 ,不难求得高斯向量的混合矩 .高斯向量的混合矩可以总\n结为如下 Wick公式 ,可以通过将特征函数展开成幂级数 ,然后比较对应项\n的系数得到 .\n定理 7.1.5 (Wick公式 ).假设X= (X1,X2,...,X n)是零均值的高斯向量 .\n那么 ,我们有\nE(X1X2\u0001 \u0001 \u0001Xn) = 1 n是偶数X\n顶点集 {1,2,...,n}\n上的完美匹配图 GY\n{i,j}∈GCov(Xi,Xj).\n注意到在上式中 , Cov (Xi,Xj) =E(XiXj).\n例 7.1.假设X= (X1,X2,...,X n)是零均值的高斯向量 .其协方差矩阵为\nΣ.那么 ,Y= (Y1,Y2,Y3,Y4) = (X1,X1,X2,X2)也是零均值的高斯向量 .那\n么,\nE(X2\n1X2\n2) =E(Y1Y2Y3Y4)\n=E(Y1Y2)E(Y3Y4) +E(Y1Y3)E(Y2Y4) +E(Y1Y4)E(Y2Y3)\n=E(X2\n1)E(X2\n2) + 2(E(X1X2))2\n= Σ 11Σ22+ 2Σ2\n12.\n注 7.1.6.从 Wick公式 ,我们看到零均值高斯向量的混合矩是协方差的多\n项式 .\n一般来说 ,协方差矩阵 Σ只是半正定的 .当 detΣ = 0时,高斯向量的\n取值支撑在更低�", "�章 高斯向量和高斯过程\n利用特征函数 ,不难求得高斯向量的混合矩 .高斯向量的混合矩可以总\n结为如下 Wick公式 ,可以通过将特征函数展开成幂级数 ,然后比较对应项\n的系数得到 .\n定理 7.1.5 (Wick公式 ).假设X= (X1,X2,...,X n)是零均值的高斯向量 .\n那么 ,我们有\nE(X1X2\u0001 \u0001 \u0001Xn) = 1 n是偶数X\n顶点集 {1,2,...,n}\n上的完美匹配图 GY\n{i,j}∈GCov(Xi,Xj).\n注意到在上式中 , Cov (Xi,Xj) =E(XiXj).\n例 7.1.假设X= (X1,X2,...,X n)是零均值的高斯向量 .其协方差矩阵为\nΣ.那么 ,Y= (Y1,Y2,Y3,Y4) = (X1,X1,X2,X2)也是零均值的高斯向量 .那\n么,\nE(X2\n1X2\n2) =E(Y1Y2Y3Y4)\n=E(Y1Y2)E(Y3Y4) +E(Y1Y3)E(Y2Y4) +E(Y1Y4)E(Y2Y3)\n=E(X2\n1)E(X2\n2) + 2(E(X1X2))2\n= Σ 11Σ22+ 2Σ2\n12.\n注 7.1.6.从 Wick公式 ,我们看到零均值高斯向量的混合矩是协方差的多\n项式 .\n一般来说 ,协方差矩阵 Σ只是半正定的 .当 detΣ = 0时,高斯向量的\n取值支撑在更低维度的超平面上 .但是 ,当Σ非退化的时候 ,即 detΣ6= 0\n的时候 ,高斯向量是连续型随机向量 .下面的命题给出了它的密度函数 .\n命题 7.1.7.假设X= (X1,X2,...,X n)是高斯向量 .其均值向量为 µ,协\n方差矩阵为 Σ.假设 Σ非退化 .那么 ,X有如下的密度函数 p(x):\np(x) =1p\n(2π)ndetΣe−1\n2⟨x−µ,Σ−1(x−µ)⟩,x2Rn.\n关于高斯向量的又一个重要结论是高斯向量的极限仍然是高斯向量 .\n命题 7.1.8.考虑一个m维高斯向量序列 (Xn)n≥1.假设Xn的均值向量为\nµn,协方差矩阵为 Σn.第 7.2节 高斯过程 95\n1.假设当n! 1时,Xn依分布收敛于 X.那么 ,µ= limn→∞µn和\nΣ = limn→∞Σn收敛 .并且 ,X服从分布N(µ,Σ) .\n2.假设Xn依概率收敛到 X.那么 ,对于任意的 p\u00151,Xn也Lp收敛\n到X.\n命题的第一部分可以借用特征函数证明 ,第二部分需利用第一部分结论\n并使用控制收敛定理 .\n第 7.2节 高斯过程\n我们已经了解了高斯向量 .现在 ,我们把高斯向量这个概念推广到可能\n的无穷维的情形 ,得到如下的高斯过程的概念 .\n定义 7.2.1.一个 (实值 )随机过程 (Xt)t∈T被称为是 高斯过程 ,当且仅当Xt\n的任何一个有限的线性组合\nnX\ni=1aiXti\n都服从高斯分布 .\n在高斯过程的定义中 ,指标集T可以是有限的 .此时的高斯过程实际上\n就是有限维高斯向量 .但更多的场合下 ,T是一个无穷集 .这里 ,T可以取一\n些离散的对象 ,如自然数集、整数集或者是一棵树的顶点集 .而T也可以取\n一些连续的对象 ,比如 [0,+1)、实数集、欧几里得空间或者甚至是希尔伯\n特空间 .\n根据高斯过程的定义 ,每个Xt都服从某个高斯分布 N(µt,σ2\nt).更一般\n的,高斯过程 (Xt)t∈T的有限维分布都是高斯的 ,即对于任意的互不相同的\nt1,t2,...,t n2T,(Xt1,Xt2,...,X tn)服从多元高斯分布 .\n定义 7.2.2.对于t2T,我们定义 均值函数µ(t) =E(Xt).\n如果我们令 Yt=Xt\u0000µt,那么 ,(Yt)t∈T是一个中心化的高斯过程 . (“中\n心化 ”是指随机变量的期望为零 .)我们只需要重点关注中心化的高斯过程\n即可 .因此 ,在下面的讨论中 ,我们都默认 考虑的高斯过程是中心化的 (零均\n值的 )!\n定义 7.2.3.对于s,t2T,我们定义 协方差函数 Γ(s,t) = Cov(Xs,Xt).96 第七章 高斯向量和高斯过程\n根据高斯分布的结果 ,(Xt)t∈T的有限维分布实际上完全由协方差函数\n所决定 .实际上 ,对于互不相同的 t1,t2,...,t n2T,令Σ = (Σ ij)i,j=1,2,...,n ,\n其中 ,\nΣij= Γ(ti,tj).\n那么 ,(Xt1,Xt2,...,X tn)服从多元高斯分布 N(0,Σ) .\n后面我们会看到有限维分布实际上确定了过程的分布 .因此 ,高斯过程\n的分布完全由协方差函数所决定 .高斯过程的协方差函数 ,实际上是高斯向\n量的协方差方阵的推广 .对于不同的协方差函数 ,高斯过程的各种性质可以\n相差很多 .\n接下来 ,我们简单讨论一下协方差函数的刻画 .回忆协方差方阵的刻画\n条件 :一个实方阵是协方差方阵当且仅当它是对称非负定矩阵 .首先 ,协方\n差函数需要是实值函数 .对于协方差函数 ,对称性是比较明显的 .这源自于\n协方差的对称性 .实际上 ,\nΓ(s,t) = Cov(Xs,Xt) = Cov(Xt,Xs) = Γ(t,s),8s,t,2T.\n除此以外 ,一个更重要的性质是正定性 ,即对于定义在 T上而支撑在有限个\n点上的实值函数 c(t),我们有\nX\ns,t∈Tc(s)c(t", "s,t2T,我们定义 协方差函数 Γ(s,t) = Cov(Xs,Xt).96 第七章 高斯向量和高斯过程\n根据高斯分布的结果 ,(Xt)t∈T的有限维分布实际上完全由协方差函数\n所决定 .实际上 ,对于互不相同的 t1,t2,...,t n2T,令Σ = (Σ ij)i,j=1,2,...,n ,\n其中 ,\nΣij= Γ(ti,tj).\n那么 ,(Xt1,Xt2,...,X tn)服从多元高斯分布 N(0,Σ) .\n后面我们会看到有限维分布实际上确定了过程的分布 .因此 ,高斯过程\n的分布完全由协方差函数所决定 .高斯过程的协方差函数 ,实际上是高斯向\n量的协方差方阵的推广 .对于不同的协方差函数 ,高斯过程的各种性质可以\n相差很多 .\n接下来 ,我们简单讨论一下协方差函数的刻画 .回忆协方差方阵的刻画\n条件 :一个实方阵是协方差方阵当且仅当它是对称非负定矩阵 .首先 ,协方\n差函数需要是实值函数 .对于协方差函数 ,对称性是比较明显的 .这源自于\n协方差的对称性 .实际上 ,\nΓ(s,t) = Cov(Xs,Xt) = Cov(Xt,Xs) = Γ(t,s),8s,t,2T.\n除此以外 ,一个更重要的性质是正定性 ,即对于定义在 T上而支撑在有限个\n点上的实值函数 c(t),我们有\nX\ns,t∈Tc(s)c(t)Γ(s,t)\u00150.\n实际上 ,这是因为\nX\ns,t∈Tc(s)c(t)Γ(s,t) =X\ns,t∈Tc(s)c(t)Cov(Xs,Xt) = Var(X\nt∈Tc(t)Xt),\n而方差总是非负的 .\n我们接下来的问题是上述协方差函数的刻画是否是充要的 ,即给定一\n个实对称的正定的协方差函数 ,是否都有与之对应的中心化的高斯过程\n(Xt)t∈T?实际上 ,如果T是有限的 ,这种对应关系实际上是协方差阵和\n零均值高斯向量的对应关系 .因此 ,对于T的任何有限子集 S,都存在一个\n和S有关的概率空间 (RS,B(RS),PS)以及其上的随机向量 (Xs)s∈S,使得\n(Xs)s∈S是以 (Γ(s,t))s,t∈S为协方差阵的零均值高斯向量 .现在 ,我们要把\n这些不同的概率空间及其上的随机向量耦合起来 ,构造一个统一的概率空间\n以及其上的随机过程 (Xt)t∈T.此时 ,样本空间、事件域和随机过程 (即随机\n变量族 )的构造可以是标准的 :定义样本空间 Ω为乘积空间 RT.实数集 R第 7.2节 高斯过程 97\n上取标准的拓扑 ,在Ω =RT取乘积拓扑 .对于样本点 ω2Ω,它可以写成多\n维向量 (ωt)t∈T,其中 ,ωt是ω的分量 .然后取事件域 F为Ω上的 Borel事\n件域 .需要指出的是 ,如果F是事件 ,那么存在T的一个可数子集 S=SF,\n使得F是否发生只和指标在 S上的可数个分量构成的子向量 ωs(s2S)有\n关.接下来 ,我们定义随机变量族 (Xt)t∈T.我们定义\nXt(ω)≜ωt,8ω2Ω.\n那么 ,对于t2T,Xt是F-可测的随机变量 .如果一个实值随机过程 (Xt)t∈T\n是如上方式构造的 ,我们称其为规范的 (canonical). ( 任何一个随机过程都\n可以转化成规范的 .)接下来 ,我们只需要定义好概率 P即可 .为了叙述方\n便,我们引进两个术语 :\n定义 7.2.4.假设事件C2 F有形式\nC=Y\nt∈TBt,\n其中 ,除去一个有限子集 S\u001aT,Bt=R.即C是否发生只与样本点 ω的\n有限个分量有关 .那么 ,我们称C是柱集 (cylinder) .\n定义 7.2.5.考虑一个一般的随机过程 (Xt)t∈T.假设S\u001aT是一个有\n限子集 .那么 ,随机向量XS= (Xs)s∈S是从样本空间 (Ω,F)到像空间\n(RS,B(RS))的可测映射 .那么 ,样本空间 (Ω,F)上的概率 P的像测度\nνS=P\u000e(XS)−1即为随机向量 XS的 (概率 )分布 ,即\nνS(Y\ns∈SBs) =P(Xs2Bs,8s2S).\n当S穷尽T的所有有限子集 ,得到的像测度 νS全体称为随机过程 (Xt)t∈T\n的有限维分布 .\n注意到随机过程的有限维分布必然满足相容性 :对于S1\u001aS2是两个有\n限的指标集 ,用νS1和νS2表示对应的有限维分布 .其中 ,νSi是(Xs)s∈Si\n的分布 .因为S1\u001aS2,所以 ,(Xs)s∈S1的分布实际上是 (Xs)s∈S2的边缘分\n布.因此 ,8B2 B(RS1),B\u0002RS2\\S12 B(RS2),并且\nνS1(B) =νS2(B\u0002RS2\\S1),8B2 B(RS1).\n上述性质被称为分布族 (νS)S⊂⊂T的相容性 . (S\u001a\u001aT表示S\u001aT并\n且S是有限子集 .)对于任何有限子指标集 S\u001aT,如果我们定义协方差98 第七章 高斯向量和高斯过程\n阵ΓS= (Γ(s,t))s,t∈S,定义νS是(RS,B(RS))上的概率测度 ,其中 ,此概\n率测度是零均值并以 ΓS为协方差阵的高斯向量的概率分布 .那么 ,因为\n高斯向量的边缘分布仍然是高斯的 ,所以 ,概率分布族 νS是相容的 .根据\nKolmogorov 延拓定理 ,给定一族分别定义在 (RS,B(RS))上的相容的有限\n维概率分布 νS(S\u001a\u001aT),那么 ,存在规范概率空间 (RT,B(RT))上的唯一\n的概率 P,使得νS恰为实值过程 (Xt)t∈T的有限维分布 .于是 ,对于实对称\n", "T\n的有限维分布 .\n注意到随机过程的有限维分布必然满足相容性 :对于S1\u001aS2是两个有\n限的指标集 ,用νS1和νS2表示对应的有限维分布 .其中 ,νSi是(Xs)s∈Si\n的分布 .因为S1\u001aS2,所以 ,(Xs)s∈S1的分布实际上是 (Xs)s∈S2的边缘分\n布.因此 ,8B2 B(RS1),B\u0002RS2\\S12 B(RS2),并且\nνS1(B) =νS2(B\u0002RS2\\S1),8B2 B(RS1).\n上述性质被称为分布族 (νS)S⊂⊂T的相容性 . (S\u001a\u001aT表示S\u001aT并\n且S是有限子集 .)对于任何有限子指标集 S\u001aT,如果我们定义协方差98 第七章 高斯向量和高斯过程\n阵ΓS= (Γ(s,t))s,t∈S,定义νS是(RS,B(RS))上的概率测度 ,其中 ,此概\n率测度是零均值并以 ΓS为协方差阵的高斯向量的概率分布 .那么 ,因为\n高斯向量的边缘分布仍然是高斯的 ,所以 ,概率分布族 νS是相容的 .根据\nKolmogorov 延拓定理 ,给定一族分别定义在 (RS,B(RS))上的相容的有限\n维概率分布 νS(S\u001a\u001aT),那么 ,存在规范概率空间 (RT,B(RT))上的唯一\n的概率 P,使得νS恰为实值过程 (Xt)t∈T的有限维分布 .于是 ,对于实对称\n正定协方差函数 Γ(s,t)存在 (分布 )唯一的中心化高斯过程 (Xt)t∈T.\n注 7.2.1. Kolmogorov 延拓定理里提到的唯一性是因为规范概率空间 Ω =\nRT的 Borel事件域 F实际上由柱集生成 . (唯一性可以用 Dynkin的π\u0000λ\n定理证明 .) Kolmogorov 延拓定理的证明依赖于 Carathéodory 测度延拓定\n理.注意到 P限制在柱集上的取值 ,实际上 ,完全由有限维分布所决定 .更\n具体的 ,假设柱集C=Q\nt∈TBt,其中 ,存在一个有限指标子集 S\u001aT,对于\nt/2S,Bt=R.那么 ,我们有\nP(C) =P(Xs2Bs,8s2S) =νS(Y\ns∈SBs).\n柱集构成代数 A,而P是这个代数 A上的可列可加测度 .根据 Carathéodory\n测度延拓定理 ,该代数 A上的可列可加测度 P唯一的延拓到柱集生成的 σ-\n代数F上.\n另外 ,随机变量Xt取值空间 R可以被替换成任意 Polish空间 Xt.\n(Polish空间 =完备可分度量空间 .)\n第 7.3节 高斯空间\n给定一个概率空间 (Ω,F,P)上的一个高斯向量 (X1,X2,...,X d),形如\nX1,X2,...,X d的实线性组合的随机变量 X也是高斯随机变量 .这样的随\n机变量全体构成一个线性空间 ,是概率空间上平方可积随机变量构成的空间\nL2(Ω,F,P)的子空间 .取其闭包 ,可得闭子空间 .由于高斯随机变量 L2收\n敛的极限仍然是高斯的 (见命题 7.1.8 ),故此闭子空间内的随机变量都是高斯\n的,故称其为一种高斯空间 .这是高斯空间的简单例子 .下面我们给出高斯\n空间的一般定义 :\n定义 7.3.1.一个 (中心化的 )高斯空间是概率空间 (Ω,F,P)上的平方可积\n随机变量构成的线性空间 L2(Ω,F,P)的闭子空间 ,其中 ,该高斯空间中的\n随机变量必须都是中心化的高斯变量 .第 7.4节 高斯白噪声 99\n注 7.3.1.因为L2(Ω,F,P)是一个 Hilbert空间 ,所以 ,作为其闭子空间 ,\n(中心化的 )高斯空间都是 Hilbert空间 .其上两个随机变量 ξ和η的内积\n定义为\n(ξ,η) = Cov(ξ,η) =E(ξη).\n例 7.2.假设 (Xt)t∈T是中心化的高斯过程 .那么 ,由随机变量 Xt(t2T)生\n成的闭线性子空间是一个高斯空间 ,被称为由高斯过程 (Xt)t∈T生成的高斯\n空间 .\n回忆由一族随机变量生成的事件域的概念 :\n定义 7.3.2.假设H是一族随机变量 .对于一个事件域 G,我们称H关于\nG可测 ,当且仅当对于 H中的任何一个随机变量 ξ,ξ是关于 G可测的 .我\n们把所有的使得 H中随机变量均可测的事件域取交集 ,得到σ(H).那么 ,\nσ(H)仍然是个事件域 ,称为由H生成的事件域 .它是使得H中随机变量\n均可测的最小事件域 .\n下面 ,我们将看到 ,对于高斯空间 ,子空间的正交对应着对应事件域的独\n立性 .这其实源于高斯向量的特性 :在联合高斯的前提下 ,独立等同于协方\n差为 0.\n定理 7.3.2.假设H是一个高斯空间 .而(Hi)i∈I是一族H的子空间 .那\n么,(Hi)i∈I两两正交等同于事件域 (σ(Hi))i∈I相互独立 .\n例 7.3.在上述定理中 ,要求 (Hi)i∈I都被包含在一个统一的高斯空间 H中\n是必要的 .试举出一个反例 .\n第 7.4节 高斯白噪声\n形式上 ,高斯白噪声是一个独立性很强的中心化的 (零均值的 )高斯过\n程,其协方差函数\nΓ(s,t) =(\n0, s 6=t;\nδs(t), s=t.\n其中 ,δs是在s点的 Dirac函数 .形式上 ,广义函数δs支撑在s这一个点\n上,并且在全空间的积分为 1.也可以把δs理解成在s这个点上的概率测\n度.对于s6=t,Γ(s,t) = 0反映出Xs和Xt的独立性 .实际上 ,任取互不\n相同的", " ξ,ξ是关于 G可测的 .我\n们把所有的使得 H中随机变量均可测的事件域取交集 ,得到σ(H).那么 ,\nσ(H)仍然是个事件域 ,称为由H生成的事件域 .它是使得H中随机变量\n均可测的最小事件域 .\n下面 ,我们将看到 ,对于高斯空间 ,子空间的正交对应着对应事件域的独\n立性 .这其实源于高斯向量的特性 :在联合高斯的前提下 ,独立等同于协方\n差为 0.\n定理 7.3.2.假设H是一个高斯空间 .而(Hi)i∈I是一族H的子空间 .那\n么,(Hi)i∈I两两正交等同于事件域 (σ(Hi))i∈I相互独立 .\n例 7.3.在上述定理中 ,要求 (Hi)i∈I都被包含在一个统一的高斯空间 H中\n是必要的 .试举出一个反例 .\n第 7.4节 高斯白噪声\n形式上 ,高斯白噪声是一个独立性很强的中心化的 (零均值的 )高斯过\n程,其协方差函数\nΓ(s,t) =(\n0, s 6=t;\nδs(t), s=t.\n其中 ,δs是在s点的 Dirac函数 .形式上 ,广义函数δs支撑在s这一个点\n上,并且在全空间的积分为 1.也可以把δs理解成在s这个点上的概率测\n度.对于s6=t,Γ(s,t) = 0反映出Xs和Xt的独立性 .实际上 ,任取互不\n相同的t1,t2,...,t n,Xt1,Xt2,...,X tn相互独立 .这表明这个高斯过程的独100 第七章 高斯向量和高斯过程\n立性很强 .然而 ,由于δs(s) = + 1,所以 ,Xt的二阶矩实际上是爆炸的 .这\n表明高斯白噪声并不是常义下的高斯过程 ,而是某种广义的高斯过程 .实际\n上,如果我们把 t7!Xt看作T上的随机函数 ,那么 ,这个函数必须是广义\n函数 .通常 ,广义函数通过它在好的测试函数 f上的配对作用而定义 .而一\n般而言 ,函数之间的配对作用 (f,g)一般通过关于一个测度 µ的积分实现 :\n(f,g) =Z\nf(t)g(t)dµ(t).\n为了简单起见 ,我们假设T是欧几里得空间 ,而µ是其上的 Lebesgue 测度 .\n于是 ,我们考虑如下的随机量 :\nX(f)≜Z\nTXtf(t)dt.\n为了了解高斯白噪声 ,我们需要了解形如 X(f)的随机变量全体 .而这可以\n看成是下标为 f的随机过程 (X(f))f.由X(f)的定义式 ,X(f)可以粗略\n的看成是 (Xt)t∈T的某种线性组合或者线性组合的极限 .因此 ,根据高斯过\n程的定义 ,X(f)应该是一个高斯变量 .更一般的 ,(X(f))f应该是一个高斯\n过程 .此时 ,中心化的性质显然是满足的 .为了描述 (X(f))f的分布 ,我们需\n要了解其协方差函数 .实际上 ,我们有\nΓ(f,g) =E(X(f)X(g)) =E(Z\nTf(s)XsdsZ\nTg(t)Xtdt).\n形式化的使用 F ubini定理 ,我们得到\nΓ(f,g) =Z\nTZ\nTf(s)g(t)E(XsXt)dsdt.\n再利用条件 E(XsXt) = Γ(s,t) =δs(t),可得\nΓ(f,g) =Z\nTZ\nTf(s)g(t)δs(t)dsdt=Z\nTf(s)g(s)ds.\n此时 ,我们看到 ,对于平方可积的函数 f和g,Γ(f,g)就是有限的量 .除此以\n外,可以验证 ,Γ(f,g)是实对称非负定函数 .于是 ,(X(f))f∈L2(T)是良好定义\n的高斯过程 .于是 ,我们可以把随机过程 (X(f))f∈L2(T)当作是形式化的高\n斯白噪声 (Xt)t∈T在数学上的严格定义 .回顾上述过程 ,我们发现我们需要\nT上有一个测度 µ以至于可以计算积分 . (但是这个测度不一定是 Lebesgue\n测度 .)数学上的高斯白噪声实际上被理解成高斯过程 (X(f))f∈L2(T,µ).于\n是,我们可以自然的给出如下高斯白噪声的定义 :第 7.4节 高斯白噪声 101\n定义 7.4.1.假设 (T,T)是一个可测空间 .而µ是(T,T)上的一个σ-有限\n的测度 .以µ作为强度的高斯白噪声指的是从 L2(T,T,µ)到一个 (中心化\n的)高斯空间的等距线性映射 X.\n特别的 ,对于f2L2(T,T,µ),X(f)实际上是一个中心化的高斯变量 ,\n其方差\nVar(X(f)) =jjX(f)jj2\nL2(Ω,F,P)=jjfjj2\nL2(T,T,µ)=Z\nTf2dµ.\n而对于f,g2L2(T,T,µ),X(f)和X(g)的协方差为\nE(X(f)X(g)) = (X(f),X(g))L2(Ω,F,P)= (f,g)L2(T,T,µ)=Z\nTfg dµ.\n另外 ,我们还有\nX(f+λg) =X(f) +λX(g).\n对于X(f)中的f,其最简单形式为示性函数 1A,其中 ,A2 T .我们记\nX(A)≜X(1A),A2 T.\n那么 ,A7!X(A)可以看成是一个随机的集合函数 .利用X是个线性\n同构的事实 ,上述集合函数 X(A)实际上是有限可加的 .进一步的 ,假设\nµ(A)<+1,而A可以表示成可测集 A1,A2,...的不交并 .那么 ,Pn\nj=11Aj\n在L2意义下收敛到 1A.因此 ,利用X是个同构的事实 ,我们有\nX(A) =+∞X\nj=1X(Aj),\n其中 ,式子右端的随机变量级数在 L2意义下收敛 .另外 ,利用等距和高斯空\n间的性质 ,如果A1,A2,...,A n是不交的n个可测子集 ,那么 ,高斯随机变\n量X(A1),X(A2),...,X (An)是相互独立的 .这一点和泊松点过程很像 .但\n是,一般而言 ,对于典型的样本点 �", "距线性映射 X.\n特别的 ,对于f2L2(T,T,µ),X(f)实际上是一个中心化的高斯变量 ,\n其方差\nVar(X(f)) =jjX(f)jj2\nL2(Ω,F,P)=jjfjj2\nL2(T,T,µ)=Z\nTf2dµ.\n而对于f,g2L2(T,T,µ),X(f)和X(g)的协方差为\nE(X(f)X(g)) = (X(f),X(g))L2(Ω,F,P)= (f,g)L2(T,T,µ)=Z\nTfg dµ.\n另外 ,我们还有\nX(f+λg) =X(f) +λX(g).\n对于X(f)中的f,其最简单形式为示性函数 1A,其中 ,A2 T .我们记\nX(A)≜X(1A),A2 T.\n那么 ,A7!X(A)可以看成是一个随机的集合函数 .利用X是个线性\n同构的事实 ,上述集合函数 X(A)实际上是有限可加的 .进一步的 ,假设\nµ(A)<+1,而A可以表示成可测集 A1,A2,...的不交并 .那么 ,Pn\nj=11Aj\n在L2意义下收敛到 1A.因此 ,利用X是个同构的事实 ,我们有\nX(A) =+∞X\nj=1X(Aj),\n其中 ,式子右端的随机变量级数在 L2意义下收敛 .另外 ,利用等距和高斯空\n间的性质 ,如果A1,A2,...,A n是不交的n个可测子集 ,那么 ,高斯随机变\n量X(A1),X(A2),...,X (An)是相互独立的 .这一点和泊松点过程很像 .但\n是,一般而言 ,对于典型的样本点 ω2Ω,A7!X(A)并不是测度 .在后面布\n朗运动的学习中 ,我们将看到这一点 .\n到目前为止 ,我们定义了高斯白噪声并初步讨论了其性质 .但是 ,我们\n还没有证明其存在性 .下面的定理说明 ,我们总可以在合适的概率空间上构\n造出满足条件的高斯白噪声 .\n定理 7.4.1.假设 (T,T)是可测空间 ,而µ是其上的σ-可加测度 .那么 ,存\n在一个概率空间 (Ω,F,P)及其上的以 µ为强度测度的高斯白噪声 .102 第七章 高斯向量和高斯过程\n证明 .因为函数 Γ(f,g) =R\nTf(t)g(t)µ(dt)是实对称正定函数 ,利用高斯过\n程的存在性 ,存在以平方可积函数 f为指标的零均值高斯过程 (X(f))f∈L2(T,T,µ)\n满足 Cov(X(f),X(g)) =R\nTf(t)g(t)µ(dt).最后 ,我们只需要验证对于\nf,g2L2(T,T,µ)和λ2R,几乎必然的 ,有\nX(f+λg) =X(f) +λX(g).\n由高斯过程的定义 ,X(f+λg)\u0000(X(f) +λX(g))是高斯的 .同时 ,不难验\n证其方差为 0,故该随机变量几乎必然为 0.第八章 布朗运动\n第 8.1节 引言\n布朗运动是一个连续时间连续状态空间的随机过程 (Xt)t≥0.时间t取\n值在指标集 [0,+1)之上 . (一维 )布朗运动的状态空间是实数集 R.为了\n简单起见 ,我们假设X0= 0 .我们假设运动是 “完全随机的 ” .我们完全无\n法预测下一时刻的位移 .所以 ,我们假设接下来的位移 Xt\u0000Xs与之前的过\n程(Xu)u∈[0,s]独立 .一般情况下 ,我们假设对于任意的 s1\u0014t1\u0014s2\u0014t2\u0014\n\u0001 \u0001 \u0001 \u0014sn\u0014tn,有Xt1\u0000Xs1,Xt2\u0000Xs2,...,X tn\u0000Xsn相互独立 .我们称布\n朗运动的增量是 独立的 .我们假设运动的规律不随时间改变 ,即Xt\u0000Xs只\n和t\u0000s有关 .我们称布朗运动的增量是 平稳的 .我们再假设运动过程存在\n对称性 ,即Xt和\u0000Xt同分布 .特别的 ,E(Xt) = 0 .上述假设并不足以确定\n对应的过程 .例如 ,Yt=Nt\u0000λt也满足上述条件 ,其中 ,Nt是参数为λ泊\n松过程 .我们的最后一条假设是 t7!Xt是连续的轨道 .\n我们假设f(t) =E(X2\nt) = Var(Xt).那么 ,将Xt写成 (Xs\u0000X0) +\n(Xt\u0000Xs),利用增量的独立性和平稳性 ,可以知道f(t) =f(t\u0000s) +f(s).如\n果f连续并且 0<f(t)<+1,那么 ,存在σ2>0,使得f(t) =σ2t.\n接下来 ,基于上述假设 ,我们讨论Xt的分布 .为简便起见 ,我们先讨论\nt= 1的情形 .我们将证明如下结论 :\n命题 8.1.1.X1\u0018N(0,σ2).\n证明 .注意到\nX1= (X1/n\u0000X0) + (X2/n\u0000X1/n) +\u0001 \u0001 \u0001+ (X1\u0000X(n−1)/n).\n定义Zn,m=Xm/n\u0000X(m−1)/n,m= 1,2,...,n .我们将利用三角列的中心\n极限定理 ,证明X1\u0018N(0,σ2).为此 ,我们需要先进行一些准备工作 :我们\n103104 第八章 布朗运动\n有\nnX\nm=1E(Z2\nn,m) =σ2.\n另外 ,根据控制收敛定理和轨道 t7!Xt的连续性 ,8ε>0,\nE(X2\n1I(maxfjZn,mj:m= 1,2,...,n g \u0015ε))n→∞!0.\n定义停时T= inffm= 1,2,...,n :jZn,mj \u0015εg. (约定 inf;= +1.)那么 ,\nE(X2\n1I(maxfjZn,mj:m= 1,2,...,n g \u0015ε)) =E(X2\n1I(T\u0014n)),\n并且 ,E(X2\n1I(T\u0014n))n→∞!0.注意到X1=Pn\nm=1Zn,m .所以 ,我们有\nE(X2\n1I(T\u0014n)) =nX\nk=1nX\ni=1nX\nj=1E(Zn,iZn,jI(T=k))\n=nX\nk=1nX\ni=1E(Z2\nn,iI(T=k))\n+ 2nX\nk=1X\n1≤i<j≤nE(Zn,iZn,jI(T=k))\n=E(nX\ni=1Z2\nn,iI(T\u0014n))\n+ 2nX\nk=1X\n1≤i<j≤nE(Zn,iZn,jI(T=k))\n=A+ 2B", "1的情形 .我们将证明如下结论 :\n命题 8.1.1.X1\u0018N(0,σ2).\n证明 .注意到\nX1= (X1/n\u0000X0) + (X2/n\u0000X1/n) +\u0001 \u0001 \u0001+ (X1\u0000X(n−1)/n).\n定义Zn,m=Xm/n\u0000X(m−1)/n,m= 1,2,...,n .我们将利用三角列的中心\n极限定理 ,证明X1\u0018N(0,σ2).为此 ,我们需要先进行一些准备工作 :我们\n103104 第八章 布朗运动\n有\nnX\nm=1E(Z2\nn,m) =σ2.\n另外 ,根据控制收敛定理和轨道 t7!Xt的连续性 ,8ε>0,\nE(X2\n1I(maxfjZn,mj:m= 1,2,...,n g \u0015ε))n→∞!0.\n定义停时T= inffm= 1,2,...,n :jZn,mj \u0015εg. (约定 inf;= +1.)那么 ,\nE(X2\n1I(maxfjZn,mj:m= 1,2,...,n g \u0015ε)) =E(X2\n1I(T\u0014n)),\n并且 ,E(X2\n1I(T\u0014n))n→∞!0.注意到X1=Pn\nm=1Zn,m .所以 ,我们有\nE(X2\n1I(T\u0014n)) =nX\nk=1nX\ni=1nX\nj=1E(Zn,iZn,jI(T=k))\n=nX\nk=1nX\ni=1E(Z2\nn,iI(T=k))\n+ 2nX\nk=1X\n1≤i<j≤nE(Zn,iZn,jI(T=k))\n=E(nX\ni=1Z2\nn,iI(T\u0014n))\n+ 2nX\nk=1X\n1≤i<j≤nE(Zn,iZn,jI(T=k))\n=A+ 2B,\n其中 ,\nA≜E(nX\ni=1Z2\nn,iI(T\u0014n)),B≜nX\nk=1X\n1≤i<j≤nE(Zn,iZn,jI(T=k)).\n我们只需要证明 limn→∞B= 0 .若 limn→∞B= 0 ,因为 limn→∞A+ 2B=\n0,所以 , lim n→∞A= 0 .而这又能推出\nnX\nm=1E(Z2\nn,mI(jZn,mj \u0015ε))n→∞!0.\n利用三角列的中心极限定理 [Dur19 , Theorem 3.4.10], 我们知道X1依分布\n收敛于N(0,σ2).但是 ,X1与n无关 ,只能是X1\u0018N(0,σ2).最后 ,我们证第 8.1节 引言 105\n明 limn→∞B= 0 .对于m= 1,2,...,n ,记Fm=σ(Zn,i,i\u0014m).把F0定\n义成最小的事件域 f;,Ωg.如果j > k ,我们有Zn,iI(T=k)关于Fj−1可\n测,而Zn,j与Fj−1独立 ,并且EZn,j= 0 .利用重期望公式 ,我们有\nE(Zn,iZn,jI(T=k)) =E(E(Zn,iZn,jI(T=k)jFj−1)) =E0 = 0.\n所以 ,我们有\nB=nX\nk=1X\n1≤i<j≤kE(Zn,iZn,jI(T=k)).\n注意到T=k等价于 8i<k ,jZn,ij<ε并且jZn,kj \u0015ε.利用 (Zn,i)i=1,2,...,n\n的独立同分布性 ,我们得到\nE(Zn,iZn,jI(T=k)) =(\ne2\n1(1\u0000q)k−3q, i<j <k,\ne1f1(1\u0000q)k−2q, i<j =k,\n其中 ,\nq=P(jZn,kj \u0015ε),\ne1=E(Zn,iI(jZn,ij<ε)),\nf1=E(Zn,jI(jZn,jj \u0015ε)).\n利用E(Zn,i) = 0 ,实际上 ,e1=\u0000f1.利用 Cauchy-Schwartz 不等式 ,我们\n有\ne2\n1=f2\n1= (E(Zn,jI(jZn,jj \u0015ε)))2\u0014E(Z2\nn,j)P(jZn,jj \u0015ε) =q/n.\n这里我们用到 E(Z2\nn,j) = 1/n这个事实 .再利用 Chebyshev 不等式 ,我们有\nq=P(jZn,k\u0000EZn,kj \u0015ε)\u0014 Var(Zn,k)/ε2= 1/(nε2).\n所以 ,e2\n1\u00141/(n2ε2).于是 ,我们有\njE(Zn,iZn,jI(T=k))j \u0014C(ε)q(1\u0000q)k−1/n2=C(ε)P(T=k)/n2.\n因此 ,我们有\njBj \u0014nX\nk=1C(ε)P(T=k) =C(ε)P(T\u0014n)n→∞!0.\n(利用布朗运动轨道的连续性 ,我们有 limn→∞P(T\u0014n) = 0 .)106 第八章 布朗运动\n类似的 ,可以证明如下结论 :\n命题 8.1.2. 8t\u00150,Xt\u0018N(0,σ2t).\n接下来 ,我们给出布朗运动的数学定义 :\n定义 8.1.1.方差参数为 σ2的布朗运动是取值为实数并满足如下条件的随\n机过程 (Xt)t≥0:\n1.X0= 0 ;\n2.对于任意的 s1\u0014t1\u0014s2\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014sn\u0014tn,有Xt1\u0000Xs1,Xt2\u0000\nXs2,...,X tn\u0000Xsn相互独立 ;\n3.对任意的s<t ,Xt\u0000Xs服从均值为 0,方差为σ2(t\u0000s)的正态分布 ;\n4.轨道是连续的 ,即t7!Xt是连续函数 .\n注 8.1.3.布朗运动又被称为 Wiener过程 .\nσ2= 1的布朗运动被称为 标准布朗运动 .我们一般用 (Bt)t≥0表示\n标准的布朗运动 .对于一般的布朗运动 (Xt)t≥0,(Xt/σ)t≥0服从标准布\n朗运动 .布朗运动的有限维分布是高斯的 .即80\u0014t1< t 2<\u0001< tn,\n(Xt1,Xt2,...,X tn)是高斯向量 .由此不难看出 ,布朗运动是一种特殊的高斯\n过程 .经过计算 ,可以发现其协方差函数 Γ(s,t) =EXsXt=σ2min(s,t).另\n外,如果 (Bt)t≥0是标准的布朗运动 ,不难验证 8c>0,随机过程 (\u0000Bt)t≥0,\n(Bt+c\u0000Bc)t≥0,(Bc2t/c)t≥0也满足定义 8.1.1 ,也是标准的布朗运动 .\n第 8.2节 布朗运动的构造\n到目前为止 ,我们还没有介绍布朗运动的构造 ,即还没有证明满足定\n义8.1.1的随机过程是存在的 .依据布朗运动的定义 ,通过具体的计算 ,我们\n知道布朗运动是协方差函数为\nΓ(s,t) =σ(s", "1\u0000Xs1,Xt2\u0000\nXs2,...,X tn\u0000Xsn相互独立 ;\n3.对任意的s<t ,Xt\u0000Xs服从均值为 0,方差为σ2(t\u0000s)的正态分布 ;\n4.轨道是连续的 ,即t7!Xt是连续函数 .\n注 8.1.3.布朗运动又被称为 Wiener过程 .\nσ2= 1的布朗运动被称为 标准布朗运动 .我们一般用 (Bt)t≥0表示\n标准的布朗运动 .对于一般的布朗运动 (Xt)t≥0,(Xt/σ)t≥0服从标准布\n朗运动 .布朗运动的有限维分布是高斯的 .即80\u0014t1< t 2<\u0001< tn,\n(Xt1,Xt2,...,X tn)是高斯向量 .由此不难看出 ,布朗运动是一种特殊的高斯\n过程 .经过计算 ,可以发现其协方差函数 Γ(s,t) =EXsXt=σ2min(s,t).另\n外,如果 (Bt)t≥0是标准的布朗运动 ,不难验证 8c>0,随机过程 (\u0000Bt)t≥0,\n(Bt+c\u0000Bc)t≥0,(Bc2t/c)t≥0也满足定义 8.1.1 ,也是标准的布朗运动 .\n第 8.2节 布朗运动的构造\n到目前为止 ,我们还没有介绍布朗运动的构造 ,即还没有证明满足定\n义8.1.1的随机过程是存在的 .依据布朗运动的定义 ,通过具体的计算 ,我们\n知道布朗运动是协方差函数为\nΓ(s,t) =σ(s^t)\n的高斯过程 .根据第 7.2节的结果 ,这样的高斯过程总是存在的 .但是 ,一般\n来说 ,我们构造出的高斯过程 (Xt)t≥0不一定关于时间 t是连续的 ,即轨道\nt7!Xt不一定总是连续的 .我们可以将其称为预布朗运动 .我们的问题是第 8.2节 布朗运动的构造 107\n在保证定义 8.1.1的前三条的前提下 ,能否将预布朗运动轨道 t7!Xt修正\n为连续的 ?注意到定义 8.1.1的前三条其实等价于描述有限维分布 .保持定\n义8.1.1的前三条不变等同于保持有限维分布不变 .我们首先严格的给出有\n限维分布相同的数学含义 :\n定义 8.2.1.考虑定义在两个概率空间上的两个随机过程 (Xt)t∈T和(Yt)t∈T.\n我们称它们的 有限维分布相同 ,即对于任何的有限指标 t1,t2,...,t n,\n(Xt1,Xt2,...,X tn)与(Yt1,Yt2,...,Y tn)同分布.\n对于两个随机向量 X= (X1,X2,...,X n)和Y= (Y1,Y2,...,Y n),如果\n它们相同的概率等于 1,即P(X=Y) = 1 ,那么 ,两者必然同分布 .对于随\n机过程 ,将其看成 “向量值随机变量 ”,如果它们相等的概率等于 1,那么 ,两\n者必然有相同的有限维分布 .\n定义 8.2.2.对于定义在同一个概率空间上的两个随机过程 (Xt)t∈T和\n(Yt)t∈T,如果\nP(fω2Ω :Xt(ω) =Yt(ω),8t2Tg) = 1,\n那么 ,我们称 (Xt)t∈T和(Yt)t∈T是不可区分的 .\n对于不可区分的两个随机过程 ,我们可以视为完全相同 .关于两者的任\n何概率问题都将会有相同的答案 .例如 ,如果P(t7!Xt是连续的 ) = 1 ,那\n么,P(t7!Yt是连续的 ).因此 ,一个连续的随机过程和一个不一定连续的随\n机过程一定是可以区分的 .为了完成我们的目标 ,我们需要把一个不一定连\n续的过程 (Xt)t≥0修正为连续的随机过程 (Yt)t≥0.那么 ,此修正一定不是一\n种不可区分的修改 .因此 ,我们需要定义一种新的随机过程的等价关系 :\n定义 8.2.3.对于定义在同一个概率空间上的两个随机过程 (Xt)t∈T和\n(Yt)t∈T,如果对于任意的 t2T,都有\nP(Xt=Yt) = 1,\n那么 ,我们称 (Xt)t∈T与(Yt)t∈T互为对方的 修正 (modification) .\n注 8.2.1.利用概率的次可加性 ,可以发现互为修正的两个随机过程一定有\n相同的有限维分布 .108 第八章 布朗运动\n注 8.2.2.两个随机过程不可区分 ,一定互为修正 .利用概率的次可加性 ,如\n果指标集T可数 ,那么 ,互为修正的两个随机过程一定是不可区分的 .但是 ,\n当指标集T不可数时 ,一般而言 ,互为修正不能保证不可区分 .所以 ,互为\n修正是一个比不可区分更弱的条件 .而这正是我们把不一定连续的预布朗\n运动修正为连续的布朗运动而需要的概念 .\n接下来 ,我们举一个具体的例子 ,说明 “互为修正 ”不能保证 “不可区\n分” .\n例 8.1.假设τ服从参数为 1的指数分布 .定义\nXt= 0,8t\u00150, Y t=(\n0, t6=τ;\n1, t=τ.\n那么 ,(Xt)t≥0的轨道连续 ,而(Yt)t≥0的轨道不连续 ,所以 ,两者是可以区分\n的.但是 ,8t\u00150,P(Xt=Yt) =P(τ6=t) = 1 .所以 ,两个随机过程互为修\n正.\n另一方面 ,在一定的轨道正则性的条件下 ,互为修正又可以推出不可区\n分.\n例 8.2.假设I是一个实数区间 .假设 (Xt)t∈I和(Yt)t∈I互为修正 ,并且它\n们的轨道都是连续的 .那么 ,(Xt)t∈I和(Yt)t∈I是不可区分的 .实际上 ,利用\n次可加性 ,存在一个零概率事件 N,8ω/2N,我们有\nXt(ω) =Yt(ω),8t2I\\Q.\n而根据连续性 ,8t2I,Xt是s在I\\Q中趋于t时,Xs的极限 .因此 ,利\n用连续性 ,8ω/2N,\nXt(ω) =Yt(ω),", "两个随机过程一定是不可区分的 .但是 ,\n当指标集T不可数时 ,一般而言 ,互为修正不能保证不可区分 .所以 ,互为\n修正是一个比不可区分更弱的条件 .而这正是我们把不一定连续的预布朗\n运动修正为连续的布朗运动而需要的概念 .\n接下来 ,我们举一个具体的例子 ,说明 “互为修正 ”不能保证 “不可区\n分” .\n例 8.1.假设τ服从参数为 1的指数分布 .定义\nXt= 0,8t\u00150, Y t=(\n0, t6=τ;\n1, t=τ.\n那么 ,(Xt)t≥0的轨道连续 ,而(Yt)t≥0的轨道不连续 ,所以 ,两者是可以区分\n的.但是 ,8t\u00150,P(Xt=Yt) =P(τ6=t) = 1 .所以 ,两个随机过程互为修\n正.\n另一方面 ,在一定的轨道正则性的条件下 ,互为修正又可以推出不可区\n分.\n例 8.2.假设I是一个实数区间 .假设 (Xt)t∈I和(Yt)t∈I互为修正 ,并且它\n们的轨道都是连续的 .那么 ,(Xt)t∈I和(Yt)t∈I是不可区分的 .实际上 ,利用\n次可加性 ,存在一个零概率事件 N,8ω/2N,我们有\nXt(ω) =Yt(ω),8t2I\\Q.\n而根据连续性 ,8t2I,Xt是s在I\\Q中趋于t时,Xs的极限 .因此 ,利\n用连续性 ,8ω/2N,\nXt(ω) =Yt(ω),8t2I.\n所以 ,(Xt)t∈I和(Yt)t∈I是不可区分的 .更一般的 ,我们可以把两个随机过\n程的连续性条件换成右连续或者左连续 .\n接下来 ,我们回到预布朗运动连续化的主线上来 .我们将介绍一个随机\n过程进行连续修正的一般方法 :这被称为 Kolmogorov-Chentsov 准则 .\n定理 8.2.3.假设指标集 T= [0,1]d\u001aRd.而(Xt)t∈T是取值在某个完备度\n量空间 (S,ρ)中的随机过程 .如果能够找到 a,b> 0和C=C(a,b)<+1,\nE[(ρ(Xs,Xt))a]\u0014Cjs\u0000tjd+b,8s,t2T,第 8.2节 布朗运动的构造 109\n那么 ,随机过程 (Xt)t∈T有一个连续的修正 (Yt)t∈T.而后者的轨道 t7!Yt\n几乎必然是 Hölder连续的 ,其中 , Hölder 连续性指数 c可以是 (0,b/a)上\n的任意正实数 .\n定理的证明可见 [Kal21 ,定理 4.23].如果随机过程的指标集 T=Rd\n无界 ,通过把定理 8.2.3应用到超立方体 [0,1]d的各种平移 ,再把每个超立方\n体内得到的连续修正拼接起来 ,可以得到整个过程 (Xt)t∈T的连续修正 ,其\nHölder连续性指标可以是 (0,b/a)上的任意正实数 .\n接下来 ,我们把定理 8.2.3应用到预布朗运动上 .此时 ,我们有d= 1 ,即\n指标集是 1维的 .而随机过程 (Xt)t≥0的取值空间为实数集 R.其上有标准\n度量ρ(x,y) =jx\u0000yj.我们取a= 2n,其中 ,n是充分大的正整数 .对于\ns<t ,Xt\u0000Xs\u0018N(0,σ2(t\u0000s)).等价的 ,Z=Xt−Xs\nσ√t−s\u0018N(0,1).所以 ,我\n们有\nEjXs\u0000Xtj2n=σ2n(t\u0000s)nE(Z2n) = (2n\u00001)!!σ2n(t\u0000s)n.\n所以 ,定理 8.2.3中对应的b=n\u00001>0.于是 ,预布朗运动有连续修正\n(Y(n)\nt)t≥0.而(Y(n)\nt)t≥0的 Hölder连续性指数 c可以是 (0,n−1\n2n)上的任意正\n实数 .对于不同的 n,随机过程 (Y(n)\nt)t≥0都是 (Xt)t≥0的修正 .而互为修正\n有传递性 ,所以 ,对于不同的 n,随机过程 (Y(n)\nt)t≥0实际上互为修正 .然而 ,\n这些随机过程都是连续的 .根据例 8.2 ,这些随机过程实际上是不可区分的 ,\n视为等同 .于是 ,我们得到一个统一的连续修正过程 (Yt)t≥0,而其 Hölder连\n续性指数c可以是 (0,1/2)上的任意正实数 .\n接下来 ,我们介绍一个与标准布朗运动相关的名词 :维纳测度 (Wiener\nmeasure). 如果我们把标准布朗运动视为随机的连续函数 ,那么 ,可以认为\n(标准 )布朗运动是取值在连续函数空间 C(R≥0,R)上的 (广义值 )随机变量 .\n那么 , Wiener 测度就是此随机变量的分布 ,是定义在像空间 C(R≥0,R)上的\n概率测度 .为了把细节描述清楚 ,我们需要说明如下几个问题 :\n(1)在C(R≥0,R)取什么样的 σ-域B?\n(2)X: Ω!C(R≥0,R),ω7!(t7!Xt(ω))为什么是可测映射 ?\n(3)如何描述维纳测度 W ?\n为了解决问题 (1),我们在线性空间 C(R≥0,R)上引入度量 d(f,g):\nd(f,g)≜+∞X\nn=12−nmin(1,max\nt∈[0,n]jf(t)\u0000g(t)j),8f,g2C(R≥0,R). (8.1)110 第八章 布朗运动\n在上述范数下 ,C(R≥0,R)变成 Polish空间 (完备可分度量空间 ).在上述\n度量下 ,函数列的收敛性等同于在所有紧集上的一致收敛 .接下来 ,度量\n诱导拓扑 .最后 ,我们把C(R≥0,R)上的σ-域取成 Borel-σ-域.可以证\n明B与有限维柱集生成的事件域 C相同 .更确切的 ,C是使得投影映射\nπt:C(R≥0,R)!R,f7!πt(f) =f(t)对于任何时刻 t\u00150都可测的最小事\n件域 .粗略的说 ,原因很好理解 .如果我们知道了函数 f,那么 ,函数在任何\n时刻t的取值都是清楚的", "准 )布朗运动是取值在连续函数空间 C(R≥0,R)上的 (广义值 )随机变量 .\n那么 , Wiener 测度就是此随机变量的分布 ,是定义在像空间 C(R≥0,R)上的\n概率测度 .为了把细节描述清楚 ,我们需要说明如下几个问题 :\n(1)在C(R≥0,R)取什么样的 σ-域B?\n(2)X: Ω!C(R≥0,R),ω7!(t7!Xt(ω))为什么是可测映射 ?\n(3)如何描述维纳测度 W ?\n为了解决问题 (1),我们在线性空间 C(R≥0,R)上引入度量 d(f,g):\nd(f,g)≜+∞X\nn=12−nmin(1,max\nt∈[0,n]jf(t)\u0000g(t)j),8f,g2C(R≥0,R). (8.1)110 第八章 布朗运动\n在上述范数下 ,C(R≥0,R)变成 Polish空间 (完备可分度量空间 ).在上述\n度量下 ,函数列的收敛性等同于在所有紧集上的一致收敛 .接下来 ,度量\n诱导拓扑 .最后 ,我们把C(R≥0,R)上的σ-域取成 Borel-σ-域.可以证\n明B与有限维柱集生成的事件域 C相同 .更确切的 ,C是使得投影映射\nπt:C(R≥0,R)!R,f7!πt(f) =f(t)对于任何时刻 t\u00150都可测的最小事\n件域 .粗略的说 ,原因很好理解 .如果我们知道了函数 f,那么 ,函数在任何\n时刻t的取值都是清楚的 .所以 ,C \u001a B .反过来 ,利用事件域对可列交的封\n闭性 ,把f在每个有理数点的取值的信息汇总起来 ,我们可以知道 f在有理\n数集上所有点的取值 . (这里 ,我们用到了有理数集的可列性 .)而根据f的\n连续性 ,我们可以从 f在有理数集上的取值推知 f在任何t\u00150的取值 .这\n说明B \u001a C .综上 ,我们有 B=C.\n接下来 ,我们解释问题 (2):因为我们在 C(R≥0,R)赋予了事件域 C,而\n对于任何t\u00150,利用随机过程的定义 ,随机变量Xt: Ω!R,ω7!Xt(ω)是\n可测的 ,所以 , (广义值 )随机向量X: Ω!C(R≥0,R),ω7!(t7!Xt(ω))是\n可测的 .\n最后 ,我们回答问题 (3).根据 Dynkin的π\u0000λ定理 ,维纳测度完全由\n其在有限维柱集上的取值所决定 .因此 ,所谓的维纳测度可以通过随机过程\n的有限维分布描述 :对于 0 =t0\u0014t1< t 2<\u0001 \u0001 \u0001< tn和R上的n+ 1个\nBorel集A0,A1,...,A n,\nW(ff2C(R≥0,R) :f(ti)2Ai,8i= 0,1,...,n g)\n=P(Xti2Ai,8i= 0,1,...,n )\n= 1A0(0)Z\nA1×A2×···× AnnY\ni=1pti−ti−1(xi−1,xi)nY\ni=1dxi,\n其中 ,x0≜0,pt(x,y) =1√\n2πte−(y−x)2\n2t ,t>0.\n利用维纳测度 ,我们可以给出标准布朗运动的标准 (canonical) 构造 :取\nΩ =C(R≥0,R),事件域 F=B(C(R≥0,R)),P(dω) =W(dω).随机过程\nXt(ω) =ω(t). (注意ω2Ω实际上是个函数 .)\n注 8.2.4.布朗运动还可以通过随机游动的极限来构造 .假设 (Yn)n≥1是独\n立同分布的随机变量 ,其中 ,\nP(Yi= 1) =P(Yi=\u00001) = 1/2.\n令S0= 0 ,Sn=Y1+Y2+\u0001 \u0001 \u0001+Yn.那么 ,(Sn)n≥0是Z上的简单随机游走 .第 8.3节 马尔可夫性 111\n这是一个离散时间的过程 ,我们可以通过线性插值的方法得到连续时间的过\n程(St)t≥0,其中 ,对于n\u0014t\u0014n+ 1 ,我们定义\nSt= (n+ 1\u0000t)Sn+ (t\u0000n)Sn+1.\n然后 ,我们做尺度变换 ,得到\nW(N)\nt=1p\nNSNt.\n那么 ,可以证明当 N! 1时,(W(N)\nt)t≥0依分布收敛于标准布朗运动 .\n第 8.3节 马尔可夫性\n数学上 ,域流 (filtration) (Ft)t≥0指的是随着 t增加而单调不缩小的一族\n事件域 ,并且它们包含于概率空间的事件域 F.一般而言 ,我们要求 8t\u00150,\nXt关于Ft可测 ,这样的随机过程被称为是适应的 (adapted).\n设(Bt)t≥0是一个标准的布朗运动 .我们用x+Bt表示从x出发的布\n朗运动 .令Ft=σ(Bs,s\u0014t).布朗运动的 马尔可夫性 指如下等式 :\nE(f(Bt+s,s\u00150)jFt) =G(Bt),\n其中 ,G(x) =E(f(x+Bs,s\u00150)) .用语言来描述 ,已知t时刻及其之前的\n过程 ,t时刻之后的过程的条件分布是从 Bt出发的布朗运动 .\n令ft(x)表示标准布朗运动的 Bt的密度函数 .用pt(x,y) =pt(0,y\u0000\nx) =ft(y\u0000x)表示转移密度 .它表示从x出发的布朗运动在 t时刻的密度\n函数在y的取值 .那么 ,我们有\npt(x,y) =1p\n2πte−(y−x)2\n2t,x,y2R.\n可以验证pt(x,y)满足 Komolgorov-Chapman 方程 :\nps+t(x,y) =Z+∞\n−∞ps(x,z)pt(z,y)dz.\n为了进行更多的关于布朗运动的计算 ,我们需要使用布朗运动的强马氏\n性.为此 ,我们引入停时的概念 :假设T是一个非负的 (可能取 +1的)随\n机变量 ,并且 ,对于t\u00150,fT\u0014tg 2 F t.那么 ,我们称T是个停时 .112 第八章 布朗运动\n定理 8.3.1 (强马氏性 ).假设T是个停时 .而F是个有界可测函数 .那么 ,\n我们有\n1T<+∞E(F(BT+s,s\u00150)jFT) = 1 T<+∞G(BT),\n其中 ,G(x) =E(F(x+Bs,s\u00150)) .\n注 8", ")t≥0是一个标准的布朗运动 .我们用x+Bt表示从x出发的布\n朗运动 .令Ft=σ(Bs,s\u0014t).布朗运动的 马尔可夫性 指如下等式 :\nE(f(Bt+s,s\u00150)jFt) =G(Bt),\n其中 ,G(x) =E(f(x+Bs,s\u00150)) .用语言来描述 ,已知t时刻及其之前的\n过程 ,t时刻之后的过程的条件分布是从 Bt出发的布朗运动 .\n令ft(x)表示标准布朗运动的 Bt的密度函数 .用pt(x,y) =pt(0,y\u0000\nx) =ft(y\u0000x)表示转移密度 .它表示从x出发的布朗运动在 t时刻的密度\n函数在y的取值 .那么 ,我们有\npt(x,y) =1p\n2πte−(y−x)2\n2t,x,y2R.\n可以验证pt(x,y)满足 Komolgorov-Chapman 方程 :\nps+t(x,y) =Z+∞\n−∞ps(x,z)pt(z,y)dz.\n为了进行更多的关于布朗运动的计算 ,我们需要使用布朗运动的强马氏\n性.为此 ,我们引入停时的概念 :假设T是一个非负的 (可能取 +1的)随\n机变量 ,并且 ,对于t\u00150,fT\u0014tg 2 F t.那么 ,我们称T是个停时 .112 第八章 布朗运动\n定理 8.3.1 (强马氏性 ).假设T是个停时 .而F是个有界可测函数 .那么 ,\n我们有\n1T<+∞E(F(BT+s,s\u00150)jFT) = 1 T<+∞G(BT),\n其中 ,G(x) =E(F(x+Bs,s\u00150)) .\n注 8.3.2.假设P(T < +1)>0.强马氏性指出在条件概率 P(\u0001jT < +1)\n下,BT+s\u0000BT是个和 FT独立的标准布朗运动 .\n强马氏性的证明 .回忆C(R≥0,R)上的度量的定义 (8.1 ).在接下来的证明\n中,我们不妨假设定义在 C(R≥0,R)上的函数F是连续的 .我们的证明将分\n两步进行 .\n第一步 :假设T是离散型随机变量 .其可能的有限取值为 (tn)n≥1.任\n取A2 FT,我们需要证明\nE(1T<+∞1AF(BT+s,s\u00150)) =E(1T<+∞1AG(BT)).\n为此 ,我们注意到 (T=tn)\\A2 Ftn.所以 ,结合上马氏性 ,我们有\nE(1T<+∞1AF(BT+s,s\u00150))\n=X\nn≥1E(1T=tn1AF(Btn+s,s\u00150))\n=X\nn≥1E(1T=tn1AE(F(Btn+s,s\u00150)jFtn))\n=X\nn≥1E(1T=tn1AG(Btn))\n=E(1T<+∞1AG(BT)).\n再结合上 1T<+∞G(BT)关于FT的可测性 ,强马氏性得证 .\n第二步 :考虑一般的停时 T.定义Tn=ndT/ne.那么 ,8n\u00151,Tn也\n是停时 .并且当n! 1时,Tn单调下降到 T.因此 ,(BTn+s,s\u00150)收敛到\n(BT+s,s\u00150).特别的 , lim n→∞BTn=BT.任取A2 F T.利用第一步的结\n果和控制收敛定理 ,我们有\nE(1T<+∞1AF(BT+s,s\u00150))\n= lim\nn→∞E(1Tn<+∞1AF(BTn+s,s\u00150))\n= lim\nn→∞E(1Tn<+∞1AG(BTn))第 8.3节 马尔可夫性 113\n=E(1T<+∞1AG(BT)).\n再结合上 1T<+∞G(BT)关于FT的可测性 ,强马氏性得证 .\n利用强马氏性可以证明如下反射原理 :\n定理 8.3.3 (反射原理 ).设(Bt)t≥0是一个起始于 a的标准布朗运动 .假设\nb>a .令T= infft\u00150 :Bt=bg.则,T是个停时 .定义一个新的随机过\n程(Yt)t≥0:\nYt(ω) =(\nBt(ω),t\u0014T;\n2b\u0000Bt(ω), t\u0015T.\n那么 ,(Yt)t≥0也是一个从 a出发的布朗运动 .\n证明 .对于 (Yt)t≥0,我们可以仿照 T的定义方式定义一个新的停时 TY=\ninfft\u00150 :Yt=bg.但是 ,利用轨道的连续性 ,不难发现TY和T完全相同 .\n注意到 (Yt)t≥0的轨道连续 .而(Yt)0≤t≤T与(Bt)0≤t≤T完全相同 .根据强\n马氏性 ,以(Bt)0≤t≤T作为条件 ,(BT+s\u0000BT)s≥0的条件分布是标准布朗运\n动.注意到 (YT+s\u0000YT)s≥0= (\u0000(BT+s\u0000BT))s≥0.而标准布朗运动的相反\n数仍然是标准布朗运动 ,所以 ,以(Bt)0≤t≤T(即(Yt)0≤t≤T)作为条件 ,后续\n增量过程 (YT+s\u0000YT)s≥0的条件分布也与标准布朗运动相同 .综上 ,(Yt)t≥0\n与(Bt)t≥0同分布 .\n推论 8.3.4.设(Bt)t≥0是一个起始于 a的标准布朗运动 .假设b > a .那\n么,对于任意的 t>0,\nP(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b).\n证明 .令T= infft\u00150 :Bt=bg.所求为P(T2[0,t]).注意到\nP(T2[0,t]) =P(T2[0,t],Bt\u0015b) +P(T2[0,t],Bt\u0014b).\n利用反射原理 ,P(T2[0,t],Bt\u0014b) =P(T2[0,t],Bt\u0015b).而\nP(T2[0,t],Bt\u0015b) =P(Bt\u0015b).\n综上即可得证 .\n例 8.3.考虑标准布朗运动 .令Mt= maxfBs:s2[0,t]g.那么 ,Mt和jBtj\n同分布 .114 第八章 布朗运动\n证明 .对于b\u00150,根据反射原理和对称性 ,\nP(Mt\u0015b) =P(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b) =P(jBtj \u0015b).\n例 8.4.证明依概率 1,\nlim\nt→+∞Bt\nt= 0.\n证明 .首先 ,考虑仅在整数时刻上取值的极限 .注意到\nBn=nX\nk=1Bk\u0000Bk−1.\n而(Bk\u0000Bk−1)k≥1独立同分布 .所以 ,利用强大数定律 ,依概率 1,\nlim\nn→∞Bn\n", "≤T)作为条件 ,后续\n增量过程 (YT+s\u0000YT)s≥0的条件分布也与标准布朗运动相同 .综上 ,(Yt)t≥0\n与(Bt)t≥0同分布 .\n推论 8.3.4.设(Bt)t≥0是一个起始于 a的标准布朗运动 .假设b > a .那\n么,对于任意的 t>0,\nP(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b).\n证明 .令T= infft\u00150 :Bt=bg.所求为P(T2[0,t]).注意到\nP(T2[0,t]) =P(T2[0,t],Bt\u0015b) +P(T2[0,t],Bt\u0014b).\n利用反射原理 ,P(T2[0,t],Bt\u0014b) =P(T2[0,t],Bt\u0015b).而\nP(T2[0,t],Bt\u0015b) =P(Bt\u0015b).\n综上即可得证 .\n例 8.3.考虑标准布朗运动 .令Mt= maxfBs:s2[0,t]g.那么 ,Mt和jBtj\n同分布 .114 第八章 布朗运动\n证明 .对于b\u00150,根据反射原理和对称性 ,\nP(Mt\u0015b) =P(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b) =P(jBtj \u0015b).\n例 8.4.证明依概率 1,\nlim\nt→+∞Bt\nt= 0.\n证明 .首先 ,考虑仅在整数时刻上取值的极限 .注意到\nBn=nX\nk=1Bk\u0000Bk−1.\n而(Bk\u0000Bk−1)k≥1独立同分布 .所以 ,利用强大数定律 ,依概率 1,\nlim\nn→∞Bn\nn= 0.\n对每一个n,令\nNn= maxfjBt\u0000Bnj:n\u0014t\u0014n+ 1g.\n如果我们可以证明依概率 1,\nlim\nn→∞Nn\nn= 0.\n对每一个t,若n\u0014t\u0014n+ 1 ,那么 ,\njBtj\nt\u0014jBnj+jNnj\nn.\n于是 ,可得结论 .所以 ,我们接下来证明依概率 1,\nlim\nn→∞Nn\nn.\n令\nMn= maxfBt\u0000Bn:n\u0014t\u0014n+ 1g.\n利用对称性和反射原理 ,我们有\nP(Nn\u0015a)\u00142P(Mn\u0015a) = 4P(B1\u0015a).\n注意到E(eλB1) =eλ2/2.所以 ,根据 Markov不等式 ,我们有\nP(B1\u0015a) =P(eλB1\u0015eλa)\u0014e−λa+λ2/2.第 8.3节 马尔可夫性 115\n取λ=a,可得\nP(B1\u0015a)\u0014e−a2/2.\n取a= 2p\nlnn.那么 ,我们知道\nP(Nn\u00152p\nlnn)\u00144n−2.\n根据 Borel-Cantelli 引理 ,除去有限个 n,我们有Nn<2p\nlnn.特别的 ,我\n们有\nlim\nn→∞Nn\nn= 0.\n例 8.5.考虑标准布朗运动 .设t>1,求\nP(9s2[1,t],Bs= 0).\n证明 .我们对t= 1时,Bt的位置取条件 .假设B1=b > 0.则存在\n1\u0014s\u0014t使得Bs= 0等同于存在 0\u0014s\u0014t\u00001,Bs\u0014 \u0000b.根据对称性 ,这\n也和存在 0\u0014s\u0014t\u00001,Bs\u0015b一样 .根据反射原理 ,可以计算此条件概率 :\nP(9s2[1,t],Bs= 0jB1=b) = 2P(Bt−1\u0015b)\n= 2Z+∞\nb1p\n2π(t\u00001)e−x2\n2(t−1)dx.\n由对称性 ,若B1=\u0000b,条件概率是一样的 .接下来 ,我们利用重期望公式 ,\n得到\nP(9s2[1,t],Bs= 0)\n=E(P(9s2[1,t],Bs= 0jB1))\n=E(2Z+∞\n|B1|1p\n2π(t\u00001)e−x2\n2(t−1)dx)\n= 1\u00002\nπarctan1pt\u00001.\n注 8.3.5.利用类似的证明 ,对于t2[0,1),\nP(∄s2(t,1],Bs= 0) =2\nπarcsinp\nt.\n令τ= supft2[0,1] :Bt= 0g.那么 ,我们有\nP(τ\u0014t) =P(∄s2(t,1],Bs= 0) =2\nπarcsinp\nt.\n这被称为是 反正弦律 .可以发现τ服从参数为 (1/2,1/2)的 Beta分布 .116 第八章 布朗运动\n例 8.6.令T= arg max 0≤t≤1Bt.即T是[0,1]上,使得Bt达到最大值的\n时刻 .那么 ,\nP(T\u0014t) =2\nπarcsinp\nt.\n这也被称为 反正弦律 .并且 ,可以发现T服从参数为 (1/2,1/2)的 Beta分\n布.\n证明 .注意到\nP(T\u0014t) =P(max\ns∈[0,t]Bs\u0015 max\ns∈[t,1]Bs)\n=P(max\ns∈[0,t]Bs\u0000Bt\u0015 max\ns∈[t,1]Bs\u0000Bt).\n利用马氏性 , max s∈[0,t]Bs\u0000Bt和 max s∈[t,1]Bs\u0000Bt独立 .并且 ,随机变\n量 max s∈[t,1]Bs\u0000Bt和随机变量 M1−t= max s∈[0,1−t]Bs同分布 .而(Bs\u0000\nBt)s∈[0,t]和(Bs)s∈[0,t]同分布 .所以 , max s∈[0,t]Bs\u0000Bt和Mt= max s∈[0,t]Bs\n同分布 .而根据反射原理 ,Mt和jBtj同分布 .所以 ,我们用\nP(T\u0014t) =P(jBtj \u0014 jY1−tj).\n其中 ,(Yt)t≥0是一个独立于 (Bt)t≥0的标准布朗运动 .令(U,V)是二维标准\n正态分布 .那么 ,(Bt,Y1−t)和(p\ntU,p1\u0000tV)同分布 .所以 ,所求为\nP(T\u0014t) =P(p\ntjUj \u0014p\n1\u0000tjVj).\n利用二维正态分布的性质 ,(U/p\nU2+V2,V/p\nU2+V2)服从单位圆周上的\n均匀分布 .进而 ,我们求出\nP(T\u0014t) =2\nπarcsinp\nt.\n第 8.4节 布朗运动的轨道的性质\n为了证明布朗运动的轨道性质 ,我们需要使用 Blumenthal 零一律 .在\n介绍此零一律之前 ,我们需要引入域流 (filtration) 的右极限的概念 .对于一\n个域流 (Ft)t≥0,我们定义\nFt+=\\s>tFs.\n由于事件域的交仍是事件域 ,所以 ,Ft", "1]Bs\u0000Bt).\n利用马氏性 , max s∈[0,t]Bs\u0000Bt和 max s∈[t,1]Bs\u0000Bt独立 .并且 ,随机变\n量 max s∈[t,1]Bs\u0000Bt和随机变量 M1−t= max s∈[0,1−t]Bs同分布 .而(Bs\u0000\nBt)s∈[0,t]和(Bs)s∈[0,t]同分布 .所以 , max s∈[0,t]Bs\u0000Bt和Mt= max s∈[0,t]Bs\n同分布 .而根据反射原理 ,Mt和jBtj同分布 .所以 ,我们用\nP(T\u0014t) =P(jBtj \u0014 jY1−tj).\n其中 ,(Yt)t≥0是一个独立于 (Bt)t≥0的标准布朗运动 .令(U,V)是二维标准\n正态分布 .那么 ,(Bt,Y1−t)和(p\ntU,p1\u0000tV)同分布 .所以 ,所求为\nP(T\u0014t) =P(p\ntjUj \u0014p\n1\u0000tjVj).\n利用二维正态分布的性质 ,(U/p\nU2+V2,V/p\nU2+V2)服从单位圆周上的\n均匀分布 .进而 ,我们求出\nP(T\u0014t) =2\nπarcsinp\nt.\n第 8.4节 布朗运动的轨道的性质\n为了证明布朗运动的轨道性质 ,我们需要使用 Blumenthal 零一律 .在\n介绍此零一律之前 ,我们需要引入域流 (filtration) 的右极限的概念 .对于一\n个域流 (Ft)t≥0,我们定义\nFt+=\\s>tFs.\n由于事件域的交仍是事件域 ,所以 ,Ft+仍是事件域 .第 8.4节 布朗运动的轨道的性质 117\n定理 8.4.1 (Blumenthal 零一律 ).用Ft表示由标准布朗运动 (Bt)t≥0生成\n的域流 ,即\nFt=σ(Bs,s\u0014t).\n假设事件A2 F 0+.那么 ,我们有P(A)等于 0或者 1.\n证明 .给定A2 F 0+,0<t 1<t 2<\u0001 \u0001 \u0001<tn和一个有界连续函数 g:Rn!\nR.由于布朗运动的连续性 ,我们有\nE(1Ag(Bt1,Bt2,...,B tn)) = lim\nε→0E(1Ag(Bt1\u0000Bε,Bt2\u0000Bε,...,B tn\u0000Bε)).\n注意到A2 F 0+\u001a F ε.根据马氏性 ,对于充分小的 ε,布朗运动在 ε时刻\n后的增量 (Bt1\u0000Bε,Bt2\u0000Bε,...,B tn\u0000Bε)独立于 Fε.所以 ,1A独立于\ng(Bt1\u0000Bε,Bt2\u0000Bε,...,B tn\u0000Bε).故,8A2 F 0+,对于充分小的 ε,我们有\nE(1Ag(Bt1,Bt2,...,B tn)) =P(A)E(g(Bt1\u0000Bε,Bt2\u0000Bε,...,B tn\u0000Bε)).\n令ε!0,利用布朗运动的连续性 ,可得\nE(1Ag(Bt1,Bt2,...,B tn)) =P(A)E(g(Bt1,Bt2,...,B tn)).\n这说明 F0+独立于σ(Bt1,Bt2,...,B tn).由于此独立性对任意 tn>tn−1>\n\u0001 \u0001 \u0001> t 1>0都成立 ,所以 ,F0+独立于σ(Bt,t > 0).再由于布朗运动轨道\n的连续性 ,B0实际上被 (Bt)t>0所确定 .故,σ(Bt,t > 0) =σ(Bt,t\u00150).\n再利用包含关系 F0+\u001aσ(Bt,t\u00150),可知F0+与自身独立 .这足以说明\n8A2 F 0+,P(A)等于 0或者 1.\n在准备工作完成后 ,我们开始研究布朗运动的轨道的性质 .我们首先考\n察其单调性 .我们将看到布朗运动的轨道是无处单调的 .我们将分几步完成\n这个结论的证明 .\n命题 8.4.2.依概率 1,8ε>0,我们有\nsup\n0≤t≤εBt>0,inf\n0≤t≤εBt<0.\n证明 .我们只证明关于上确界 sup的结论 ,关于下确界 inf的证明是类似的 .\n记An=fsup0≤t≤1/nBt>0g.则,An是个事件 ,关于 F1/n可测 .\n并且随着n增加 ,An单调下降 .记A∞=\\n≥1An.我们只需要证明\nP(A∞) = 1即可 .注意到A∞2 F 0+.根据 Blumenthal 零一律 ,我们只需\n要说明P(A∞)>0即可 .注意到P(An)\u0015P(B1/n>0) = 1/2 .再利用概率\n的从上连续性 ,P(A∞) = limn→∞P(An)\u00151/2>0.于是 ,命题得证 .118 第八章 布朗运动\n推论 8.4.3.几乎必然的 ,布朗运动的轨道 t7!Bt在任何非平凡的区间 I\n上都不是单调的 .\n证明 .由性质 8.4.2、马氏性以及概率的次可加性 ,依概率 1,对于所有的非负\n有理数q,对于所有实数 ε>0,我们有\nsup\nq≤t≤q+εBt\u0000Bq>0, inf\nq≤t≤q+εBt\u0000Bq<0.\n而这足以说明结论 . (这里 ,我们只考虑非负有理数 q的原因是有理数是可\n数的 ,而可数个零概率事件的并集仍然是零概率的 .)\n接下来 ,我们考察标准布朗运动 (Bt)t≥0在时间趋于无穷时的表现 .令\nb>0.反射原理 (定理 8.3.3 )说明\nP(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b). (8.2)\n而Bt\u0018N(0,t).所以 ,P(Bt\u0015b) = 1 \u0000Φ(b/p\nt)t→+∞! 1/2 .在(8.2 )中令\nt!+1,利用标准布朗运动的轨道连续性 ,我们得到\nP(9s\u00150,Bs=b) = 1,8b>0.\n这说明无论对于多么大的预先指定的 b,布朗运动都会在有限的时间到达\nb.因此 , lim supt→+∞Bt= +1.由于 (\u0000Bt)t≥0也是标准布朗运动 ,所以 ,\nlim inf t→+∞Bt=\u00001 .我们将这个结果总结为下述性质 :\n命题 8.4.4.假设 (Bt)t≥0是标准布朗运动 .那么 ,我们有\nlim sup\nt→+∞Bt= +1,", "的区间 I\n上都不是单调的 .\n证明 .由性质 8.4.2、马氏性以及概率的次可加性 ,依概率 1,对于所有的非负\n有理数q,对于所有实数 ε>0,我们有\nsup\nq≤t≤q+εBt\u0000Bq>0, inf\nq≤t≤q+εBt\u0000Bq<0.\n而这足以说明结论 . (这里 ,我们只考虑非负有理数 q的原因是有理数是可\n数的 ,而可数个零概率事件的并集仍然是零概率的 .)\n接下来 ,我们考察标准布朗运动 (Bt)t≥0在时间趋于无穷时的表现 .令\nb>0.反射原理 (定理 8.3.3 )说明\nP(9s2[0,t],Bs\u0015b) = 2P(Bt\u0015b). (8.2)\n而Bt\u0018N(0,t).所以 ,P(Bt\u0015b) = 1 \u0000Φ(b/p\nt)t→+∞! 1/2 .在(8.2 )中令\nt!+1,利用标准布朗运动的轨道连续性 ,我们得到\nP(9s\u00150,Bs=b) = 1,8b>0.\n这说明无论对于多么大的预先指定的 b,布朗运动都会在有限的时间到达\nb.因此 , lim supt→+∞Bt= +1.由于 (\u0000Bt)t≥0也是标准布朗运动 ,所以 ,\nlim inf t→+∞Bt=\u00001 .我们将这个结果总结为下述性质 :\n命题 8.4.4.假设 (Bt)t≥0是标准布朗运动 .那么 ,我们有\nlim sup\nt→+∞Bt= +1,lim inf\nt→+∞Bt=\u00001.\n利用布朗运动的连续性 ,我们可知布朗运动的常返性 :\n推论 8.4.5. 8x2R,标准布朗运动将无穷多次到达点 x.\n注 8.4.6.对于x > 0,用Tx表示标准布朗运动第一次到达 x的时刻 .那\n么,可以证明Tx与x2/B2\n1同分布 ,有密度函数\nfTx(t) =xp\n2πt3exp\u0012\n\u0000x2\n2t\u0013\n,t> 0.\n特别的 ,E(Tx) = + 1.效仿马氏链的定义 ,我们称布朗运动是 零常返的.第 8.4节 布朗运动的轨道的性质 119\n回忆例 8.4反映了某种大数定律 ,它表明对于标准布朗运动 (Bt)t≥0而\n言,\nlim\nt→∞Bt/t= 0.\n考虑最大值过程 Mt= maxfBs:s2[0,t]g.结合性质 8.4.4 ,这说明虽然 Mt\n的值随着t!+1趋于正无穷 ,但是它趋于正无穷的速度远小于 t.那么 ,\n我们可以提出一个自然的问题 :Mt趋于正无穷的速度到底是多少 ?经典的\n重对数律给出了这个问题的回答 .\n定理 8.4.7 (重对数律 ).\nlim\nt→∞Mtp2tlog logt= 1,\n或者等价的 ,\nlim sup\nt→∞Btp2tlog logt= 1.\n重对数律是高斯变量的尾分布估计和 Borel-Cantelli 引理的结合 ,具体\n证明见 [Kal21 ,定理 14.18].\n关于标准布朗运动在 t!+1时的渐近性质的介绍暂且告一段落 .我\n们转而研究 t!0+时,标准布朗运动的表现 .为此 ,我们将借用标准布朗运\n动的如下不变性 :\n命题 8.4.8.假设 (Bt)t≥0是一个标准的布朗运动 .令Yt=tB1/t,t>0.补\n充定义Y0= 0 .那么 ,(Yt)t≥0是一个标准的布朗运动 .\n证明 .根据标准布朗运动 (Bt)t≥0的连续性 ,对于t > 0,t7!Yt是连续\n的.利用例 8.4 ,(Yt)t≥0在t= 0处也是连续的 .为了证明 (Yt)t≥0是标准\n布朗运动 ,我们只需要说明 (Yt)t≥0的有限维分布和 (Bt)t≥0的有限维分布\n相同 .由于标准布朗运动 (Bt)t≥0是零均值高斯过程 ,所以 ,(Yt)t≥0也是\n零均值高斯过程 .因此 ,我们只需要说明 (Yt)t≥0的协方差函数 ΓY(s,t) =\nmin(s,t).而这是因为 ΓY(s,t) =EYsYt=EstB 1/sB1/t=stΓB(1/s,1/t) =\nstmin(1/s,1/t) = min(s,t).\n注 8.4.9.性质 8.4.8表明标准布朗运动在 t很大时的表现与其在 t接近于 0\n时的表现可以互相转化 .因此 ,布朗运动在 t!+1时的性质与其在 t!0\n时的性质是对应的 .例如 ,我们采用性质 8.4.8中的记号 .由例 8.4 ,我们知道\nlim\nt→0B1/t/(1/t) = 0.120 第八章 布朗运动\n这等价于\nlim\nt→0Yt= 0 =Y0,\n即标准布朗运动在 t= 0时的连续性 .当然 ,我们不能反过来用性质 8.4.8证\n明例 8.4 ,这样就循环论证了 .\n利用性质 8.4.8和定理 8.4.7 ,我们可以得到如下重对数律 :\n定理 8.4.10 (重对数律 ).假设 (Bt)t≥0是标准布朗运动 .那么 ,我们有\nlim sup\nt→+∞Btp\n2tlog log (1/t)= 1.\n从上述重对数律 ,我们发现依概率 1,布朗运动的轨道在零时刻并不是\n可微的 .由于布朗运动的增量是平移不变的 ,可以看出在任意预先指定的一\n个时刻t,依概率 1,布朗运动的轨道在 t时刻都不是可微的 .一个自然的猜\n测是依概率 1,布朗运动的轨道是无处可微的 .但是 ,这并不能由前面关于指\n定的时刻t的结果推出 ,因为不可数个零测集的并并不一定还是零测集 .我\n们有如下结果 :\n定理 8.4.11.依概率 1,布朗运动的轨道 t7!Bt是无处可微的 .\n作为推论 ,我们知道布朗运动的轨", "+1时的性质与其在 t!0\n时的性质是对应的 .例如 ,我们采用性质 8.4.8中的记号 .由例 8.4 ,我们知道\nlim\nt→0B1/t/(1/t) = 0.120 第八章 布朗运动\n这等价于\nlim\nt→0Yt= 0 =Y0,\n即标准布朗运动在 t= 0时的连续性 .当然 ,我们不能反过来用性质 8.4.8证\n明例 8.4 ,这样就循环论证了 .\n利用性质 8.4.8和定理 8.4.7 ,我们可以得到如下重对数律 :\n定理 8.4.10 (重对数律 ).假设 (Bt)t≥0是标准布朗运动 .那么 ,我们有\nlim sup\nt→+∞Btp\n2tlog log (1/t)= 1.\n从上述重对数律 ,我们发现依概率 1,布朗运动的轨道在零时刻并不是\n可微的 .由于布朗运动的增量是平移不变的 ,可以看出在任意预先指定的一\n个时刻t,依概率 1,布朗运动的轨道在 t时刻都不是可微的 .一个自然的猜\n测是依概率 1,布朗运动的轨道是无处可微的 .但是 ,这并不能由前面关于指\n定的时刻t的结果推出 ,因为不可数个零测集的并并不一定还是零测集 .我\n们有如下结果 :\n定理 8.4.11.依概率 1,布朗运动的轨道 t7!Bt是无处可微的 .\n作为推论 ,我们知道布朗运动的轨道在任何非平凡的区间上的全变差是\n无穷 .这是因为有限变差函数是勒贝格意义下几乎处处可微的 ,而布朗运动\n的轨道是无处可微的 .\n推论 8.4.12.依概率 1,布朗运动的轨道 t7!Bt在任何长度严格大于 0的\n区间上的全变差都是无穷 .\n但是 ,布朗运动的二次变差是有限的 ,也是非零的 .关于布朗运动二次\n变差的结果是我们定义关于布朗运动的随机积分的关键预备知识 .\n命题 8.4.13.假设 0 =tn\n0\u0014tn\n1\u0014 \u0001 \u0001 \u0001 \u0014tn\nmn=t是区间 [0,t]的一个划分的\n划分点序列 .假设此划分的网眼大小趋于零 ,即 limn→∞ max i=1,2,...,m n(tn\ni\u0000\ntn\ni−1) = 0 .那么 ,在L2收敛的意义下 ,我们有\nlim\nn→∞mnX\ni=1(Btn\ni\u0000Btn\ni−1)2=t.\n证明 .首先 ,因为Btn\ni\u0000Btn\ni−1\u0018N(0,tn\ni\u0000tn\ni−1),所以 ,\nE(mnX\ni=1(Btn\ni\u0000Btn\ni−1)2) =mnX\ni=1E(Btn\ni\u0000Btn\ni−1)2=mnX\ni=1(tn\ni\u0000tn\ni−1) =t.第 8.5节 布朗运动的零集 121\n再利用 (Btn\ni\u0000Btn\ni−1)i=1,2,...,m n的独立性 ,我们有\nVar(mnX\ni=1(Btn\ni\u0000Btn\ni−1)2) =mnX\ni=1Var((Btn\ni\u0000Btn\ni−1)2).\n因为Btn\ni\u0000Btn\ni−1\u0018N(0,tn\ni\u0000tn\ni−1),所以 ,\nVar((Btn\ni\u0000Btn\ni−1)2) =E(Btn\ni\u0000Btn\ni−1)4\u0000(E(Btn\ni\u0000Btn\ni−1)2)2= 2(tn\ni\u0000tn\ni−1)2.\n因此 ,我们有\nVar(mnX\ni=1(Btn\ni\u0000Btn\ni−1)2) = 2mnX\ni=1(tn\ni\u0000tn\ni−1)2\u00142t max\ni=1,2,...,m n(tn\ni\u0000tn\ni−1)n→∞!0.\n综上 ,得证 .\n利用布朗运动的二次变差非零的事实 ,也可以知道布朗运动的轨道的全\n变差为正无穷 .\n第 8.5节 布朗运动的零集\n在本节中 ,我们将研究随机集合\nZ=ft\u00150 :Bt= 0g.\n利用布朗运动的连续性 ,可以证明Z是闭集 .在分析这个集合时 ,我们将运\n用布朗运动的两个重要的刻度结论 .\n命题 8.5.1.假设 (Bt)t≥0是一个标准的布朗运动 .\n1.若a>0,令Yt=a−1/2Bat.那么 ,(Yt)t≥0是一个标准的布朗运动 .\n2.令Yt=tB1/t.那么 ,(Yt)t≥0是一个标准的布朗运动 .\n在上一节的例子中 ,我们证明了\nP(Z\\[1,t]6=;) = 1\u00002\nπarctan1\nt\u00001.\n当t! 1时,上述概率趋于 1.这说明布朗运动最终一定会返回原点 .根据\n强马氏性 ,布朗运动会无穷多次的回到原点 .进而 ,我们发现布朗运动在任\n意大的时刻后还可取正值和负值 .122 第八章 布朗运动\n令Yt=tB1/t.当t趋于零时 ,1/t趋于正无穷 .而(Bt)t≥0在任意时刻\n之后都还可以取正值和负值 .所以 ,(Yt)t≥0在任意小的时间内都可以取正值\n和负值 .从而 ,根据连续性一定可以取 0.所以 ,0不是Z中孤立的点 .利用\n强马氏性 ,可以证明Z中没有孤立的点 .\n接下来 ,我们讨论集合 Z有多大 .此时 ,我们需要讨论一个集合的维数\n的概念 .集合的维数有几种不同的定义方式 .其中 ,最常用的是 Hausdorff\n维数和 Minkowski 维数 .为了简单起见 ,我们这里讨论 Minkowski 维数 .它\n也叫做盒维数 .对于一个度量空间 ,考虑用直径为 ε的闭球覆盖一个全有界\n子集K.覆盖所需要的最少的球的数目记为 N(K,ε).那么 ,记 Minkowski\n上维数 dim(K)为\nlim sup\nε→0logN(K,ε)\nlog(1/ε),\n记 Minkowski 下维数 dim(K)为\nlim inf\nε→0logN(K,ε)\nlog(1/ε).\n如果上下维数相等 ,则称其为 Minkowski 维数 .在一般的假设下 ,可以证明\nMinkowski 维数和 Hausdorff 维数相同 ,可以笼统的称为分形", "�运动最终一定会返回原点 .根据\n强马氏性 ,布朗运动会无穷多次的回到原点 .进而 ,我们发现布朗运动在任\n意大的时刻后还可取正值和负值 .122 第八章 布朗运动\n令Yt=tB1/t.当t趋于零时 ,1/t趋于正无穷 .而(Bt)t≥0在任意时刻\n之后都还可以取正值和负值 .所以 ,(Yt)t≥0在任意小的时间内都可以取正值\n和负值 .从而 ,根据连续性一定可以取 0.所以 ,0不是Z中孤立的点 .利用\n强马氏性 ,可以证明Z中没有孤立的点 .\n接下来 ,我们讨论集合 Z有多大 .此时 ,我们需要讨论一个集合的维数\n的概念 .集合的维数有几种不同的定义方式 .其中 ,最常用的是 Hausdorff\n维数和 Minkowski 维数 .为了简单起见 ,我们这里讨论 Minkowski 维数 .它\n也叫做盒维数 .对于一个度量空间 ,考虑用直径为 ε的闭球覆盖一个全有界\n子集K.覆盖所需要的最少的球的数目记为 N(K,ε).那么 ,记 Minkowski\n上维数 dim(K)为\nlim sup\nε→0logN(K,ε)\nlog(1/ε),\n记 Minkowski 下维数 dim(K)为\nlim inf\nε→0logN(K,ε)\nlog(1/ε).\n如果上下维数相等 ,则称其为 Minkowski 维数 .在一般的假设下 ,可以证明\nMinkowski 维数和 Hausdorff 维数相同 ,可以笼统的称为分形维数 .\n例 8.7. Cantor三分集的维数是ln2\nln3.\n命题 8.5.2.零集Z\\[0,1]的分形维数是 1/2 .\n证明 .我们先证明零集 Z1=Z\\[0,1]的 Minkowski 维数小于等于 1/2 .为\n此,我们考虑一种用直径为 ε= 1/n的一维球覆盖 Z1的方法 .这些一维球\n从区间 f[(k\u00001)/n,k/n]gk=1,2,...,n中选取 .如果 [(k\u00001)/n,k/n]和Z1的交\n集非空 ,我们在覆盖 Z1时就用上区间 [(k\u00001)/n,k/n].上述的区间和 Z1相\n交非空的个数被我们记为 M(n).那么 ,最小覆盖数 N(Z1,1/n)不超过Mn.\n为了给出Mn的上界 ,从而给出N(Z1,1/n)的上界 ,我们估计EM(n)的上\n界.根据期望的线性性质 ,我们有EM(n) =Pn\nk=1P(k,n),其中 ,\nP(k,n) =P(Z1\\[(k\u00001)/n,k/n]6=;).\n对于k= 0 ,因为 02Z1,所以 ,P(k,n) = 1 .下面考虑k\u00152.利用布朗\n运动的刻度性质 ,我们知道Yt=a−1/2Xat也是标准布朗运动 ,其中 ,我们取\na=n\nk−1.那么 ,可以发现\nP(k,n) =P(9t2[1,k/(k\u00001)],Yt= 0) = 1 \u00002\nπarctanp\nk\u00001.第 8.5节 布朗运动的零集 123\n注意到当x很大时 ,\n1\u00002\nπarctanx\u00182\nπx.\n所以 ,我们有\nEM(n) =nX\nk=1P(k,n)\u00184\nπpn.\n从而 ,存在C < +1使得 ,\nEN(Z1,1/n)\u0014EM(n)\u0014Cpn.\n利用 Markov不等式 ,对于任意的 δ>0,我们有\nP(N(Z1,1/n)>n1/2+ δ)\u0014Cn−δ.\n从而 ,\nP(N(Z1,1/n2/δ)>n1/δ+2)\u0014Cn−2.\n根据 Borel-Cantelli 引理 ,依概率 1,N(Z1,1/n2/δ)最终不超过 n1/δ+2.所\n以,我们有\ndim(Z1) = lim sup\nε→0logN(Z1,ε)\nlog(1/ε)= lim sup\nn→∞logN(Z1,1/n2/δ)\nlog(n2/δ)\u00141\n2+δ.\n其中 ,第 2个等号用到了 ε7!N(Z1,ε)的单调性和 limn→∞log((n+1)2/δ)\nlog(n2/δ).最\n后,由δ的任意性 ,dim(Z1)\u00141/2 .\n然后 ,我们再证明零集 Z1=Z\\[0,1]的 Minkowski 维数大于等于 1/2 .\n我们注意到最小覆盖数 N(Z1,1/n)不小于M(n)的一半 .这是因为一个长\n度为 1/n的区间只能覆盖至多两个形如 Z1\\[(k\u00001)/n,k/n]的集合 .我们\n转而估计M(n)的下界 .为此 ,我们估计M(n)的方差 Var(M(n))的上界 .\n用Fk表示事件 fZ1\\[(k\u00001)/n,k/n]6=;g.那么 ,我们有\nVar(M(n)) = Var(nX\nk=1I(Fk))\n=nX\nk=1D(I(Fk)) + 2X\n1≤k<ℓ≤nCov(I(Fk),I(Fℓ)).\n其中 ,我们有\nnX\nk=1D(I(Fk))\u0014nX\nk=1P(Fk) =nX\nk=1P(k,n)\u0014Cpn.124 第八章 布朗运动\n为了表示 Cov(I(Fk),I(Fℓ)),我们引入函数\nφ(s) =P(Z1\\[(s\u00001)/n,s/n]6=;),s\u00151.\n那么 ,用类似P(k,n)的计算方法 ,我们可以知道\nφ(s) = 1\u00002\nπarctanp\ns\u00001.\n容易发现φ(s)是一个单调递降的函数 .令τ= infft\u0015(k\u00001)/n:Xt= 0g.\n那么 ,我们有\nP(FkFℓ) =P(τ\u0014k/n,F ℓ).\n注意到Xτ= 0 .在停时τ的时刻应用强马氏性 ,可得\nP(τ\u0014k/n,F ℓ) =E(P(τ\u0014k/n,F ℓjFτ)) =E(I(τ\u0014k/n)φ(ℓ\u0000nτ)).\n利用τ2[(k\u00001)/n,k/n]以及φ(s)的单调性 ,我们知道\nφ(ℓ\u0000nτ))\u0014φ(ℓ\u0000k).\n所以 ,我们有\nP(FkFℓ)\u0014φ(k)φ(ℓ\u0000k).\n于是 ,我们有\nCov(I(Fk),I(Fℓ))\u0014φ(k)φ(ℓ\u0000k)\u0000φ(k)φ(ℓ).\n可以证明存在 c>0和C1<+1,使得\nVar(M(n))\u0014C1n1−c.\n从而 ,根据 Chebyshev 不等式 ,对于任意的 δ>0,存在C2<+1,\nP(M(n)\u0014n1/2−δ)\u0014C2n−c.\n根据 Borel-Cantelli 引理 ,依概率 1,N(Z1,1/n)\u0015M(n)/2最终超过n1/2−δ.\n所以 ,我们有", "(Fk),I(Fℓ)).\n其中 ,我们有\nnX\nk=1D(I(Fk))\u0014nX\nk=1P(Fk) =nX\nk=1P(k,n)\u0014Cpn.124 第八章 布朗运动\n为了表示 Cov(I(Fk),I(Fℓ)),我们引入函数\nφ(s) =P(Z1\\[(s\u00001)/n,s/n]6=;),s\u00151.\n那么 ,用类似P(k,n)的计算方法 ,我们可以知道\nφ(s) = 1\u00002\nπarctanp\ns\u00001.\n容易发现φ(s)是一个单调递降的函数 .令τ= infft\u0015(k\u00001)/n:Xt= 0g.\n那么 ,我们有\nP(FkFℓ) =P(τ\u0014k/n,F ℓ).\n注意到Xτ= 0 .在停时τ的时刻应用强马氏性 ,可得\nP(τ\u0014k/n,F ℓ) =E(P(τ\u0014k/n,F ℓjFτ)) =E(I(τ\u0014k/n)φ(ℓ\u0000nτ)).\n利用τ2[(k\u00001)/n,k/n]以及φ(s)的单调性 ,我们知道\nφ(ℓ\u0000nτ))\u0014φ(ℓ\u0000k).\n所以 ,我们有\nP(FkFℓ)\u0014φ(k)φ(ℓ\u0000k).\n于是 ,我们有\nCov(I(Fk),I(Fℓ))\u0014φ(k)φ(ℓ\u0000k)\u0000φ(k)φ(ℓ).\n可以证明存在 c>0和C1<+1,使得\nVar(M(n))\u0014C1n1−c.\n从而 ,根据 Chebyshev 不等式 ,对于任意的 δ>0,存在C2<+1,\nP(M(n)\u0014n1/2−δ)\u0014C2n−c.\n根据 Borel-Cantelli 引理 ,依概率 1,N(Z1,1/n)\u0015M(n)/2最终超过n1/2−δ.\n所以 ,我们有\ndim(Z1) = lim inf\nε→0logN(Z1,ε)\nlog(1/ε)= lim inf\nn→∞logN(Z1,1/n)\nlogn\u00151\n2\u0000δ.\n其中 ,第 2个等号用到了 ε7!N(Z1,ε)的单调性和 limn→∞log((n+1)2/δ)\nlog(n2/δ)= 1 .\n最后 ,由δ的任意性 , dim (Z1)\u00151/2 .第 8.6节 多维布朗运动 125\n第 8.6节 多维布朗运动\n在本节中 ,我们考虑d维标准布朗运动 .假定 (B1\nt)t≥0,..., (Bd\nt)t≥0是d\n个独立的标准布朗运动 .那么 ,我们称向量值过程\nBt= (B1\nt,...,Bd\nt)\n为一个标准的 d维布朗运动 .可以验证 (Bt)t≥0满足下列性质 :\n1.B0= 0 ;\n2.对任意的s1\u0014t1\u0014s2\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014sn\u0014tn,随机向量Bt1\u0000Bs1,Bt2\u0000\nBs2,...,B tn\u0000Bsn相互独立 ;\n3.对于 0\u0014s<t ,Bt\u0000Bs服从均值为 0,协方差为 (t\u0000s)Id的d维正\n态分布 ;\n4.轨道t7!Bt连续 .\n可以证明上述性质可以作为 d维布朗运动的等价定义 .\n类似于一维情形 ,对于x2Rd和从原点出发的 d维标准布朗运动\n(Bt)t≥0,令Yt=x+Bt.则,我们把过程 (Yt)t≥0称为从x出发的d维标准\n布朗运动 .我们记转移概率密度\npt(x,y) =P(Xt2(y,y+dy)jX0=x)/dy.\n那么 ,我们有\npt(x,y) =1\n(2πt)d/2e−|y−x|2/2t.\n同样的 ,此密度函数满足 Kolmogorov-Chapman 方程 :\npt+s(x,y) =Z\npt(x,z)ps(z,y)dz.\n给定一个可积的可测函数 g,我们定义\nf(t,y) =E(g(Xt)jX0=y).\n可以验证f(t,x)满足下列的微分方程 :\n∂f\n∂t=1\n2∆f,126 第八章 布朗运动\n其中 ,∆表示 Laplace算子 ,\n∆f(t,x1,x2,...,x d) =dX\ni=1∂2f\n∂x2\ni.\nf满足的方程被称为热方程 ,它描述温度的演化 .\n我们考虑一个有正则边界的有界区域 B上的有初值条件 u(0,x) =f(x)\n和边值条件 u(t,x) =g(x),x2∂B的热方程 :\n1.∂u\n∂t=1\n2∆u;\n2.u(t,x) =g(x),x2∂B ;\n3.u(0,x) =f(x),x2B.\n以上热方程的解可以通过布朗运动表示出来 .实际上 ,令\nτ= infft\u00150 :Bt2∂Bg.\n则,我们可以将热方程的解写为\nu(t,x) =E(f(Bt)I(τ >t ) +g(Bτ)I(τ\u0014t)jB0=x).\n当t! 1时,温度渐进于一个具有边界值 g(x)的平稳分布 v(x).稳定状态\n的解满足\n1.∆v(x) = 0 ,x2B;\n2.v(x) =g(x),x2∂B .\n该平稳解也可以用布朗运动 (Bt)t≥0表示 :\nν(x) = lim\nt→∞u(t,x) =E(g(Bτ)jB0=x).\n例 8.8.设d= 1 ,且假设I= (a,b),0\u0014a<b< +1.则∂I=fa,bg.取\na<x<b ,假设 (Bt)t≥0是一个从x出发的布朗运动 .令\nτ= infft\u00150 :Bt=a或者bg.\n令g为∂I上的函数 ,g(a) = 0 ,g(b) = 1 .则,\nv(x) =E(g(Bτ)) =P(Bτ=b).\n由上述讨论知 v(x)满足第 8.7节 常返和非常返 127\n1.d2v\ndx2= 0 ,a<x<b ;\n2.v(a) = 0 ,v(b) = 1 .\n解得\nv(x) =x\u0000a\nb\u0000a.\n所以 ,我们得到\nP(从x出发的布朗运动在到达 a之前先到达 b) =x\u0000a\nb\u0000a.\n第 8.7节 常返和非常返\n在本节中 ,我们探讨布朗运动的常返性和非常返性 .对于一维布朗运动 ,\n我们已经知道它是常返的 .接下来 ,我们考虑一般的 d维标准布朗运动 .\n设0<R 1<R 2<+1且令\nA=A(R1,R2)≜fx2Rd:R1<jxj<R 2g.\n那么 ,边界\n∂A=fx2Rd:jxj=R1或者R2g.\n假设x2A.令f(x) =f(x,R 1,R2)为从x出发的标准布朗运动 (Bt)t≥0在\n击中fy:jyj=R1g之", "),x2∂B .\n该平稳解也可以用布朗运动 (Bt)t≥0表示 :\nν(x) = lim\nt→∞u(t,x) =E(g(Bτ)jB0=x).\n例 8.8.设d= 1 ,且假设I= (a,b),0\u0014a<b< +1.则∂I=fa,bg.取\na<x<b ,假设 (Bt)t≥0是一个从x出发的布朗运动 .令\nτ= infft\u00150 :Bt=a或者bg.\n令g为∂I上的函数 ,g(a) = 0 ,g(b) = 1 .则,\nv(x) =E(g(Bτ)) =P(Bτ=b).\n由上述讨论知 v(x)满足第 8.7节 常返和非常返 127\n1.d2v\ndx2= 0 ,a<x<b ;\n2.v(a) = 0 ,v(b) = 1 .\n解得\nv(x) =x\u0000a\nb\u0000a.\n所以 ,我们得到\nP(从x出发的布朗运动在到达 a之前先到达 b) =x\u0000a\nb\u0000a.\n第 8.7节 常返和非常返\n在本节中 ,我们探讨布朗运动的常返性和非常返性 .对于一维布朗运动 ,\n我们已经知道它是常返的 .接下来 ,我们考虑一般的 d维标准布朗运动 .\n设0<R 1<R 2<+1且令\nA=A(R1,R2)≜fx2Rd:R1<jxj<R 2g.\n那么 ,边界\n∂A=fx2Rd:jxj=R1或者R2g.\n假设x2A.令f(x) =f(x,R 1,R2)为从x出发的标准布朗运动 (Bt)t≥0在\n击中fy:jyj=R1g之前击中 fy:jyj=R2g的概率 .令\nτ= infft\u00150 :Bt2∂Ag.\n定义∂A上函数g(y):\ng(y) =(\n1,jyj=R2;\n0,jyj=R1\n那么 ,我们有\nf(x) =Ex(g(Bτ)),\n其中 ,Ex(\u0001)表示条件期望 E(\u0001jB0=x).那么 ,由上一节的结果 ,我们知道f\n满足下列偏微分方程 :\n1.∆f(x) = 0 ,x2A;\n2.f(y) = 1 ,jyj=R2,f(y) = 0 ,jyj=R1.128 第八章 布朗运动\n可以解得\nf(x) =ϕ(jxj),\n其中 ,\nϕ(r) =8\n<\n:ln|x|− lnR1\nlnR2−lnR1, d = 2;\nR2−d\n1−x2−d\nR2−d\n1−R2−d\n2, d\u00153.\n我们先分析 d= 2得情形 .取R1!0,我们得到\nPx(jBtj在到达 0之前先到达 R2) = lim\nR1→0f(x) = 1.\n这表明依概率 1,布朗运动永远也不返回原点 .这说明二维的布朗运动不是\n所谓点常返的 .但是对于固定的 R1,令R2! 1 ,我们得到\nPx(jBtj最终会回到 R1) = lim\nR2→+∞1\u0000f(x) = 1.\n这说明依概率 1,布朗运动最终会回到原点的任意小邻域内 .这被我们称\n为邻域常返 .\n接下来 ,我们考虑d\u00153.类似的分析说明布朗运动以严格正概率不到\n达以原点为中心半径为 R1的小球内 ,此概率等于\n1\u0000(R1/jxj)d−2.\n这说明三维及更高维的布朗运动是非常返的 .\n第 8.8节 布朗运动的分形性质\n设(Bt)t≥0是标准的d维布朗运动 .用A表示布朗运动的路径曾经访\n问到的随机点集 :\nA=fx2Rd:9t\u00150,Bt=xg.\nd= 1时,A=R.本节中 ,我们考虑d\u00152时A的分形维数 .令A1=\nA\\ fx:jxj \u00141g.\n定理 8.8.1.令d\u00152.依概率 1,A1的分形维数是 2.\n为了证明这个定理 ,我们需要一些准备结果 :\n引理 8.8.2.用 dimH(K)表示集合K的 Hausdorff 维数 ,用 dim(K)表示\nK的 Minkowski 下维数 ,用 dim(K)表示K的 Minkowski 上维数 .第 8.8节 布朗运动的分形性质 129\n引理 8.8.3 (Mass transportation principle) .假设µ是个K上的 Borel测\n度.假设µ(K)>0.假设存在常数 α\u00150和0<C < +1使得对于所有球\n心在x,半径为r的闭球B(x,r),\nµ(B(x,r))\u0014Crα.\n那么 ,我们有\ndimH(K)\u0015α.\n定理 8.8.1的证明 .固定n\u00151.我们用直径为 1/n的闭球覆盖以原点为\n中心半径为 1的闭球B(0,1).考虑如上最小覆盖 ,记用于覆盖的小球为\nB1,B2,...,B K(n).其中 ,Bk的球心在xk处.那么 ,K(n)和nd同阶 .对于\nk= 1,2,...,K (n),用Fk表示事件\nf布朗运动曾经到达小球 Bkg.\n令\nM(n) =K(n)X\nk=1I(Fk)\n表示和A有交集的小球个数 .回忆N(A1,1/n)为用直径为 1/n的闭小球\n覆盖A1的最小覆盖数 .那么 ,我们有\nN(A1,1/n)\u0014M(n).\n接下来 ,我们估计P(Fk)和E(M(n)).对于d= 2 ,\nM(n)\u0014K(n)\u0010n2.\n由此 ,不难说明 dim(A1)\u00152.对于d\u00153,对于圆心在 x,直径是 1/n的小\n球,从原点出发布朗运动最终访问它的概率是\n(\n1, jxj \u00141/2n;\n(2njxj)2−d,jxj>1/2n.\n那么 ,\nE(M(n))\u0010n2−dK(n)X\nk=1jmax(xk,1/2n)j2−d\u0010n2.\n利用 Markov不等式 ,存在C < +1,使得\nP(M(n)>n2+δ)\u0014Cn−δ.130 第八章 布朗运动\n所以 ,我们有\nP(M(n2/δ)>n2(2+δ)/δ)\u0014Cn−2.\n根据 Borel-Cantelli 引理 ,依概率 1,M(n2/δ)和N(A1,1/n2/δ)最终不超过\nn2(2+δ)/δ.因此 ,\ndim(A1) = lim sup\nε→0logN(A1,ε)\nlog(1/ε)= lim sup\nn→∞logN(A1,1/n2/δ)\nlog(n2/δ)\u00142 +δ.\n由δ的任意性 ,我们得到 dim(A1)\u00142.\n接下来 ,因为 (Bk)k的最优性 ,它", "同阶 .对于\nk= 1,2,...,K (n),用Fk表示事件\nf布朗运动曾经到达小球 Bkg.\n令\nM(n) =K(n)X\nk=1I(Fk)\n表示和A有交集的小球个数 .回忆N(A1,1/n)为用直径为 1/n的闭小球\n覆盖A1的最小覆盖数 .那么 ,我们有\nN(A1,1/n)\u0014M(n).\n接下来 ,我们估计P(Fk)和E(M(n)).对于d= 2 ,\nM(n)\u0014K(n)\u0010n2.\n由此 ,不难说明 dim(A1)\u00152.对于d\u00153,对于圆心在 x,直径是 1/n的小\n球,从原点出发布朗运动最终访问它的概率是\n(\n1, jxj \u00141/2n;\n(2njxj)2−d,jxj>1/2n.\n那么 ,\nE(M(n))\u0010n2−dK(n)X\nk=1jmax(xk,1/2n)j2−d\u0010n2.\n利用 Markov不等式 ,存在C < +1,使得\nP(M(n)>n2+δ)\u0014Cn−δ.130 第八章 布朗运动\n所以 ,我们有\nP(M(n2/δ)>n2(2+δ)/δ)\u0014Cn−2.\n根据 Borel-Cantelli 引理 ,依概率 1,M(n2/δ)和N(A1,1/n2/δ)最终不超过\nn2(2+δ)/δ.因此 ,\ndim(A1) = lim sup\nε→0logN(A1,ε)\nlog(1/ε)= lim sup\nn→∞logN(A1,1/n2/δ)\nlog(n2/δ)\u00142 +δ.\n由δ的任意性 ,我们得到 dim(A1)\u00142.\n接下来 ,因为 (Bk)k的最优性 ,它们的球心之间的距离至少是 1/2n.因\n此,对于任意半径为 1/2n的小球B,和它有交集的 Bk的数目有一致的上\n界C < +1.这里 ,C对所有的n是一致的 .由此我们可以看出 ,\nN(A1,1/n)\u0015M(n)/C.\n对于d= 2 ,由二维标准布朗运动的邻域常返性 ,我们知道P(Fk) = 1 ,\n8k= 1,2,...,K (n).所以 ,依概率 1,M(n) =K(n)\u0019n2.由此 ,不难\n证明 dim(A1)\u00152.对于d\u00153,根据引理 8.8.2和8.8.3 ,我们只需要证明\ndimH(A1)\u00152即可 .为此 ,对于Rd的 Borel可测集S,我们定义\nµ(S) =Z+∞\n01Bt∈Sdt.\n即,µ是R≥0上的勒贝格测度在连续映射 t7!Xt的像测度 .注意到µ是\n个随机的测度 .我们将µ在空间B(0,1)上的限制记为 µ1.我们只需要证\n明对于任意的充分小 δ >0,存在C=C(δ)2(0,+1),使得对于任意的球\nB(x,r),有\nµ1(B(x,r))\u0014Cr2−δ. (8.3)\n对于一个半径为 r球心在x的球B=B(x,r),可以证明存在 C < +1使\n得,\nsup\nxE(µ(B))\u0014Cr2.\n接下来 ,我们估计µ(B)的矩母函数的上界 :对于λ\u00150,\nE(eλµ(B)) =E(eλ∫+∞\n01Bt∈Bdt)\n=+∞X\nn=0λn\nn!E\u0012Z+∞\n01Bt∈Bdt\u0013n第 8.9节 带漂移的布朗运动 131\n=+∞X\nn=0λnE\u0012Z\n0<t1<t2<···<tn1Bt1∈B\u0001 \u0001 \u00011Btn∈Bdt1\u0001 \u0001 \u0001 dtn\u0013\n.\n依次在时刻 tn,tn−1,...,t 1使用马氏性 ,可以知道\nZ\n0<t1<t2<···<tn1Bt1∈B\u0001 \u0001 \u00011Btn∈Bdt1\u0001 \u0001 \u0001 dtn\u0014(sup\nxE(µ(B)))n\u0014(Cr2)n.\n所以 ,对于 0\u0014Cλr2<1,我们有\nE(eλµ(B))\u0014+∞X\nn=0λn(Cr2)n= 1/(1 \u0000Cλr2).\n根据 Markov不等式 ,\nP(µ(B)>Cr2−δ)\u00141\n1\u0000Cλr2e−Cλr2−δ.\n取Cλr2= 1/2 ,可得\nP(µ(B)>Cr2−δ)\u00142e−r−δ/2.\n接下来 ,将上述估计应用到直径 1/n的小球上 ,并利用次可加性 ,可以得到\nP(9i= 1,2,...,K (n),µ(Bi)>C(1/2n)2−δ)\u00142K(n)e−(1/2n)−δ/2.\n用Bn记小球B1,B2,...,B K(n)构成的集合 .令B=[n≥1Bn.那么 ,利用\nBorel-Cantelli 引理 ,下列集合的个数有限\nfB2 B:µ(B)>C(diam (B)/2)2−δg,\n其中 , diam (B)是小球B的直径 .所以 ,存在C < +1,使得8B2 B ,我们\n有\nµ(B)\u0014Cr2−δ.\n进而 ,合理利用小球的包含关系 ,可以证明 (8.3 ).\n第 8.9节 带漂移的布朗运动\n假设 (Bt)t≥0是一个从x出发的d维布朗运动 ,其方差参数为 σ2.令\nµ2Rd,且令\nYt=Bt+tµ.\n那么 ,我们称 (Yt)t≥0是从x出发的具有漂移参数 µ和方差参数 σ2的d维\n布朗运动 .容易验证 ,(Yt)t≥0满足如下条件 :132 第八章 布朗运动\n1.Y0=x;\n2.若s1\u0014t1\u0014s2\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014sn\u0014tn,那么 ,Yt1\u0000Ys1,Yt2\u0000Ys2,...,Y tn\u0000\nYsn是相互独立的 ;\n3.对于 0\u0014s<t ,我们有Yt\u0000Ys服从正态分布 N((t\u0000s)µ,(t\u0000s)σ2Id);\n4.Yt是t的连续函数 .\nYt的运动由µ方向的直线运动叠加上随机的波动构成 .可以注意到 E(Yt) =\ntµ.容易得到转移密度函数\npt(x,y) =P(Yt2(y,y+dy)jY0=x)/dy\n=1\n(2πσ2t)d/2e−|y−x−tµ|2/2σ2.\n可以发现此转移密度满足 Kolmogorov-Chapman 方程 :\npt+s(x,y) =Z\npt(x,z)ps(z,y)dz.\n对于Rd上一个可积的函数 f(y),我们定义\nf(t,x) =Ex(f(Yt)).\n可以发现 ,f(t,x)满足微分方程\n∂f\n∂t=dX\ni=1µi∂f\n∂xi+σ2\n2∆f.第九章 离散鞅\n第 9.1节", "关系 ,可以证明 (8.3 ).\n第 8.9节 带漂移的布朗运动\n假设 (Bt)t≥0是一个从x出发的d维布朗运动 ,其方差参数为 σ2.令\nµ2Rd,且令\nYt=Bt+tµ.\n那么 ,我们称 (Yt)t≥0是从x出发的具有漂移参数 µ和方差参数 σ2的d维\n布朗运动 .容易验证 ,(Yt)t≥0满足如下条件 :132 第八章 布朗运动\n1.Y0=x;\n2.若s1\u0014t1\u0014s2\u0014t2\u0014 \u0001 \u0001 \u0001 \u0014sn\u0014tn,那么 ,Yt1\u0000Ys1,Yt2\u0000Ys2,...,Y tn\u0000\nYsn是相互独立的 ;\n3.对于 0\u0014s<t ,我们有Yt\u0000Ys服从正态分布 N((t\u0000s)µ,(t\u0000s)σ2Id);\n4.Yt是t的连续函数 .\nYt的运动由µ方向的直线运动叠加上随机的波动构成 .可以注意到 E(Yt) =\ntµ.容易得到转移密度函数\npt(x,y) =P(Yt2(y,y+dy)jY0=x)/dy\n=1\n(2πσ2t)d/2e−|y−x−tµ|2/2σ2.\n可以发现此转移密度满足 Kolmogorov-Chapman 方程 :\npt+s(x,y) =Z\npt(x,z)ps(z,y)dz.\n对于Rd上一个可积的函数 f(y),我们定义\nf(t,x) =Ex(f(Yt)).\n可以发现 ,f(t,x)满足微分方程\n∂f\n∂t=dX\ni=1µi∂f\n∂xi+σ2\n2∆f.第九章 离散鞅\n第 9.1节 条件期望\n在本节中 ,我们回顾条件期望的一般定义和常用性质 .本节的大部分结\n果都可以在书 [Dur19 ]的第 4.1节找到 .\n定义 9.1.1.假设EjXj<+1.假设G是一个子事件域 .那么 ,条件期望\nE(XjG)被定义成一个满足下列条件的 G-可测的随机变量 Y:8A2 G\nE(X1A) =E(Y1A),\n其中 ,1A是事件A的示性函数 .\n注 9.1.1.条件期望是几乎处处唯一的 ,即若Y1和Y2都满足条件期望的定\n义,那么 ,P(Y1=Y2) = 1 .\n注 9.1.2.条件期望具有单调性 .如果P(X\u0014Y) = 1 ,那么 ,\nP(E(XjG)\u0014E(YjG)) = 1.\n命题 9.1.3.条件期望具有线性性质 .更一般的 ,假设Z关于G-可测并且\nEjZXj<+1,那么 ,\nE(ZX+YjG) =ZE(XjG) +E(YjG).\n定义 9.1.2.假设X\u00150.假设G是一个子事件域 .那么 ,定义条件期望\nE(XjG) = lim\nn→∞E(min(X,n)jG)\n注 9.1.4.根据条件期望的单调性 ,8n\u00151,\nP(E(min(X,n + 1)jG)\u0015E(min(X,n)jG)) = 1.\n133134 第九章 离散鞅\n由此不难发现 ,\nP(n7!E(min(X,n)jG)单调不降 ) = 1.\n所以 ,E(XjG)≜ limn→∞E(min(X,n)jG)良好定义 .注意对于A2 G ,我们\n有\nE(E(XjG)1A) =E(lim\nn→∞E(min(X,n)jG)1A)\n单调收敛定理= lim\nn→∞E(E(min(X,n)jG)1A)\n= lim\nn→∞E(min(X,n)1A)\n单调收敛定理=E(X1A).\n另外 ,定义 9.1.2中的条件期望 E(XjG)是关于 G可测的随机变量 .所以 ,对\n于非负的随机变量 X,其条件期望 E(XjG)也满足定义 9.1.1 .并且容易验\n证满足定义 9.1.1的非负随机变量的条件期望是几乎处处唯一的 .\n命题 9.1.5.条件期望具有单调性 .如果P(X\u0014Y) = 1 ,那么 ,\nP(E(XjG)\u0014E(YjG)) = 1.\n注 9.1.6.如果X本身是 G-可测的随机变量 ,那么 ,E(XjG) =X.\n命题 9.1.7.如果X独立于 G,那么 ,\nE(XjG) =E(X).\n命题 9.1.8.根据条件期望的定义 ,我们有重期望公式 :\nE(E(XjG)) =E(X).\n更一般的 ,假设X,Z\u00150或者假设Z是G可测的随机变量 ,并且EjXj<\n+1,EjZXj<+1,那么 ,\nE(ZE(XjG)) =E(ZX).\n命题 9.1.9.考虑两个有包含关系的子事件域 G \u001a H .那么 ,\nE(E(XjG)jH) =E(XjG),\nE(E(XjH)jG) =E(XjG).第 9.1节 条件期望 135\n定理 9.1.10 (条件 Jensen不等式 ).假设φ(x)是一个凸函数 ,并且EjXj<\n+1.那么 ,我们有\nE(φ(X)jG)\u0015φ(E(XjG)).\n命题 9.1.11.特别的 ,如果X是Lp(p\u00151)可积的随机变量 ,那么 ,\njE(XjG)jp\u0014E(jXjpjG).\n那么 ,EjE(XjG)jp\u0014EjXjp<+1,所以 ,条件期望E(XjG)也是Lp可积\n的随机变量 .并且 ,从X到E(XjG)的映射是一个 Lp空间上的压缩映射 .\n命题 9.1.12.假设概率空间上的事件域为 F.假设X2L2(F),即X是平\n方可积的 F可测随机变量 .那么 ,X\u0000E(XjG)和L2(G)关于L2(F)上的\n内积\nhU,Vi=E(UV)\n垂直 .等价的 ,E(XjG)是X向闭子空间 L2(G)上的正交投影 .\n定理 9.1.13 (条件期望版本的单调收敛定理 ).假设非负的随机变量序列\n(Xn)n≥1单调不降的收敛到 X.那么 ,以概率 1,E(XnjG)单调不降的收敛\n到E(XjG).\n证明提示 .利用期望的单调收敛定理 .\n定理 9.1.14 (条件期望版本的 F atou引理 ).假设 (Xn)n≥1是非负的随机变\n量序列 .那么 ,我们有\nE(lim inf\nn→∞XnjG)\u0014 lim inf\nn→∞E(XnjG).\n证明提示 .利用条件", "期望 135\n定理 9.1.10 (条件 Jensen不等式 ).假设φ(x)是一个凸函数 ,并且EjXj<\n+1.那么 ,我们有\nE(φ(X)jG)\u0015φ(E(XjG)).\n命题 9.1.11.特别的 ,如果X是Lp(p\u00151)可积的随机变量 ,那么 ,\njE(XjG)jp\u0014E(jXjpjG).\n那么 ,EjE(XjG)jp\u0014EjXjp<+1,所以 ,条件期望E(XjG)也是Lp可积\n的随机变量 .并且 ,从X到E(XjG)的映射是一个 Lp空间上的压缩映射 .\n命题 9.1.12.假设概率空间上的事件域为 F.假设X2L2(F),即X是平\n方可积的 F可测随机变量 .那么 ,X\u0000E(XjG)和L2(G)关于L2(F)上的\n内积\nhU,Vi=E(UV)\n垂直 .等价的 ,E(XjG)是X向闭子空间 L2(G)上的正交投影 .\n定理 9.1.13 (条件期望版本的单调收敛定理 ).假设非负的随机变量序列\n(Xn)n≥1单调不降的收敛到 X.那么 ,以概率 1,E(XnjG)单调不降的收敛\n到E(XjG).\n证明提示 .利用期望的单调收敛定理 .\n定理 9.1.14 (条件期望版本的 F atou引理 ).假设 (Xn)n≥1是非负的随机变\n量序列 .那么 ,我们有\nE(lim inf\nn→∞XnjG)\u0014 lim inf\nn→∞E(XnjG).\n证明提示 .利用条件期望版本的单调收敛定理 .\n定理 9.1.15 (条件期望版本的控制收敛定理 ).假设存在可积的随机变量 Y\n使得8n\u00151,jXnj \u0014Y.假设Xn几乎处处的收敛到 X,那么 ,E(XnjG)也\n几乎处处的收敛到 E(XjG).\n证明提示 .利用条件期望版本的 F atou引理 .\n定义 9.1.3.对于 (广义取值的 )随机变量Y,条件期望E(XjY)被定义成\nE(Xjσ(Y)),其中 ,σ(Y)是由Y生成的事件域 .\n注 9.1.16.通过在上述定义中取 Y= (Yα)α∈A,我们定义了条件期望\nE(XjYα,α2A).136 第九章 离散鞅\n第 9.2节 定义和举例\n给定一列递增的事件域 (Fn)n≥0,我们称之为域流 .\n定义 9.2.1.如果随机变量序列 (Mn)n≥0满足下列条件 ,我们就称其为 鞅:\n1.8n\u00150,Mn是关于 Fn可测的 .\n2.8n\u00150,EjMnj<+1.\n3.8n\u00150,E(Mn+1jFn) =Mn.\n命题 9.2.1.假设Mn是鞅 ,那么 ,对于m\u0015n,我们有\nE(MmjFn) =Mn.\n例 9.1.假设 (Xn)n≥1是独立同分布的随机变量 ,均值都为µ.令Fn=\nσ(Xm,m\u0014n).令S0= 0 .对于n\u00151,定义Sn=X1+X2+\u0001 \u0001 \u0001+Xn\u0000nµ .\n那么 ,(Sn)n≥0是一个鞅 .\n例 9.2.假设对于n\u00151,Xn可积 ,关于Fn可测 ,并且\n8n\u00150,E(Xn+1jFn) = 0.\n定义S0= 0 .对于n\u00151,定义Sn=X1+X2+\u0001 \u0001 \u0001+Xn.那么 ,(Sn)n≥0是\n鞅.假设对于n\u00151,Bn关于Fn−1可测 .我们定义W0= 0 .对于n\u00151,定\n义\nWn=nX\nj=1BjXj.\n那么 ,(Wn)n≥0也是一个鞅 ,被称为可料过程 B关于鞅S的离散随机积分 .\n例 9.3 (Polya坛子 ).考虑一个装有红蓝两种颜色小球的坛子 .刚开始的时\n候有红色小球 a个,蓝色小球b个.每次从坛子中抽取一个小球 ,观察其颜\n色后放回 ,并额外放入同颜色的球 c只.如此反复 .用Xn表示第n次操作\n后,坛子中的红球数量 .那么 ,由于n次操作后 ,球的总数是 a+b+cn,所\n以,红球所占比例为 Mn=Xn\na+b+cn.令Fn=σ(Xm,m\u0014n),n\u00150.那么 ,\nMn是一个鞅 .\n例 9.4.给定域流 Fn和一个可积的随机变量 M ,定义Mn=E(MjFn).那\n么,(Mn)n≥0是一个鞅 ,称为可闭鞅 .第 9.3节 可选停时定理 137\n第 9.3节 可选停时定理\n让我们回顾停时的定义 :给定域流 Fn,其上的停时指的是一个取值在\nN[ f+1g上的随机变量 ,满足\n8n\u00150,fT\u0014ng 2 F n.\n例 9.5.设n为非负整数 .而T\u0011n.那么 ,T是个停时 .\n例 9.6.设A为某个集合 .而T=TA= inffn\u00150 :Xn2Ag.这里 ,Xn关\n于Fn可测 .那么 ,T是个停时 .\n例 9.7.如果T和U都是停时 ,那么 , min (T,U)是停时 , max (T,U)也是停\n时.特别的 ,令Tn= min(T,n).那么 ,T0\u0014T1\u0014T2\u0014 \u0001 \u0001 \u0001 ,并且任何Tn都\n是停时 .\n注 9.3.1.如果 (Mn)n≥0是鞅 ,T是停时 ,那么 ,Nn=M min(n,T)也是鞅 .\n命题 9.3.2.设(Mn)n≥0是鞅 ,T是停时 .假设T有界 ,即存在确定的 K\n满足T\u0014K.那么 ,\nE(MT) =E(M0).\n对于停时T,回顾FT的定义 :\nFT=fA2 F :8n\u00150,A\\ fT\u0014ng 2 F ng.\n推论 9.3.3.设(Mn)n≥0是鞅 ,T是停时 .假设有非负整数 K,使得T\u0014K.\n那么 ,\nMT=E(MKjFT).\n定理 9.3.4 (可选停时定理 ).设(Mn)n≥0是鞅 ,T是停时 .假设\nP(T < +1) = 1,\nE(jMTj)<+1\n且\nlim\nn→∞E(jMnjIfT >n g) = 0. (9.1)\n那么 ,E(MT) =E(M0).\n注 9.3.5.如果鞅 (Mn)n≥0有界 ,那么 ,一定满足可", "�机变量 ,满足\n8n\u00150,fT\u0014ng 2 F n.\n例 9.5.设n为非负整数 .而T\u0011n.那么 ,T是个停时 .\n例 9.6.设A为某个集合 .而T=TA= inffn\u00150 :Xn2Ag.这里 ,Xn关\n于Fn可测 .那么 ,T是个停时 .\n例 9.7.如果T和U都是停时 ,那么 , min (T,U)是停时 , max (T,U)也是停\n时.特别的 ,令Tn= min(T,n).那么 ,T0\u0014T1\u0014T2\u0014 \u0001 \u0001 \u0001 ,并且任何Tn都\n是停时 .\n注 9.3.1.如果 (Mn)n≥0是鞅 ,T是停时 ,那么 ,Nn=M min(n,T)也是鞅 .\n命题 9.3.2.设(Mn)n≥0是鞅 ,T是停时 .假设T有界 ,即存在确定的 K\n满足T\u0014K.那么 ,\nE(MT) =E(M0).\n对于停时T,回顾FT的定义 :\nFT=fA2 F :8n\u00150,A\\ fT\u0014ng 2 F ng.\n推论 9.3.3.设(Mn)n≥0是鞅 ,T是停时 .假设有非负整数 K,使得T\u0014K.\n那么 ,\nMT=E(MKjFT).\n定理 9.3.4 (可选停时定理 ).设(Mn)n≥0是鞅 ,T是停时 .假设\nP(T < +1) = 1,\nE(jMTj)<+1\n且\nlim\nn→∞E(jMnjIfT >n g) = 0. (9.1)\n那么 ,E(MT) =E(M0).\n注 9.3.5.如果鞅 (Mn)n≥0有界 ,那么 ,一定满足可选停时定理 .138 第九章 离散鞅\n例 9.8.设p(x,y)是有限状态空间 S上不可约马氏链 (Xn)n≥0的转移概率 .\n设A是S的某个子集 ,并设φ是定义在A上的实值函数 .则存在唯一的函\n数f满足\nf(x) =φ(x),x2A,\nX\ny∈Sp(x,y)f(y) =f(x),x2SnA.\n简言之 ,f和φ在A上相同 ,f在A之外是调和的 .记\nT= minfn\u00150 :Xn2Ag.\n令Mn=f(X min(n,T)),则Mn是一个有界鞅 .因此 ,\nf(x) =E(M0jX0=x) =E(MTjX0=x) =E(f(XT)jX0=x).\n特别的 ,这可以应用在赌徒输光问题的概率计算上 .\n例 9.9.设Xn是整数 Z上的简单随机游动 .那么 ,Xn是一个鞅 .令\nT= minfn\u00150 :Xn= 1g.那么 ,利用一维随机游走的常返性 ,我们有\nP(T < +1) = 1 .但是 ,\n1 =E(XT)6=E(X0) = 0.\n所以 ,可选停时定理并不适用 .\n第 9.4节 一致可积\n在可选停时定理中的条件 (9.1 )往往很难验证 .我们给出 (Mn)n≥0的一\n致可积性条件 ,它可以保证条件 (9.1 )成立 .\n定义 9.4.1.一族随机变量 (Xα)α∈A被称为是 一致可积的 (uniformly inte-\ngrable),若对任意的 ε>0,存在K < +1,使得\nsup\nα∈AE(jXαjIfjXαj>Kg)<ε.\n注 9.4.1.如果 (Xα)α∈A一致可积 ,那么 ,对任意ε >0,存在δ >0,只要\nP(A)<δ ,就有\nE(jXαj1A)<ε,\n其中 ,1A是事件A的示性函数 .第 9.4节 一致可积 139\n一致可积的条件很难验证 ,我们这里给出两个包含一致可积性的条件 :\n命题 9.4.2.对于一族随机变量 (Xα)α∈A,若 supα∈A(jXαjp)<+1,其中 ,\np>1是某个常数 ,那么 ,(Xα)α∈A是一致可积的 .\n命题 9.4.3.假设θ是一个可积的随机变量 ,而(Fα)α∈A是一族事件域 .定\n义\nθα=E(θjFα).\n那么 ,(θα)α∈A一致可积 .\n在一致可积的条件下 ,依概率收敛可以推出 L1收敛 :\n命题 9.4.4.假设随机变量序列 (Xn)n≥0一致可积 .假设当n! 1时,Xn\n依概率收敛到 X.那么 ,在L1空间里 ,\nXnn→∞!X.\n接下来 ,我们用一致可积性替换条件 (9.1 ),得到如下形式的可选停时定\n理:\n定理 9.4.5.设(Mn)n≥0是鞅 ,T是停时 .假设\nP(T < +1) = 1,\nEjMTj<+1,\n并且 ,鞅(Mn)n≥0一致可积 .那么 ,\nE(MT) =E(M0).\n例 9.10 (分支过程 ).令Xn为分支过程中第 n代的个体数 .假设X0= 1 .\n假设每个个体产生的后代数的期望为 µ < +1,方差为σ2<+1.那么 ,\nMn=µ−nXn是一个鞅 .假设µ>1.可以计算出\nE(X2\nn+1jFn) =µ2X2\nn+σ2Xn.\n所以 ,8n\u00150,\nE(M2\nn) = 1 +1\u0000µ−n\n1\u0000µ\u0012σ\nµ\u00132\n\u00141 +1\n1\u0000µ\u0012σ\nµ\u00132\n.\n因为E(M2\nn)有界 ,所以 ,(Mn)n≥0一致可积 .140 第九章 离散鞅\n第 9.5节 鞅收敛定理\n鞅收敛定理保证在一般的条件下 ,鞅Mn会几乎处处的收敛到一个极限\n随机变量M∞.\n定理 9.5.1 (鞅收敛定理 ).设(Mn)n≥0是鞅 .并且\nsup\nnE(jMnj)<+1.\n那么 ,存在随机变量 M∞,使得以概率 1地,\nlim\nn→∞Mn=M∞.\n注 9.5.2.如果 (Mn)n≥0是非负鞅 ,那么 ,\nE(jMnj) =E(Mn) =E(M0)<+1,\n鞅收敛定理的条件自动满足 .所以 ,非负鞅必然几乎处处收敛 .\n虽然鞅收敛定理导致 Mn几乎处处的收敛到 M∞,但是这并不足以保证\nE(Mn)收敛到E(M∞).为了进一步保证期望的收敛性 ,通常我们要加上一\n", " ).令Xn为分支过程中第 n代的个体数 .假设X0= 1 .\n假设每个个体产生的后代数的期望为 µ < +1,方差为σ2<+1.那么 ,\nMn=µ−nXn是一个鞅 .假设µ>1.可以计算出\nE(X2\nn+1jFn) =µ2X2\nn+σ2Xn.\n所以 ,8n\u00150,\nE(M2\nn) = 1 +1\u0000µ−n\n1\u0000µ\u0012σ\nµ\u00132\n\u00141 +1\n1\u0000µ\u0012σ\nµ\u00132\n.\n因为E(M2\nn)有界 ,所以 ,(Mn)n≥0一致可积 .140 第九章 离散鞅\n第 9.5节 鞅收敛定理\n鞅收敛定理保证在一般的条件下 ,鞅Mn会几乎处处的收敛到一个极限\n随机变量M∞.\n定理 9.5.1 (鞅收敛定理 ).设(Mn)n≥0是鞅 .并且\nsup\nnE(jMnj)<+1.\n那么 ,存在随机变量 M∞,使得以概率 1地,\nlim\nn→∞Mn=M∞.\n注 9.5.2.如果 (Mn)n≥0是非负鞅 ,那么 ,\nE(jMnj) =E(Mn) =E(M0)<+1,\n鞅收敛定理的条件自动满足 .所以 ,非负鞅必然几乎处处收敛 .\n虽然鞅收敛定理导致 Mn几乎处处的收敛到 M∞,但是这并不足以保证\nE(Mn)收敛到E(M∞).为了进一步保证期望的收敛性 ,通常我们要加上一\n致可积性条件 .\n定理 9.5.3.设(Mn)n≥0是一致可积鞅 .那么 ,\nM∞= lim\nn→∞Mn,\n并且 ,E(M∞) =E(M0).\n接下来 ,对于一致可积鞅 (Mn)n≥0,我们考虑可能取 +1的停时T,进\n一步推广定理 9.4.5 .为此 ,我们定义随机变量 MT:\nMT(ω) =MT(ω)(ω)\u00011T<+∞+M∞\u00011T=+∞.\n定理 9.5.4 (可选停时定理 ).假设 (Mn)n≥0是一致可积鞅 ,T是停时 .那么 ,\nE(MT) =E(M0).\n推论 9.5.5.假设 (Mn)n≥0是一致可积鞅 ,T是停时 .那么 ,\nMT=E(M∞jFT).第 9.5节 鞅收敛定理 141\n例 9.11 (分支过程 ).假设Xn是第n代的个体数 .假设µ>1且σ2<+1\n时,Mn=Xn/µn是一致可积鞅 .所以 ,根据定理 9.5.3 ,当n! 1时,Mn\n收敛到某个期望为 1的随机变量 M∞.下面假设µ\u00141,Mn=Xn/µn是非\n负鞅 ,根据注 9.5.2 ,Mn收敛到一个随机变量 M∞.根据分支过程的结果 ,当\nµ\u00141时,分支过程必然灭绝 ,所以 ,Mn=µ−nXn最终为 0,故收敛到 0.此\n时,E(M∞)6=E(M0) = 1 ,不满足定理 9.5.3 .特别的 ,我们知道在 µ\u00141时,\n(Mn)n≥0不是一致可积的 .\n例 9.12 (Polya坛子模型 ).考虑例 9.3中的 Polya坛子模型 .那里 ,Mn表示\n第n次操作后 ,坛子中的红球比例 .那么 ,(Mn)n≥0是有界鞅 .特别的 ,也是\n一致可积鞅 .所以 ,当n! 1时,Mn收敛到一个非负随机变量 M∞.并且 ,\n我们有\nE(M∞) =E(M0) =a\na+b.\n例 9.13.考虑一个可积的随机变量 θ.定义Mn=E(θjFn).那么 ,根据\n命题 9.4.3 ,Mn是一致可积鞅 .所以 ,根据定理 9.5.3 ,Mn几乎处处的收敛到\nM∞.定义F∞为包含每一个 Fn的最小的事件域 .那么 ,Mn一定是 F∞-可\n测的随机变量 .对于任意的 n\u00151和任意的A2 Fn,我们有\nE(M∞1A) = lim\nm→∞E(Mm1A)\n= lim\nm→∞E(E(θ1AjFm))\n=E(θ1A),\n其中 ,第一个等号用到 Mm1A一致可积的事实 .进而推知 ,更一般的 ,对于\n任意A2 F∞,我们有\nE(M∞1A) =E(θ1A).\n综上 ,M∞=E(θjF∞).特别的 ,如果θ关于F∞可测 ,那么 ,\nlim\nn→∞E(θjFn) =θ, a.s.. (9.2)\n由一致可积性 ,这个收敛也是 L1收敛的 .作为例子 ,考虑θ服从参数为\n(a/c,b/c)的 Beta分布 .给定θ,Y1,Y2,...独立 ,都服从参数为 (1,θ)的二\n项分布 ,即P(Y1= 1jθ) =θ,P(Y1= 0jθ) = 1 \u0000θ.令Fn=σ(Ym,m\u0014n).\n根据大数定律 ,\nY1+Y2+\u0001 \u0001 \u0001+Yn\nnn→∞!θ, a.s..142 第九章 离散鞅\n所以 ,θ关于F∞可测 .接下来 ,记Rn=Y1+Y2+\u0001 \u0001 \u0001+Yn,Bn=n\u0000Rn.\n那么 ,我们希望计算\nE(θjFn) =E(θjY1,Y2,...,Y n).\n给定y1,y2,...,y n2 f0,1g,其中 ,y1+y2+\u0001 \u0001 \u0001+yn=rn.那么 ,\nE(θjY1=y1,Y2=y2,...,Y n=yn)\n=E(θ1Y1=y1,Y2=y2,...,Y n=yn)\nP(Y1=y1,Y2=y2,...,Y n=yn)\n=E(θE(1Y1=y1,Y2=y2,...,Y n=ynjθ))\nE(P(Y1=y1,Y2=y2,...,Y n=ynjθ))\n=E(θrn+1(1\u0000θ)n−rn)/E(θrn(1\u0000θ)n−rn)\n=Γ(rn+a/c+ 1)Γ(n\u0000rn+b/c)\nΓ(n+a/c+b/c+ 1)/Γ(rn+a/c)Γ(n\u0000rn+b/c)\nΓ(n+a/c+b/c)\n=rn+a/c\nn+a/c+b/c\n=crn+a\ncn+a+b.\n所以 ,我们有\nE(θjFn) =cRn+a\ncn+a+b. (9.3)\n由(9.2 )和(9.3 ),我们有\ncRn+a\ncn+a+bn→∞!θ, a.s", "1收敛的 .作为例子 ,考虑θ服从参数为\n(a/c,b/c)的 Beta分布 .给定θ,Y1,Y2,...独立 ,都服从参数为 (1,θ)的二\n项分布 ,即P(Y1= 1jθ) =θ,P(Y1= 0jθ) = 1 \u0000θ.令Fn=σ(Ym,m\u0014n).\n根据大数定律 ,\nY1+Y2+\u0001 \u0001 \u0001+Yn\nnn→∞!θ, a.s..142 第九章 离散鞅\n所以 ,θ关于F∞可测 .接下来 ,记Rn=Y1+Y2+\u0001 \u0001 \u0001+Yn,Bn=n\u0000Rn.\n那么 ,我们希望计算\nE(θjFn) =E(θjY1,Y2,...,Y n).\n给定y1,y2,...,y n2 f0,1g,其中 ,y1+y2+\u0001 \u0001 \u0001+yn=rn.那么 ,\nE(θjY1=y1,Y2=y2,...,Y n=yn)\n=E(θ1Y1=y1,Y2=y2,...,Y n=yn)\nP(Y1=y1,Y2=y2,...,Y n=yn)\n=E(θE(1Y1=y1,Y2=y2,...,Y n=ynjθ))\nE(P(Y1=y1,Y2=y2,...,Y n=ynjθ))\n=E(θrn+1(1\u0000θ)n−rn)/E(θrn(1\u0000θ)n−rn)\n=Γ(rn+a/c+ 1)Γ(n\u0000rn+b/c)\nΓ(n+a/c+b/c+ 1)/Γ(rn+a/c)Γ(n\u0000rn+b/c)\nΓ(n+a/c+b/c)\n=rn+a/c\nn+a/c+b/c\n=crn+a\ncn+a+b.\n所以 ,我们有\nE(θjFn) =cRn+a\ncn+a+b. (9.3)\n由(9.2 )和(9.3 ),我们有\ncRn+a\ncn+a+bn→∞!θ, a.s.. (9.4)\n接下来 ,我们注意到对于 n\u00150,\nP(Yn+1= 1jY1,Y2,...,Y n)\n=E(P(Yn+1= 1jθ,Y 1,Y2,...,Y n)jY1,Y2,...,Y n)\n=E(θjY1,Y2,...,Y n)\n=cRn+a\ncn+a+b. (9.5)\n接下来 ,我们考虑 Polya坛子模型 ,参数为 (a,b,c ).即初始时有 a个红球 ,b\n个蓝球 ,每次额外放进去 c只球 .定义\nZn=(\n1第n次摸出的球是红色 ,\n0第n次摸出的球是蓝色 .第 9.6节 极大不等式 143\n类似的 ,我们定义RZ\nn=Z1+Z2+\u0001 \u0001 \u0001+Zn.那么 ,根据 Polya坛子模型的\n定义 ,我们有\nP(Zn+1= 1jZ1,Z2,...,Z n) =cRZ\nn+a\ncn+a+b. (9.6)\n对比 (9.5 )和(9.6 ),我们发现 (Zn)n≥1和(Yn)n≥1同分布 .再加上 (9.4 ),必然\n存在一个随机变量 θZ,使得\ncRZ\nn+a\ncn+a+bn→∞!θZ,a.s.,\n并且 ,θZ服从参数是 (a/c,b/c)的 Beta分布 .对于 Polya坛子模型 ,不难发\n现cRZ\nn+a\ncn+a+b=Mn,其中 ,Mn是n次摸球后坛子中红球的比例 .这样 ,我们找\n到了鞅 (Mn)n≥0收敛的极限随机变量 θZ及其分布 .而且 ,已知θZ,整个摸\n球过程由独立同分布的伯努利随机变量描述 .\n第 9.6节 极大不等式\n给定一列随机变量 (Mn)n≥0,定义极大过程 (maximum process) 为\nMn= max(M0,M 1,...,M n),M∗\nn= max(jM0j,jM1j,...,jMnj).\n极大不等式用关于 Mn的概率和期望控制关于 Mn和M∗\nn的概率和期望 .\n定理 9.6.1 (Doob极大不等式 ).设(Mn)n≥0是非负下鞅 ,则对任意的 a>0,\nP(Mn\u0015a)\u00141\naE(Mn).\n利用鞅可以构造非负下鞅 .实际上 ,在满足可积性的前提下 ,根据 Jensen\n不等式 ,鞅(Mn)n≥0的凸函数 (φ(Mn))n≥0是下鞅 .于是 ,对非负下鞅\n(jMnjr)n≥0和(ebMn)n≥0应用 Doob极大不等式 ,我们可以得到如下结论 :\n定理 9.6.2.设(Mn)n≥0是鞅 ,则对任意的 a,b> 0和r\u00151有\nP(M∗\nn\u0015a)\u00141\narE(jMnjr),\nP(Mn\u0015a)\u0014e−baE(ebMn).\n例 9.14.考虑独立的随机变量 (Xn)n≥1.假设对于任意的 n\u00151,EXn= 0 ,\nVarXn<+1.定义M0= 0 ,Mn=X1+X2+\u0001 \u0001 \u0001+Xn.那么 ,取r= 2 ,应\n用定理 9.6.2 ,可得 Kolmogorov 极大不等式 :\nP(max(jM1j,jM2j,...,jMnj)\u0015a)\u00141\na2Var(Mn).144 第九章 离散鞅\n例 9.15.令Sn=X1+X2+\u0001 \u0001 \u0001+Xn表示Z上的简单随机游动 ,且令\nb=a√n.由于Sn是鞅 ,因此可以得到\nP(max(S0,S1,...,S n)\u0015apn)\u0014e−a2E(eaSn/√n).\n而,我们有\nE(eaSn/√n) =E(ea(X1+X2+···+Xn)/√n)\n= (E(eaX1/√n))n=\u0000\ncosh(a/pn)\u0001n\u0014(ea2/(2n))n=ea2/2,\n这里 ,我们用到了不等式 coshx\u0014ex2/2.因此 ,我们有\nP(max(S0,S1,...,S n)\u0015apn)\u0014e−a2/2.\n第 9.7节 倒向鞅\n假设 (Fn)n≤0是域流 ,即对于任意 n\u00140,Fn−1\u001a F n.\n定义 9.7.1.考虑随机过程 (Xn)n≤0.对于任意n\u00140,Xn是关于 Fn可测\n的随机变量 .假设EjX0j<1.假设\nE(Xn+1jFn) =Xn,8n\u0014 \u00001.\n那么 ,我们称 (Xn)n≥0为倒向鞅 .\n注 9.7.1.根据 Jensen不等式 ,EjXnj=EjE(Xn+1jFn)j \u0014E(E(jXn+1j\f\f\fFn)) =\nEjXn+1j.又因为EjX0j<1,所以 ,8n\u00140,Xn2L1.\n注 9.7.2.倒向鞅可以视为以 (\u00001,0]\\Z为时间参数的鞅 .\n倒向鞅是可闭鞅 ,我们有\nXn=E(X0jFn),8n\u00140.\n特别的 ,倒向鞅", "鞅\n例 9.15.令Sn=X1+X2+\u0001 \u0001 \u0001+Xn表示Z上的简单随机游动 ,且令\nb=a√n.由于Sn是鞅 ,因此可以得到\nP(max(S0,S1,...,S n)\u0015apn)\u0014e−a2E(eaSn/√n).\n而,我们有\nE(eaSn/√n) =E(ea(X1+X2+···+Xn)/√n)\n= (E(eaX1/√n))n=\u0000\ncosh(a/pn)\u0001n\u0014(ea2/(2n))n=ea2/2,\n这里 ,我们用到了不等式 coshx\u0014ex2/2.因此 ,我们有\nP(max(S0,S1,...,S n)\u0015apn)\u0014e−a2/2.\n第 9.7节 倒向鞅\n假设 (Fn)n≤0是域流 ,即对于任意 n\u00140,Fn−1\u001a F n.\n定义 9.7.1.考虑随机过程 (Xn)n≤0.对于任意n\u00140,Xn是关于 Fn可测\n的随机变量 .假设EjX0j<1.假设\nE(Xn+1jFn) =Xn,8n\u0014 \u00001.\n那么 ,我们称 (Xn)n≥0为倒向鞅 .\n注 9.7.1.根据 Jensen不等式 ,EjXnj=EjE(Xn+1jFn)j \u0014E(E(jXn+1j\f\f\fFn)) =\nEjXn+1j.又因为EjX0j<1,所以 ,8n\u00140,Xn2L1.\n注 9.7.2.倒向鞅可以视为以 (\u00001,0]\\Z为时间参数的鞅 .\n倒向鞅是可闭鞅 ,我们有\nXn=E(X0jFn),8n\u00140.\n特别的 ,倒向鞅 (Fn)n≤0是一致可积的 .\n倒向鞅的收敛不需要额外条件 :\n定理 9.7.3.定义X−∞=E(X0jF−∞),其中 ,F−∞=\\n≤0Fn.那么 ,当\nn! \u00001时,在几乎必然和 L1收敛的意义下 ,Xn收敛到X−∞ .第 9.7节 倒向鞅 145\n注 9.7.4.如果X02Lp(p\u00151),那么 ,(jXnjp)n≥0一致可积 .利用上述几乎\n必然收敛的结论 ,可知当n! \u00001时,Xn在Lp意义下收敛到 X−∞ .\n上述定理说明 limn→−∞E(YjFn)对于可积随机变量 Y收敛 .回忆条件\n版本的控制收敛定理 :如果Yn几乎必然收敛到 Y,并且存在可积的控制随\n机变量Z,使得对于任意 n,P(jYnj \u0014Z) = 1 ,那么 ,我们有\nlim\nnE(YnjF) =E(YjF),\n其中 ,上述收敛在几乎必然收敛意义下成立 .前者是固定随机变量 ,而事件\n域收敛 ;后者是固定事件域 ,而随机变量收敛 .一个自然的问题是当随机变\n量和事件域都可以变化时 ,极限 limnE(YnjFn)是否存在 ?\n定理 9.7.5.假设当n! \u00001时,Yn几乎必然的收敛到 Y−∞ .假设存在\nZ\u00150,满足EZ < 1,并且对于任意 n\u00140,P(jYnj \u0014Z) = 1 .假设Fn随\n着n递减而单调下降 .令F−∞=\\n≤0Fn.那么 ,我们有如下的几乎必然收\n敛:\nlim\nn→−∞E(YnjFn) =E(Y−∞jF−∞).\n倒向鞅有很多应用 .例如 ,倒向鞅可以用于证明强大数定律 .146 第九章 离散鞅第十章 连续时间鞅\n第 10.1节 域流和过程\n我们首先引入连续时间域流的概念 :\n定义 10.1.1.假设 (Ft)t≥0是一族事件域 ,满足\n8s\u0014t,Fs\u001a F t.\n那么 ,我们称 (Ft)t≥0是域流 .我们补充定义\nF∞=σ([t≥0Ft).\n例 10.1.假设 (Bs)s≥0是标准的布朗运动 .定义Ft=σ(Xs,s\u0014t).那么 ,\n(Ft)t≥0构成一个域流 .更一般的 ,对于连续时间过程 (Xs)s≥0,定义Ft=\nσ(Xs,s\u0014t).那么 ,称(Ft)t≥0是由 (Xs)s≥0生成的自然域流 (canonical\nfiltration) .\n假设 (Ft)t≥0是域流 .我们定义其在 t\u00150处的右极限为\nFt+=\\s:s>tFs.\n容易发现 ,(Ft+)t≥0也是域流 .并且Ft\u001a F t+\u001a F t+δ,8t\u00150,δ> 0.\n定义 10.1.2.对于一个域流 (Ft)t≥0,如果8t\u00150,我们总有\nFt+=Ft,\n我们称域流 (Ft)t≥0是右连续的 .\n注意到域流 (Ft+)t≥0总是右连续的 .因此 ,从任何一个域流 (Ft)t≥0出\n发,我们总可以将其扩大到右连续的域流 (Ft+)t≥0.我们把这种操作称为 右\n连续化 .\n147148 第十章 连续时间鞅\n如果Ft不是完备的 ,那么 ,通过向其中添加所有的零概率事件的所有\n子集 ,可以得到完备的事件域 Ft以及完备的域流 (Ft)t≥0.我们把这种操作\n称为完备化 .\n通过右连续化和完备化 ,我们总可以得到一个右连续且完备的域流 .如\n果条件允许 ,我们总是这样做 ,并且默认假设遇到的域流都是右连续并且完\n备的 .这些条件在鞅论中扮演着重要的角色 .\n在上述准备后 ,我们有了域流的基本概念 .现在 ,我们引入适应过程和\n循序可测过程的概念 :\n定义 10.1.3.假设 (Ft)t≥0是一个域流 .对于过程 (Xt)t≥0,如果8t\u00150,Xt\n是关于 Ft可测的 ,我们称过程 (Xt)t≥0是适应的 (adapted) .\n定义 10.1.4. 假设 (Ft)t≥0是一个域流 .用B([0,t])表示 [0,t]上的 Borel-\nσ-域.如果对于任何 t\u00150,限制在 Ω\u0002[0,t]上的二元函数\n(ω,s)7!Xs(ω)\n关于Ft\u0002 B([0,t])是可测的 ,那么 ,我们称过程 (Xt)t≥0是循序可测的 (pro-\ngressively measurable) .\n循序可测过程", "总是右连续的 .因此 ,从任何一个域流 (Ft)t≥0出\n发,我们总可以将其扩大到右连续的域流 (Ft+)t≥0.我们把这种操作称为 右\n连续化 .\n147148 第十章 连续时间鞅\n如果Ft不是完备的 ,那么 ,通过向其中添加所有的零概率事件的所有\n子集 ,可以得到完备的事件域 Ft以及完备的域流 (Ft)t≥0.我们把这种操作\n称为完备化 .\n通过右连续化和完备化 ,我们总可以得到一个右连续且完备的域流 .如\n果条件允许 ,我们总是这样做 ,并且默认假设遇到的域流都是右连续并且完\n备的 .这些条件在鞅论中扮演着重要的角色 .\n在上述准备后 ,我们有了域流的基本概念 .现在 ,我们引入适应过程和\n循序可测过程的概念 :\n定义 10.1.3.假设 (Ft)t≥0是一个域流 .对于过程 (Xt)t≥0,如果8t\u00150,Xt\n是关于 Ft可测的 ,我们称过程 (Xt)t≥0是适应的 (adapted) .\n定义 10.1.4. 假设 (Ft)t≥0是一个域流 .用B([0,t])表示 [0,t]上的 Borel-\nσ-域.如果对于任何 t\u00150,限制在 Ω\u0002[0,t]上的二元函数\n(ω,s)7!Xs(ω)\n关于Ft\u0002 B([0,t])是可测的 ,那么 ,我们称过程 (Xt)t≥0是循序可测的 (pro-\ngressively measurable) .\n循序可测过程一定是适应的 .反之 ,若某个适应过程的轨道是右连续或\n者左连续的 ,那么 ,它也是循序可测的 .\n定理 10.1.1. 假设 (Xt)t≥0是在某个度量空间 (E, d)上取值的随机过程 .\n在(E, d)上赋予 Borel-σ-域.假设 (Xt)t≥0是适应的 ,并且轨道t7!Xt(ω)\n对几乎所有的 ω都是右连续的 .那么 ,(Xt)t≥0是循序可测的 .类似的结果\n对左连续适应过程也是成立的 .\n证明 .我们只对右连续的情形给出证明 .左连续的证明与之类似 .固定t >\n0.对于n\u00151,我们如下定义新的过程 (X(n)\ns)0≤s≤t:\nX(n)\ns(ω)def=Xt⌈ns/t⌉/n(ω),\n这里 ,dxe表示不小于 x的最小整数 .注意到tdns/te/n\u0015s并且\nlim\nn→∞tdns/te/n=s.\n利用s7!Xs(ω)的右连续性 ,我们有\nlim\nn→∞X(n)\ns(ω) =Xs(ω).第 10.2节 停时 149\n由于可测函数的极限仍然是可测函数 ,我们只需要证明 (ω,s)7!X(n)\ns(ω)是\n从(Ω\u0002[0,t],Ft\u0002 B([0,t])到(E,B(E))的可测函数 .而这是因为对于任何\n(E, d)中的 Borel可测集A,我们有\nf(ω,s) :X(n)\ns(ω)2A,s\u0014tg=f(ω,0) :X0(ω)2Ag\n[[\nk=1,2,...,nf(ω,s) :s/t2((k\u00001)/n,k/n],Xkt/n(ω)2Ag, (10.1)\n而根据 (Xt)t≥0的适应性 ,Xkt/n关于Ft可测 ,故(10.1 )右侧是关于 Ft\u0002\nB([0,t])可测的 .最后 ,我们只需要处理 t= 0的情形 .即证明 (ω,s)7!\nX(n)\ns(ω)是从 (Ω\u0002[0,0],F0\u0002 B([0,0])到(E,B(E))的可测函数 .而这时因\n为X0是关于 F0可测的随机变量 .\n最后 ,我们定义循序可测 σ-域.\n定义 10.1.5.对于 Ω\u0002[0,+1)的一个子集 A,如果其示性函数对应的随机\n过程\nXt(ω)def= 1A(ω,t),ω2Ω,t\u00150,\n是循序可测的 ,那么 ,我们称A是循序可测子集 .所有的循序可测子集构成\n一个σ-域,被称为循序可测 σ-域,记为P.\n子集A是循序可测的当且仅当 8t\u00150,A\\(Ω\u0002[0,t])是Ft\u0002 B([0,t])\n中的可测子集 .\n注 10.1.2. 一个随机过程 (Xt)t≥0是循序可测的当且仅当 Ω\u0002[0,+1)到\n(E, d)的二元函数\n(ω,t)7!Xt(ω)\n是从 (Ω\u0002[0,+1),P)到(E,B(E))的可测函数 .\n第 10.2节 停时\n在本节中 ,我们正式的定义关于一个域流 (Ft)t≥0的停时 .我们将总结\n停时的一般性质 .\n定义 10.2.1. 假设T: Ω![0,+1]是一个随机变量 .如果对于任何的\nt\u00150,(T\u0014t)2 Ft,那么 ,我们称T是个停时 (stopping time) .150 第十章 连续时间鞅\n定义 10.2.2.假设T是一个停时 .那么 ,定义T之前的历史生成的事件域\nFT:\nFT=fA2 F :8t\u00150,A\\ fT\u0014tg 2 F tg.\n可以验证 FT确实是个事件域 .\n回忆域流的右极限 (Ft+)t≥0.由于Ft\u001a F t+,所以 ,如果T关于域流\n(Ft)t≥0是停时 ,那么 ,对于域流 (Ft+)t≥0也是域流 .反之 ,不一定成立 .可\n以证明T是关于域流 (Ft+)t≥0的停时 ,当且仅当 8t\u00150,(T <t )2 F t.类\n似于FT,给定关于域流 (Ft+)t≥0的停时T,我们定义事件域\nFT+=fA2 F :8t\u00150,A\\ fT <tg 2 F tg.\n令Gt=Ft+.那么 ,可以验证\nFT+=GT.\n接下来 ,我们陈述一些关于停时及相应事件域的性质 :\n1.如果停时T恒等于确定性时刻 t,那么 ,FT=Ft,FT+=Ft+.\n2.停时T关于事件域 FT可测 .\n3.假设两个停时 S和T满足S\u0014T,那么 ,FS\u001a F T并且FS+\u001a F T+.\n4.假设S和T是两个停时 .那么 ,S^T,S_T也是停时 .并且FS∧T=\nFS\\ FT.除此以外 ,事件fS\u0014Tg和事件 f", "�性质 .\n定义 10.2.1. 假设T: Ω![0,+1]是一个随机变量 .如果对于任何的\nt\u00150,(T\u0014t)2 Ft,那么 ,我们称T是个停时 (stopping time) .150 第十章 连续时间鞅\n定义 10.2.2.假设T是一个停时 .那么 ,定义T之前的历史生成的事件域\nFT:\nFT=fA2 F :8t\u00150,A\\ fT\u0014tg 2 F tg.\n可以验证 FT确实是个事件域 .\n回忆域流的右极限 (Ft+)t≥0.由于Ft\u001a F t+,所以 ,如果T关于域流\n(Ft)t≥0是停时 ,那么 ,对于域流 (Ft+)t≥0也是域流 .反之 ,不一定成立 .可\n以证明T是关于域流 (Ft+)t≥0的停时 ,当且仅当 8t\u00150,(T <t )2 F t.类\n似于FT,给定关于域流 (Ft+)t≥0的停时T,我们定义事件域\nFT+=fA2 F :8t\u00150,A\\ fT <tg 2 F tg.\n令Gt=Ft+.那么 ,可以验证\nFT+=GT.\n接下来 ,我们陈述一些关于停时及相应事件域的性质 :\n1.如果停时T恒等于确定性时刻 t,那么 ,FT=Ft,FT+=Ft+.\n2.停时T关于事件域 FT可测 .\n3.假设两个停时 S和T满足S\u0014T,那么 ,FS\u001a F T并且FS+\u001a F T+.\n4.假设S和T是两个停时 .那么 ,S^T,S_T也是停时 .并且FS∧T=\nFS\\ FT.除此以外 ,事件fS\u0014Tg和事件 fS=Tg被包含于 FS∧T.\n5.假设T是停时而A2 F∞.定义\nTA(ω) =(\nT(ω), ω2A;\n+1, ω /2A.\n那么 ,A2 FT当且仅当TA是停时 .\n6.对于所有的停时 T,我们有 FT\u001a F T+.如果域流 (Ft)t≥0是右连续的 ,\n那么 ,FT=FT+.\n7.如果 (Sn)n是一列单调不降的停时 ,那么 ,S= limn→∞Sn也是停时 .\n8.如果 (Sn)n是一列单调不增的停时 ,那么 ,S= limn→∞Sn是关于域流\n(Ft+)t≥0的停时 ,并且\nFS+=\\\nnFSn+.第 10.2节 停时 151\n9.如果 (Sn)n是一列单调不增的停时 ,并且对所有 ω2Ω,(Sn(ω))n最终\n是常数列 ,那么 ,S= limn→∞Sn也是停时 ,并且\nFS=\\\nnFSn.\n10.假设T是个停时 .那么 ,定义在 fT < +1g上的在一般可测空间上取\n值的函数ω7!Y(ω)是关于 FT-可测的 ,当且仅当对于任意的 t\u00150,\nY在fT\u0014tg上的限制是 Ft-可测的 .\n定理 10.2.1.假设 (Xt)t≥0是在一般可测空间上取值的循序可测函数 .假设\nT是个停时 ,那么 ,定义在 fT < +1g上的函数ω7!XT(ω) :=XT(ω)(ω)\n是FT-可测的 .\n提示 .考虑映射ω7!(T(ω),ω)和映射 (s,ω)7!Xs(ω)的复合 .\n命题 10.2.2.假设T是个停时 .而S是个取值在 [0,+1]之上的 FT-可测\n的随机变量 .如果S\u0015T,那么 ,S也是个停时 .特别的 ,如果T是个停时 ,\n那么 ,\nTn=+∞X\nk=0k+ 1\n2n1k\n2n≤T<k+1\n2n+1 \u00011T=+∞,n= 0,1,2,...\n定义了一列下降到 T的停时 .\n定理 10.2.3.假设 (Xt)t≥0是在某个度量空间上取值的适应的随机过程 .\n(1)假设 (Xt)t≥0的轨道是右连续的 ,而O是E中的开集 .那么 ,\nTO= infft\u00150 :Xt2Og\n是关于域流 (Ft+)t≥0的停时 .\n(2)假设 (Xt)t≥0的轨道是连续的 ,而F是E中的闭集 .那么 ,\nTF= infft\u00150 :Xt2Fg\n是 (关于域流 (Ft)t≥0的)停时 .\n证明 . (1)由右连续性和 O是开集的性质 ,fTO< tg=f9s2[0,t)\\Q:\nXs2Og.152 第十章 连续时间鞅\n(2)由于F是闭集并且轨道连续 ,\nfTF\u0014tg=f9s2[0,t] :Xs2Fg\n=finffd(Xs,F) :s2[0,t]\\Qg= 0g.\n第 10.3节 连续时间鞅和下鞅\n我们假设本节中的过程都是实值的 .\n定义 10.3.1.假设 (Xt)t≥0是一个适应过程 ,并且8t\u00150,EjXtj<+1.\n1.如果对于任意的 0\u0014s < t ,E(XtjFs) =Xs,那么 ,我们称 (Xt)t≥0是\n鞅.\n2.如果对于任意的 0\u0014s < t ,E(XtjFs)\u0014Xs,那么 ,我们称 (Xt)t≥0是\n上鞅 .\n3.如果对于任意的 0\u0014s < t ,E(XtjFs)\u0015Xs,那么 ,我们称 (Xt)t≥0是\n下鞅 .\n(Xt)t≥0是上鞅当且仅当 (\u0000Xt)t≥0是下鞅 .因此 ,上鞅的理论与下鞅的\n理论完全对应 .接下来 ,我们只陈述关于下鞅的理论 .如果 (Xt)t≥0是鞅 ,那\n么,对于任意的 t\u00150,EXt=EX 0.如果 (Xt)t≥0是下鞅 ,那么 ,对于任意\n的s\u0014t,EXt\u0015EXs.\n例 10.2.假设Z是个可积的随机变量 .令Xt=E(ZjFt).那么 ,(Xt)t≥0是\n鞅,称为可闭鞅 .注意不是所有的鞅都是可闭鞅 .\n接下来 ,我们介绍几种鞅的重要例子 .\n例 10.3.假设 (Zt)t≥0是实值适应过程 ,并且对于 0\u0014s<t ,其增量Zt\u0000Zs\n与Fs独立 . (后者被我们称为关于 (Ft)t≥0的独立增量性质 .)例如 ,布朗运\n动(Bt)t≥0关于典范域流 (canonical filtration) 就满足这些性质 .\n1.如果8t\u00150,EjZtj<+1,那么 ,Xt=Zt\u0000", "如果对于任意的 0\u0014s < t ,E(XtjFs) =Xs,那么 ,我们称 (Xt)t≥0是\n鞅.\n2.如果对于任意的 0\u0014s < t ,E(XtjFs)\u0014Xs,那么 ,我们称 (Xt)t≥0是\n上鞅 .\n3.如果对于任意的 0\u0014s < t ,E(XtjFs)\u0015Xs,那么 ,我们称 (Xt)t≥0是\n下鞅 .\n(Xt)t≥0是上鞅当且仅当 (\u0000Xt)t≥0是下鞅 .因此 ,上鞅的理论与下鞅的\n理论完全对应 .接下来 ,我们只陈述关于下鞅的理论 .如果 (Xt)t≥0是鞅 ,那\n么,对于任意的 t\u00150,EXt=EX 0.如果 (Xt)t≥0是下鞅 ,那么 ,对于任意\n的s\u0014t,EXt\u0015EXs.\n例 10.2.假设Z是个可积的随机变量 .令Xt=E(ZjFt).那么 ,(Xt)t≥0是\n鞅,称为可闭鞅 .注意不是所有的鞅都是可闭鞅 .\n接下来 ,我们介绍几种鞅的重要例子 .\n例 10.3.假设 (Zt)t≥0是实值适应过程 ,并且对于 0\u0014s<t ,其增量Zt\u0000Zs\n与Fs独立 . (后者被我们称为关于 (Ft)t≥0的独立增量性质 .)例如 ,布朗运\n动(Bt)t≥0关于典范域流 (canonical filtration) 就满足这些性质 .\n1.如果8t\u00150,EjZtj<+1,那么 ,Xt=Zt\u0000E(Zt)是鞅 ;\n2.进一步的 ,如果8t\u00150,EjZtj2<+1,那么 ,Yt=X2\nt\u0000E(X2\nt)是鞅 .第 10.3节 连续时间鞅和下鞅 153\n3.如果对于某个 θ2R,8t\u00150,EeθZt<+1,那么 ,Wt=eθZt/E(eθZt)\n是鞅 .\n定义 10.3.2. 假设 (Bt)t≥0是个布朗运动 .假设 (Bt)t≥0关于域流 (Ft)t≥0\n是适应并且独立增量的 .那么 ,我们称 (Bt)t≥0是个 (Ft)t≥0-布朗运动 .\n对于一个布朗运动 (Bt)t≥0,用(FB\nt)t≥0表示由其诱导的典范域流 ,那\n么,(Bt)t≥0是(FB\nt)t≥0-布朗运动 .对于 (Ft)t≥0-布朗运动 ,根据例 10.3 ,以下\n三个过程都是鞅 :\nBt,B2\nt\u0000t,eθBt−θ2\n2t.\n在第十二章中 ,我们将看到更多和布朗运动相关的鞅的例子 .\n有些时候 ,我们需要考虑鞅或者下鞅的函数 .利用 Jensen不等式 ,在一\n些自然的条件下 ,鞅或者下鞅的函数是下鞅 :\n命题 10.3.1. 假设 (Xt)t≥0是一个适应过程 .假设f:R!R是一个凸函\n数,并且8t\u00150,Ejf(Xt)j<+1.\n1.如果 (Xt)t≥0是鞅 ,那么 ,(f(Xt))t≥0是下鞅 .\n2.如果 (Xt)t≥0是下鞅 ,并且f单调不降 ,那么 ,(f(Xt))t≥0也是下鞅 .\n例 10.4.假设 (Xt)t≥0是鞅 ,那么 ,对于p\u00151,(jXtjp)t≥0是下鞅 .对于θ2\nR,(eθXt)t≥0是下鞅 .如果 (Xt)t≥0是下鞅 ,那么 ,对于a2R,(max(Xt,a))t≥0\n是下鞅 .\n我们接下来的目标是研究鞅和下鞅的轨道的正则性 .为此 ,我们先陈述\n一些离散鞅的经典不等式的连续对应 .\n定理 10.3.2 (Doob的极大不等式 ).假设 (Xt)t≥0是右连续的下鞅 .那么 ,\n对于任意的 t\u00150和λ>0,我们有\nλP(sup\n0≤s≤tXs\u0015λ)\u0014E(Xt1sup0≤s≤tXt≥λ)\u0014EX+\nt,\nλP(sup\n0≤s≤tjXsj \u0015λ)\u00143sup\n0≤s≤tEjXtj,\n其中 ,X+\nt= max(Xt,0).\n利用 Doob的极大不等式可以得到 Doob的Lp不等式 :154 第十章 连续时间鞅\n定理 10.3.3 (Doob的Lp不等式 ).假设 (Xt)t≥0是右连续的鞅 .对于任意\n的t\u00150和p>1,我们有\nE\u0014\nsup\n0≤s≤tjXsjp\u0015\n\u0014\u0012p\np\u00001\u0013p\nEjXtjp.\n利用所谓上穿不等式可以证明如下定理 :\n定理 10.3.4.假设域流 (Ft)t≥0是右连续而完备的 .假设 (Xt)t≥0是个下鞅 ,\n并且t7!EXt是右连续的 .那么 ,存在 (Xt)t≥0的一个修正 (Yt)t≥0使得\n1.8t\u00150,P(Xt=Yt) = 1 ;\n2.轨道t7!Yt是右连左极的 (càdlàg), 其中 , “右连左极 ”指的是右连续\n并且在每个 t>0处有左极限 ;\n3.对于域流 (Ft)t≥0,(Yt)t≥0仍然是个下鞅 .\n注 10.3.5. 在上述定理中 ,如果域流不是右连续的 ,或者t7!EXt不是右\n连续的 ,那么 ,我们都可以找到反例 .\n第 10.4节 鞅收敛定理\n仿照连续时间鞅 (Xt)t≥0和离散鞅 (Xn)n≥0的定义 ,我们可以定义一般\n的以T\u001aR为时间参数集的鞅 (Xt)t∈T:假设T是实数集 R的子集 ,而\n(Ft)t∈T是单调不降的域流 .这里 , “单调不降 ”指的是 8s,t2T,s\u0014t蕴\n含了Fs\u001a F t.而(Xt)t∈T是适应的随机过程 ,即,8t2T,Xt是Ft可测\n的.假设8t2T,EjXtj<+1.并且 ,对于所有的满足 s<t的T中的点对\n(s,t),我们有E(XtjFs) =Xs.那么 ,我们称 (Xt)t∈T是以T为指标集的鞅 .\n例如 ,如果 (", " :\n定理 10.3.4.假设域流 (Ft)t≥0是右连续而完备的 .假设 (Xt)t≥0是个下鞅 ,\n并且t7!EXt是右连续的 .那么 ,存在 (Xt)t≥0的一个修正 (Yt)t≥0使得\n1.8t\u00150,P(Xt=Yt) = 1 ;\n2.轨道t7!Yt是右连左极的 (càdlàg), 其中 , “右连左极 ”指的是右连续\n并且在每个 t>0处有左极限 ;\n3.对于域流 (Ft)t≥0,(Yt)t≥0仍然是个下鞅 .\n注 10.3.5. 在上述定理中 ,如果域流不是右连续的 ,或者t7!EXt不是右\n连续的 ,那么 ,我们都可以找到反例 .\n第 10.4节 鞅收敛定理\n仿照连续时间鞅 (Xt)t≥0和离散鞅 (Xn)n≥0的定义 ,我们可以定义一般\n的以T\u001aR为时间参数集的鞅 (Xt)t∈T:假设T是实数集 R的子集 ,而\n(Ft)t∈T是单调不降的域流 .这里 , “单调不降 ”指的是 8s,t2T,s\u0014t蕴\n含了Fs\u001a F t.而(Xt)t∈T是适应的随机过程 ,即,8t2T,Xt是Ft可测\n的.假设8t2T,EjXtj<+1.并且 ,对于所有的满足 s<t的T中的点对\n(s,t),我们有E(XtjFs) =Xs.那么 ,我们称 (Xt)t∈T是以T为指标集的鞅 .\n例如 ,如果 (Xt)t≥0是鞅 ,而T\u001a[0,+1),那么 ,(Xt)t∈T就是以T为指标\n集的鞅 .类似的 ,我们可以定义以 T为指标集的上 (下)鞅(Xt)t∈T.\n定理 10.4.1.假设T是实数的 可数子集 ,而(Xt)t∈T是以T为指标集的下\n鞅.假设\nsup\nt∈TEjXtj<+1.\n那么 ,存在一个零概率的例外集 A\u001aΩ,对于此例外集 A之外的所有样本\n点ω,对于T中任意的单调序列 (tn)n≥0,数列Xtn(ω)都收敛 .第 10.5节 可选停时定理 155\n注 10.4.2.条件 supt∈TEjXtj<+1被称为L1有界 .不难证明 ,一致可积\n蕴含L1有界 .\n定理 10.4.3. 假设 (Xt)t≥0是具有右连续轨道的下鞅 .假设 (Xt)t∈T满足\nL1有界条件 .那么 ,当t!+1时,Xt几乎必然的收敛到取有限值的极限\n随机变量X∞.\n证明 .取[0,+1)的可数稠密子集 T.根据定理 10.4.1 ,可以找到一个零概率\n集A.对ω2Ac,对于任意单调趋于无穷的 T中的序列 (tn)n≥0,Xtn(ω)都\n收敛 .由于这样的序列 (tn)n≥0是可以合并的 ,故所有序列极限相同 .故,我\n们可以记\nX∞(ω) = lim\nt∈T,t→+∞Xt(ω),ω2Ac.\n由于 (Xt)t≥0是右连续的 ,所以 ,条件t2T可以从极限号中去掉 .故,存在\n随机变量X∞,使得\nP(Xtt→+∞!X∞) = 1.\n最后 ,利用 F atou引理和L1有界性条件 ,\nEjX∞j=Elim inf\nt→+∞jXtj \u0014 lim inf\nt→+∞EjXtj<+1.\n所以 ,极限随机变量 X∞几乎必然有限 .\n第 10.5节 可选停时定理\n10.5.1 理论部分\n考虑轨道右连续的下鞅 (Xt)t≥0.假设X∞= limt→+∞Xt存在 . (例如 ,\n(Xt)t≥0一致可积时 ,X∞存在 .)对于停时T,我们定义随机变量 XT:\nXT(ω) =XT(ω)(ω)\u00011T<+∞+X∞(ω)1T=+∞.\n定理 10.5.1.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .那么 ,对于所有的停时 T,我们有\nEXT=EX 0.\n证明 .定义一列随机变量 (Tn)n≥0\nTn=+∞X\nk=0k+ 1\n2n1k\n2n≤T<k+1\n2n+1 \u00011T=+∞,n\u00150.156 第十章 连续时间鞅\n根据命题 10.2.2 ,(Tn)n≥0是一列下降到 T的停时 .由离散鞅的可选停时定\n理 (定理 9.5.4 ),我们有\nEXTn=EX 0,8n\u00150.\n利用轨道的右连续性质 ,XT= limn→∞XTn.由推论 9.5.5和命题 9.4.3 ,我们\n有(XTn)n≥0一致可积 .所以 ,当n!+1时,在L1空间里 ,XTn收敛于\nXT.因此 ,我们有\nEXT= lim\nn→+∞EXTn=EX 0.\n推论 10.5.2.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .那么 ,对于所有的停时 T,我们有\nXT=E(X∞jFT).\n证明 .在定理 10.5.1中取恒等于 +1的停时 ,可知EX∞=EX 0.于是对于\n所有停时T,有\nEXT=EX∞.\n固定A2 FT,定义新的停时 S:\nS=S(ω) =(\nT(ω), ω2A;\n+1, ω /2A.\n那么 ,我们有\nEXS=EX∞.\n注意到EXS=EXT1A+EX∞1Ac,EX∞=EX∞1A+EX∞1Ac.所以 ,我\n们有\nEXT1A=EX∞1A.\n因为上式对于任意的 A2 FT成立 ,所以 ,我们有\nXT=E(X∞jFT).\n推论 10.5.3.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .假设S和T是满足S\u0014T的两个停时 ,那么 ,\nXS=E(XTjFS).第 10.5节 可选停时定理 157\n证明 .由推论 10.5.2 ,我们有\nE(XTjFS) =E(E(X∞jFT)jFS) =E(X∞jFS) =XS.\n接", "用轨道的右连续性质 ,XT= limn→∞XTn.由推论 9.5.5和命题 9.4.3 ,我们\n有(XTn)n≥0一致可积 .所以 ,当n!+1时,在L1空间里 ,XTn收敛于\nXT.因此 ,我们有\nEXT= lim\nn→+∞EXTn=EX 0.\n推论 10.5.2.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .那么 ,对于所有的停时 T,我们有\nXT=E(X∞jFT).\n证明 .在定理 10.5.1中取恒等于 +1的停时 ,可知EX∞=EX 0.于是对于\n所有停时T,有\nEXT=EX∞.\n固定A2 FT,定义新的停时 S:\nS=S(ω) =(\nT(ω), ω2A;\n+1, ω /2A.\n那么 ,我们有\nEXS=EX∞.\n注意到EXS=EXT1A+EX∞1Ac,EX∞=EX∞1A+EX∞1Ac.所以 ,我\n们有\nEXT1A=EX∞1A.\n因为上式对于任意的 A2 FT成立 ,所以 ,我们有\nXT=E(X∞jFT).\n推论 10.5.3.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .假设S和T是满足S\u0014T的两个停时 ,那么 ,\nXS=E(XTjFS).第 10.5节 可选停时定理 157\n证明 .由推论 10.5.2 ,我们有\nE(XTjFS) =E(E(X∞jFT)jFS) =E(X∞jFS) =XS.\n接下来 ,我们把上述推论推广到没有大小关系的两个停时 S和T对应\n的情形 .\n推论 10.5.4.假设 (Xt)t≥0是一致可积鞅 .并且假设其轨道 t7!Xt是右连\n续的 .假设S和T是两个停时 ,那么 ,\nXS∧T=E(XTjFS).\n证明 .回忆fS\u0014Tg是FS∧T\u001a F S中的事件 .固定A2 F S.那么 ,我们有\nA\\fS\u0014tg 2 F t,fS\u0014Tg\\fT\u0014tg 2 F t.所以 ,对于任意的 t\u00150,我们有\nA\\ fS\u0014Tg \\ fS^T\u0014tg= (A\\ fS\u0014tg)\\(fS\u0014Tg \\ fS\u0014tg)2 Ft.\n所以 ,我们有\nA\\ fS\u0014Tg 2 F S∧T.\n注意到\nE(XT1A) =E(XT1A∩{S≤T}) +E(XT1A∩{T<S})\n=E(XT1A∩{S≤T}) +E(XS∧T1A∩{T<S}).\n而因为A\\ fS\u0014Tg 2 F S∧T,所以 ,\nE(XT1A∩{S≤T}) =E(E(XT1A∩{S≤T}jFS∧T)) =E(1A∩{S≤T}E(XTjFS∧T)).\n注意到停时 S^T不超过停时 T.故根据推论 10.5.3 ,我们有\nE(XTjFS∧T) =XS∧T.\n故,我们有\nE(XT1A∩{S≤T}) =E(XS∧T1A∩{S≤T}).\n于是 ,我们有\nE(XT1A) =E(XT1A∩{S≤T}) +E(XS∧T1A∩{T<S})\n=E(XS∧T1A∩{S≤T}) +E(XS∧T1A∩{T<S})\n=E(XS∧T1A).\n上述等式对任意的 A2 FS成立 .所以 ,我们有\nXS∧T=E(XTjFS).158 第十章 连续时间鞅\n推论 10.5.5.假设 (Xt)t≥0是具有右连续轨道的一致可积鞅 .而T是个停\n时.那么 ,(XT∧t)t≥0是具有右连续轨道的一致可积鞅 .\n证明 .由推论 10.5.4 ,我们知道\nXT∧t=E(XTjFt).\n因此 ,XT∧t是 (可闭 )鞅.另外 ,根据命题 9.4.3 ,(XT∧t)t≥0一致可积 .最后 ,\n由t7!Xt的右连续性 ,不难发现t7!XT∧t的右连续性 .\n推论 10.5.6.假设 (Xt)t≥0是具有右连续轨道的鞅 .而T是个停时 .那么 ,\n(XT∧t)t≥0是鞅 .\n证明 .我们只需要证明 8t\u00150,XT∧t可积 ,并且对于任意的 s\u0014t,\nE(XT∧tjFs) =XT∧s.\n取u\u0015t\u0015s.对于r\u00150,令Yr=Xr∧u.那么 ,由(Xt)t≥0是右连续鞅 ,可\n以验证 (Yr)r≥0是右连续鞅 ,并且Yr=E(XujFr).于是 ,(Yr)r≥0是右连续\n一致可积鞅 .由推论 10.5.5 ,我们知道 (YT∧r)r≥0是右连续的一致可积鞅 .于\n是,我们有\nYT∧s=E(YT∧tjFs).\n最后 ,注意到YT∧s=XT∧s,YT∧t=XT∧t即可 .\n10.5.2 应用\n可选停时定理是计算概率分布的强大工具 .我们给出几个重要而典型的\n应用 .\n假设 (Bt)t≥0是从 0出发的标准布朗运动 .那么 ,对于其诱导的典范域\n流,该标准布朗运动是连续鞅 .对于a2R,定义\nTa= infft\u00150 :Bt=ag.\n例 10.5.假设a<0<b .那么 ,我们有\nP(Ta<Tb) =b\nb\u0000a,P(Tb<Ta) =\u0000a\nb\u0000a.第 10.5节 可选停时定理 159\n证明 .令T=Ta^Tb.由于 (Bt)t≥0常返 ,故P(Ta<+1) =P(Tb<\n+1) = 1 .因此 ,P(T < +1= 1) .根据推论 10.5.6 ,由于Bt是鞅 ,所以 ,\n(BT∧t)t≥0也是鞅 .故,EBT∧t=EB 0= 0 .当t!+1时,BT∧t几乎\n必然地收敛到 BT.另外 ,由于T^t\u0014T,故,根据Ta,Tb和T的定义 ,\njBT∧tj \u0014(\u0000a)^b.所以 ,根据控制收敛定理 ,我们有EBT= 0 .根据布朗运\n动的连续性 ,当Ta<T b时,BT=BTa=a,当Tb<T a时,BT=BTb=b.\n故,EBT=E(BT1Ta<Tb) +E(BT1Tb<Ta) =a", "�鞅 .于\n是,我们有\nYT∧s=E(YT∧tjFs).\n最后 ,注意到YT∧s=XT∧s,YT∧t=XT∧t即可 .\n10.5.2 应用\n可选停时定理是计算概率分布的强大工具 .我们给出几个重要而典型的\n应用 .\n假设 (Bt)t≥0是从 0出发的标准布朗运动 .那么 ,对于其诱导的典范域\n流,该标准布朗运动是连续鞅 .对于a2R,定义\nTa= infft\u00150 :Bt=ag.\n例 10.5.假设a<0<b .那么 ,我们有\nP(Ta<Tb) =b\nb\u0000a,P(Tb<Ta) =\u0000a\nb\u0000a.第 10.5节 可选停时定理 159\n证明 .令T=Ta^Tb.由于 (Bt)t≥0常返 ,故P(Ta<+1) =P(Tb<\n+1) = 1 .因此 ,P(T < +1= 1) .根据推论 10.5.6 ,由于Bt是鞅 ,所以 ,\n(BT∧t)t≥0也是鞅 .故,EBT∧t=EB 0= 0 .当t!+1时,BT∧t几乎\n必然地收敛到 BT.另外 ,由于T^t\u0014T,故,根据Ta,Tb和T的定义 ,\njBT∧tj \u0014(\u0000a)^b.所以 ,根据控制收敛定理 ,我们有EBT= 0 .根据布朗运\n动的连续性 ,当Ta<T b时,BT=BTa=a,当Tb<T a时,BT=BTb=b.\n故,EBT=E(BT1Ta<Tb) +E(BT1Tb<Ta) =aP(Ta<Tb) +bP(Tb<Ta).依\n概率 1,Ta和Tb有限 ,且不相等 .所以 ,P(Ta<T b) +P(Tb<T a) = 1 .解\n得:\nP(Ta<Tb) =b\nb\u0000a,P(Tb<Ta) =\u0000a\nb\u0000a.\n例 10.6.对于a>0,定义Ua= infft\u00150 :jBtj=ag.那么 ,我们有\nEUa=a2.\n证明 .根据推论 10.5.6 ,由于B2\nt\u0000t是鞅 ,所以 ,B2\nUa∧t\u0000Ua^t也是鞅 .故,\nE(B2\nUa∧t\u0000Ua^t) =E(B2\n0\u00000) = 0 .于是 ,我们有\nE(Ua^t) =E(B2\nUa∧t).\n令t!+1.根据控制收敛定理 ,上式右端趋于 EB2\nUa=a2.而根据单调收\n敛定理 ,上式左端收敛于 EUa.故,我们有EUa=a2.\n例 10.7.假设a>0,那么 ,对于所有λ\u00150,\nEe−λTa=e−a√\n2λ.\n证明 .根据推论 10.5.6 ,由于e√\n2λBt−λt是鞅 ,所以 ,e√\n2λBTa∧t−λTa∧t也是鞅 .\n进而得到\nEe√\n2λBTa∧t−λTa∧t=e√\n2λB0−λ·0= 1.\n注意到BTa∧t\u0014a.因而 ,0\u0014e√\n2λBTa∧t−λBTa∧t\u0014e√\n2λa.令t!+1,由控\n制收敛定理 ,可得\n1 =Ee√\n2λBTa−λTa.\n再利用BTa=a,即可得到\nEe−λTa=e−a√\n2λ.160 第十章 连续时间鞅\n例 10.8.假设a>0.那么 ,对于所有λ\u00150,我们有\nEe−λUa=1\ncosh(ap\n2λ).\n证明 .根据推论 10.5.6 ,由于e√\n2λBt−λt是鞅 ,所以 ,e√\n2λBUa∧t−λUa∧t也是鞅 .\n利用例 10.7中的方法 ,可得\nEe√\n2λBUa−λUa= 1.\n根据布朗运动的对称性 ,BUa等可能的在 f\u0000a,ag中取值 ,并且 ,BUa独立于\nUa.故,我们有\n1 =Ee√\n2λBUa−λUa=Ee−λUaEe√\n2λBUa= 2 cosh(ap\n2λ)Ee−λUa.\n移项可得 :Ee−λUa=1\ncosh (a√\n2λ).第十一章 连续半鞅\n第 11.1节 有限变差过程\n11.1.1 有限变差函数\n定义 11.1.1.假设I\u001aR是个区间 .而f:I!R是定义在I上的实值函\n数.那么 ,f在I上的全变差 (total variation) TV(f)被定义为\nTV(f) = supfnX\ni=1jf(ti)\u0000f(ti−1)j: (ti)n\ni=0是I上单调递增的序列 g.\n如果TV(f)是有限的 ,那么 ,我们称函数 f在I上是有界变差函数 .\n命题 11.1.1 (Jordan) .函数f是有界变差的当且仅当 f可以写成两个有界\n单调不降函数 f+和f−的差 :f=f+\u0000f−.\n利用右连续单调不降函数与测度的对应关系 ,我们可以得到如下命题 :\n命题 11.1.2.假设函数a: [0,T]!R是右连续的 .那么 ,函数a是有界变\n差的当且仅当 a(t)\u0000a(0) =µ((0,t]),其中 ,µ是一个全变差有限的符号测\n度.\n因此 ,我们可以认为 da(t) =µ(dt).并且将 Lebesgue-Stieltjes 积分Rt\n0f(s)da(s)理解为可测函数关于负号测度的积分R\n(0,t]f(s)µ(ds).于是 ,利\n用控制收敛定理 ,我们可以得到如下引理 :\n引理 11.1.3.假设f: [0,T]!R是连续函数 .0 =tn\n0<tn\n1<\u0001 \u0001 \u0001<tn\npn=T\n是区间 [0,T]的划分 .划分出的小区间最大长度为 λ.那么 ,我们有\nZt\n0f(s)da(s) = lim\nλ→0nX\ni=1f(tn\ni−1)(a(tn\ni)\u0000a(tn\ni−1)).\n161162 第十一章 连续半鞅\n对于符号测度 µ,我们可以唯一的将其分解为支撑在两个不相交的\nBorel可测集上的两个测度 µ+和µ−的差 .我们定义\njµj=µ++µ−,\n并且记Zt\n0f(s)jda(s)j=Z\n(0,t]f(s)jµj(ds).\n如果C=RT\n0jf(s)jjda(s)j<+1,那么 ,g(t) =Rt\n0f(s)da(s)也是有界变差\n的,其全变差不超过 C.\n", "f−的差 :f=f+\u0000f−.\n利用右连续单调不降函数与测度的对应关系 ,我们可以得到如下命题 :\n命题 11.1.2.假设函数a: [0,T]!R是右连续的 .那么 ,函数a是有界变\n差的当且仅当 a(t)\u0000a(0) =µ((0,t]),其中 ,µ是一个全变差有限的符号测\n度.\n因此 ,我们可以认为 da(t) =µ(dt).并且将 Lebesgue-Stieltjes 积分Rt\n0f(s)da(s)理解为可测函数关于负号测度的积分R\n(0,t]f(s)µ(ds).于是 ,利\n用控制收敛定理 ,我们可以得到如下引理 :\n引理 11.1.3.假设f: [0,T]!R是连续函数 .0 =tn\n0<tn\n1<\u0001 \u0001 \u0001<tn\npn=T\n是区间 [0,T]的划分 .划分出的小区间最大长度为 λ.那么 ,我们有\nZt\n0f(s)da(s) = lim\nλ→0nX\ni=1f(tn\ni−1)(a(tn\ni)\u0000a(tn\ni−1)).\n161162 第十一章 连续半鞅\n对于符号测度 µ,我们可以唯一的将其分解为支撑在两个不相交的\nBorel可测集上的两个测度 µ+和µ−的差 .我们定义\njµj=µ++µ−,\n并且记Zt\n0f(s)jda(s)j=Z\n(0,t]f(s)jµj(ds).\n如果C=RT\n0jf(s)jjda(s)j<+1,那么 ,g(t) =Rt\n0f(s)da(s)也是有界变差\n的,其全变差不超过 C.\n定义 11.1.2. 如果a: [0,+1)!R在任何子区间 [0,T]都是有界变差的 ,\n我们称a是有限变差函数 .\n11.1.2 有限变差过程\n定义 11.1.3. 考虑一个适应的随机过程 (At)t≥0.如果该过程的轨道几乎\n必然是有限变差的 ,那么 ,我们称其为有限变差过程 .进一步的 ,我们假设\n(At)t≥0的轨道是右连左极的 .\n在本讲义中 ,我们总假设 (At)t≥0的轨道是连续的 .\n命题 11.1.4. 假设 (At)t≥0是有限变差过程 .假设 (Ht)t≥0是循序可测过\n程.假设8ω2Ω,8t\u00150,\nZt\n0jHs(ω)jjdAs(ω)j<+1.\n那么 ,我们如下定义一个过程 H\u0001A:\n(H\u0001A)t(ω) =Zt\n0Hs(ω)dAs(ω).\n我们称 (H\u0001A)是H对有限变差过程 A的随机积分 .那么 ,结论是 (H\u0001A)\n也是有限变差过程 .\n证明 .根据上一节的结果 ,几乎必然的 ,轨道t7!(H\u0001A)t(ω)是有限变差函\n数.所以 ,我们只需要说明 (H\u0001A)是适应过程即可 .注意到循序可测过程可\n以看作关于循序可测 σ-域P可测的随机变量 .而一般的随机变量可以通过\n示性变量的线性组合逼近 .所以 ,我们只需要验证示性型循序可测过程的随第 11.2节 连续局部鞅 163\n机积分是适应的即可 .故,我们假设Ht(ω) = 1 A(ω,t),其中 ,A是循序可测\n子集 .即,8t\u00150,\nA\\[0,t]2 Ft\u0002 B([0,t]).\n我们需要证明 8t\u00150,(H\u0001A)t2 Ft.因为 (H\u0001A)0= 0 ,所以 ,接下来 ,我们\n固定t>0.我们先考虑形如 1(u,v](t)1F(ω)的Ft\u0002 B([0,t])中的可测集 ,其\n中,(u,v]2[0,t],F2 Ft.那么 ,(H\u0001A)t= 1F(Av\u0000Au)2 Ft.利用 Dynkin\n的π-λ定理 ,可以证明 :如果A\\[0,t]Ft\u0002 B([0,t]),那么 ,(H\u0001A)t2 Ft.综\n上,即可得证 .\n注 11.1.5.假设对几乎所有的 ω2Ω,8t\u00150,\nZt\n0jHs(ω)jjdAs(ω)j<+1.\n那么 ,我们也可以定义随机积分 H\u0001A.首先 ,我们定义\nH′\nt(ω) =(\nHt(ω),Rt\n0jHs(ω)jjdAs(ω)j<+1;\n0,Rt\n0jHs(ω)jjdAs(ω)j= +1.\n那么 ,H′与H不相同之处被包含于一个形如 N\u0002[0,+1)的零测集 .假设\n域流是完备的 ,即F0包含所有的零测集 .那么 ,H′也是循序可测的 .我们\n可以定义随机积分 H′\u0001A.最后 ,我们把H\u0001A定义为H′\u0001A.\n注 11.1.6.在适当的条件下 ,我们有\nK\u0001(H\u0001A) = (KH)\u0001A.\n第 11.2节 连续局部鞅\n对于一个适应的过程 X和一个停时 T,我们定义停止过程 XT:\nXT\nt=XT∧t.\n那么 ,XT也是适应的过程 .\n定义 11.2.1.假设M是适应的过程 .而(Tn)n是一列趋于 +1的停时 .如\n果对于任意的 n,MTn∧t1Tn>0是鞅 .那么 ,我们称M是局部鞅 .我们称停时\n列(Tn)n是局部鞅M的局部化序列 .进一步的 ,如果M的轨道是连续的 ,\n那么 ,我们称M为连续局部鞅 .164 第十一章 连续半鞅\n注 11.2.1.根据定义 ,鞅一定是局部鞅 .\n注 11.2.2.对于局部鞅 M和t\u00150,我们不一定有 Mt可积 .\n注 11.2.3.对于连续局部鞅 M ,如果我们定义 Tn= infft\u00150 :jMtj \u0015ng.\n那么 ,MTn∧t1Tn>0是一致可积鞅 .\n注 11.2.4.对于局部鞅 M和停时T,停止过程MT也是局部鞅 .\n注 11.2.5.局部鞅构成向量空间 .如果Tn局部化M ,Sn局部化N,那么 ,\nTn^Sn局部化M+N.\n下面的命题给出几个关于局部鞅的有用结论 :\n命题 11.2.6.假设M是局部鞅 .\n(1)如果M非负并且M02L1,那么 ,M是上鞅 .\n(2)假设存在Z2L1,使得jMtj \u0014Z.那么 ,M是一�", "A.\n第 11.2节 连续局部鞅\n对于一个适应的过程 X和一个停时 T,我们定义停止过程 XT:\nXT\nt=XT∧t.\n那么 ,XT也是适应的过程 .\n定义 11.2.1.假设M是适应的过程 .而(Tn)n是一列趋于 +1的停时 .如\n果对于任意的 n,MTn∧t1Tn>0是鞅 .那么 ,我们称M是局部鞅 .我们称停时\n列(Tn)n是局部鞅M的局部化序列 .进一步的 ,如果M的轨道是连续的 ,\n那么 ,我们称M为连续局部鞅 .164 第十一章 连续半鞅\n注 11.2.1.根据定义 ,鞅一定是局部鞅 .\n注 11.2.2.对于局部鞅 M和t\u00150,我们不一定有 Mt可积 .\n注 11.2.3.对于连续局部鞅 M ,如果我们定义 Tn= infft\u00150 :jMtj \u0015ng.\n那么 ,MTn∧t1Tn>0是一致可积鞅 .\n注 11.2.4.对于局部鞅 M和停时T,停止过程MT也是局部鞅 .\n注 11.2.5.局部鞅构成向量空间 .如果Tn局部化M ,Sn局部化N,那么 ,\nTn^Sn局部化M+N.\n下面的命题给出几个关于局部鞅的有用结论 :\n命题 11.2.6.假设M是局部鞅 .\n(1)如果M非负并且M02L1,那么 ,M是上鞅 .\n(2)假设存在Z2L1,使得jMtj \u0014Z.那么 ,M是一致可积鞅 .\n证明 . (1)假设Tn局部化M .那么 ,对于s\u0014t,我们有\nE(Mt∧Tn1Tn>0jFs) =Ms∧Tn1Tn>0.\n令n! 1并利用 F atou引理可得 :\nE(MtjFs)\u0014Ms.\n特别的 ,取s= 0 ,由于M02L1,所以 ,Mt2L1.综上 ,可知M是上\n鞅.\n(2)由于Z控制 (Mt)t≥0,所以 ,(Mt)t≥0一致可积 .接下来 ,我们只需要说\n明M是鞅 .假设Tn局部化M .那么 ,对于s\u0014t,我们有\nE(Mt∧Tn1Tn>0jFs) =Ms∧Tn1Tn>0.\n令n! 1 ,并利用控制收敛定理 ,可得 :\nE(MtjFs)\u0014Ms.\n由于Mt的可积性已被说明 ,故适应过程 M是鞅 .综上 ,M是一致可\n积鞅 .第 11.3节 连续局部鞅的二次变差过程 165\n注 11.2.7.命题 11.2.6中的 (2)不可以被进一步放宽为一致可积局部鞅 .甚\n至于即使对于 L2有界局部鞅这样更强的条件 ,也不能保证其为鞅 .例如 ,\n假设B是从x6= 0出发的三维的布朗运动 ,而Mt= 1/jBtj.那么 ,M\n是L2有界的局部鞅 ,但是 ,M并不是鞅 .实际上 ,可以通过 Itô公式看\n出M是局部鞅 .而M∞= limt→+∞Mt= 1/ limt→+∞jBtj= 0 .如果\nM是L2有界的 ,那么 ,M是一致可积的 .如果再假设 M是鞅 ,那么 ,\n1/jxj=M0=E[M∞jF0] = 0 .由此矛盾 ,可知M不是鞅 .\n定理 11.2.8.假设M0= 0 ,M是有限变差过程 ,同时也是连续局部鞅 .那\n么,几乎必然的 ,对于任意的 t\u00150,Mt= 0 .\n证明思想 :连续局部鞅可以局部化为连续鞅 .而非退化的连续鞅的二次\n变差严格大于零 .另一方面 ,对于连续的有限变差过程 ,其二次变差应当为\n零.具体的证明可见 [LG16 ,定理 4.8的证明 ].\n第 11.3节 连续局部鞅的二次变差过程\n从现在开始 ,我们假设域流是完备的 .下面的定理对后续内容起着至关\n重要的作用 .\n定理 11.3.1.假设M是连续局部鞅 .那么 ,在不可区分的意义下 ,存在唯一\n一个从 0出发的连续的增长的适应过程 (hM,M it)t≥0,使得M2\nt\u0000 hM,M it\n是局部鞅 .进一步的 ,固定t>0,假设λ是分划 0 =tn\n0<tn\n1<\u0001 \u0001 \u0001<tn\npn的\n最大小区间长度 .那么 ,当λ趋于 0时,\npnX\nk=1(Mtk\u0000Mtk−1)2P! hM,M it. (11.1)\n我们称 hM,M i是M的二次变差过程 .\n上述定理和下鞅的 Doob-Meyer 分解有关 .证明见 [LG16 ,定理 4.9的\n证明 ].\n例 11.1.对于标准布朗运动 B而言 ,B2\nt\u0000t是鞅 ,故B的二次变差过程为\nhB,Bit=t.\n注 11.3.2.由式 (11.1 ),如果Mt=M0+Nt,那么 ,hM,M i=hN,Ni,即二\n次变差过程不依赖于 M的初值 .166 第十一章 连续半鞅\n命题 11.3.3.假设M是连续局部鞅 ,而T是停时 .那么 ,我们有\nhMT,MTit=hM,M iT∧t.\n证明 .如果M2\nt\u0000 hM,M it是局部鞅 ,那么 ,其停止过程 M2\nT∧t\u0000 hM,M iT∧t\n也是局部鞅 .根据二次变差过程的唯一性 ,MT的二次变差过程只能是\nhM,M iT∧t.\n命题 11.3.4. 假设连续局部鞅 M的初值M0为0.那么 ,二次变差过程\nhM,M i恒为 0当且仅当连续局部鞅 M恒为 0.\n证明 .如果M恒为 0,那么 ,M2\nt也是局部鞅 ,故hM,M it= 0 .反之 ,若\nhM,M it恒为 0,那么 ,M2\nt为连续局部鞅 .又因为M0= 0 ,M2\nt\u00150,故根\n据命题 11.2.6中的 (1) ,M2\nt为上鞅 .因此 ,EM2\nt\u0014EM2\n0= 0 .故,M�", "差过程 .\n上述定理和下鞅的 Doob-Meyer 分解有关 .证明见 [LG16 ,定理 4.9的\n证明 ].\n例 11.1.对于标准布朗运动 B而言 ,B2\nt\u0000t是鞅 ,故B的二次变差过程为\nhB,Bit=t.\n注 11.3.2.由式 (11.1 ),如果Mt=M0+Nt,那么 ,hM,M i=hN,Ni,即二\n次变差过程不依赖于 M的初值 .166 第十一章 连续半鞅\n命题 11.3.3.假设M是连续局部鞅 ,而T是停时 .那么 ,我们有\nhMT,MTit=hM,M iT∧t.\n证明 .如果M2\nt\u0000 hM,M it是局部鞅 ,那么 ,其停止过程 M2\nT∧t\u0000 hM,M iT∧t\n也是局部鞅 .根据二次变差过程的唯一性 ,MT的二次变差过程只能是\nhM,M iT∧t.\n命题 11.3.4. 假设连续局部鞅 M的初值M0为0.那么 ,二次变差过程\nhM,M i恒为 0当且仅当连续局部鞅 M恒为 0.\n证明 .如果M恒为 0,那么 ,M2\nt也是局部鞅 ,故hM,M it= 0 .反之 ,若\nhM,M it恒为 0,那么 ,M2\nt为连续局部鞅 .又因为M0= 0 ,M2\nt\u00150,故根\n据命题 11.2.6中的 (1) ,M2\nt为上鞅 .因此 ,EM2\nt\u0014EM2\n0= 0 .故,M恒为\n0.\n如果A是增过程 ,我们用A∞表示 limt→+∞At.下面的定理说明连续\n局部鞅M的性质与其二次变差过程密切相关 .\n定理 11.3.5.假设M是初值M0平方可积的连续局部鞅 .\n(1)以下两条等价 :\n(a)M是L2有界鞅 .\n(b)E[hM,M i∞]<+1.\n进一步的 ,如果上面两条之一满足 ,那么 ,M2\nt\u0000 hM,M it是一致可积\n鞅.特别的 ,E[M2\n∞] =E[M2\n0] +E[hM,M i∞].\n(2)以下两条等价 :\n(a)M是鞅 ,并且8t\u00150,Mt2L2.\n(b)对于任意的 t,E[hM,M it]<+1.\n进一步的 ,如果上面两条之一满足 ,那么 ,M2\nt\u0000 hM,M it是鞅 .第 11.4节 两个连续局部鞅的尖括号过程 167\n第 11.4节 两个连续局部鞅的尖括号过程\n定义 11.4.1.假设M和N是两个连续局部鞅 .那么 ,我们如下定义其尖括\n号过程 :\nhM,Nit=1\n2(hM+N,M +Nit\u0000 hM,M it\u0000 hN,Nit).\n注 11.4.1.连续局部鞅 M和N的尖括号过程是从 0出发的有限变差过程 .\n命题 11.4.2. (1)在不可区分的意义下 ,尖括号过程 hM,Ni是唯一的一\n个从 0出发的有限变差过程 ,使得MtNt\u0000 hM,Nit是连续局部鞅 .\n(2)映射 (M,N )7! hM,Ni是对称双线性型 .\n(3)固定t >0,假设λ是分划 0 =tn\n0< tn\n1<\u0001 \u0001 \u0001< tn\npn的最大小区间长\n度.那么 ,当λ趋于 0时,\npnX\nk=1(Mtk\u0000Mtk−1)(Ntk\u0000Ntk−1)P! hM,Nit. (11.2)\n(4)假设T是停时 .那么 ,\nhMT,NTit=hMT,Nit=hM,NiT∧t.\n(5)假设M和N是连续的L2有界鞅 .那么 ,MtNt\u0000 hM,Nit是一致可\n积鞅 ,并且当t!+1时,hM,Nit几乎必然收敛到 hM,Ni∞.另外 ,\nhM,Ni∞可积 ,并且\nE[M∞N∞] =E[M0N0] +E[hM,Ni∞].\n命题 11.4.3.假设B和B′是两个独立的 (Ft)-布朗运动 .那么 ,对于任意\n的t\u00150,\nhB,B′it= 0.\n命题 11.4.4 (Kunita-W atanabe) .假设M和N是两个连续局部鞅 ,而H\n和K是两个可测的过程 .那么 ,几乎必然的 ,\n\u0012Z+∞\n0jHsKsjjdhM,Nisj\u00132\n\u0014Z+∞\n0H2\nsdhM,M isZ+∞\n0K2\nsdhN,Nis.168 第十一章 连续半鞅\n第 11.5节 连续半鞅\n定义 11.5.1.如果过程X能够写成连续局部鞅 M与从 0出发的连续的有\n限变差过程 A的和 ,即,8t\u00150,\nXt=Mt+At,\n那么 ,我们称X是连续半鞅 .\n由定理 11.2.8 ,分解Xt=Mt+At是唯一的 ,被我们称为标准分解 .\n定义 11.5.2.如果X=M+A和X′=M′+A′是连续半鞅 X和X′的\n标准分解 .那么 ,我们如下定义 X和X′的尖括号过程 :\nhX,X′it=hM,M′it.\n特别的 ,我们有\nhX,Xit=hM,M it.\n命题 11.5.1.固定t>0,假设λ是分划 0 =tn\n0<tn\n1<\u0001 \u0001 \u0001<tn\npn的最大小\n区间长度 .那么 ,当λ趋于 0时,\npnX\nk=1(Xtk\u0000Xtk−1)(X′\ntk\u0000X′\ntk−1)P! hX,X′it. (11.3)第十二章 随机积分\n第 12.1节 随机积分的构造\n12.1.1 对于L2有界连续鞅的随机积分\n定义 12.1.1.我们用 H2表示从 0出发的L2有界的连续鞅构成的空间 .对\n于不可区分的过程 ,我们将其等同起来 .\n对于M2H2,M必然是一致可积鞅 .故M∞= limt→∞Mt存在 ,并且\n8t\u00150,Mt=E[M∞jFt].我们在 H2上定义内积 :\n(M,N )def=E[M∞N∞] =E[hM,Ni∞]. (12.1)\n上述内积诱导范数\njjMjj=p\n(M,M ) =p\nE[M2\n∞] =p\nE[hM,M i∞].\n", "�的有\n限变差过程 A的和 ,即,8t\u00150,\nXt=Mt+At,\n那么 ,我们称X是连续半鞅 .\n由定理 11.2.8 ,分解Xt=Mt+At是唯一的 ,被我们称为标准分解 .\n定义 11.5.2.如果X=M+A和X′=M′+A′是连续半鞅 X和X′的\n标准分解 .那么 ,我们如下定义 X和X′的尖括号过程 :\nhX,X′it=hM,M′it.\n特别的 ,我们有\nhX,Xit=hM,M it.\n命题 11.5.1.固定t>0,假设λ是分划 0 =tn\n0<tn\n1<\u0001 \u0001 \u0001<tn\npn的最大小\n区间长度 .那么 ,当λ趋于 0时,\npnX\nk=1(Xtk\u0000Xtk−1)(X′\ntk\u0000X′\ntk−1)P! hX,X′it. (11.3)第十二章 随机积分\n第 12.1节 随机积分的构造\n12.1.1 对于L2有界连续鞅的随机积分\n定义 12.1.1.我们用 H2表示从 0出发的L2有界的连续鞅构成的空间 .对\n于不可区分的过程 ,我们将其等同起来 .\n对于M2H2,M必然是一致可积鞅 .故M∞= limt→∞Mt存在 ,并且\n8t\u00150,Mt=E[M∞jFt].我们在 H2上定义内积 :\n(M,N )def=E[M∞N∞] =E[hM,Ni∞]. (12.1)\n上述内积诱导范数\njjMjj=p\n(M,M ) =p\nE[M2\n∞] =p\nE[hM,M i∞].\n根据 Doob不等式 ,我们有\nE[sup\nt≥0jMtj2]\u00144jjMjj2. (12.2)\n命题 12.1.1. H2是 Hilbert空间 .\n证明 .不难发现 H2是内积空间 .接下来 ,我们只需要证明 H2的完备性即\n可.为此 ,假设 (M(n))n是H2中的 Cauchy列,即\nlim\nm,n→∞E[(M(m)\n∞\u0000M(n)\n∞)2] = 0.\n那么 ,根据 (12.2 ),我们有\nlim\nm,n→∞E[sup\nt≥0jM(m)\nt\u0000M(n)\ntj2] = 0.\n169170 第十二章 随机积分\n那么 ,我们可以取子列 nk,使得\nX\nkE[sup\nt≥0jM(nk)\nt\u0000M(nk+1)\ntj2]<+1.\n因此 ,我们有X\nkE[sup\nt≥0jM(nk)\nt\u0000M(nk+1)\ntj]<+1.\n故,几乎必然的 ,我们有\nX\nksup\nt≥0jM(nk)\nt\u0000M(nk+1)\ntj<+1.\n故,存在连续的适应过程 (Mt)t≥0,使得\nlim\nk→∞sup\nt≥0jM(nk)\nt\u0000Mtj= 0.\n特别的 ,M∞= limk→+∞M(nk)\n∞ .对于t\u00150,E[M(nk)\n∞jFt] =Mnk\nt.令\nk!+1,M(nk)\n∞几乎必然收敛到 M∞,M(nk)\nt几乎必然收敛到 Mt.再注意\n到(M(n)\n∞)n是L2有界的 Cauchy列.故此列随机变量一致可积 .因而 ,我们\n有\nE[M∞jFt] =Mt,\n其中 ,M∞2L2.这说明极限过程 (Mt)t≥0是L2有界鞅 .最后 ,对于 Cauchy\n列,若子列收敛 ,则整个序列收敛 .故,在空间 H2中,M(n)收敛到M .这说\n明H2完备 .\n定义 12.1.2.给定M2H2,我们定义平方可积循序可测空间 :\nL2(M) =\u001a\n循序可测过程 H:E\u0014Z∞\n0H2\nsdhM,M is\u0015\u001b\n.\n如果H和H′满足\nE\u0014Z∞\n0(Hs\u0000H′\ns)2dhM,M is\u0015\n= 0,\n那么 ,我们将H和H′等同起来 .\n注 12.1.2.L2(M)可以视为普通的 L2空间 .实际上 ,\nL2(M) =L2(Ω\u0002[0,+1),P,dPdhM,M is),第 12.1节 随机积分的构造 171\n其中 ,P是循序可测 σ-域,而测度µ= dPdhM,M is如下定义 :对于A2 P ,\nµ(A) =E\u0014Z∞\n01A(ω,s)dhM,M is\u0015\n.\n因此 ,就如同其他的 L2空间一样 ,L2(M)也是 Hilbert空间 .其上的内积为\n(H,K ) =E\u0014Z∞\n0HsKsdhM,M is\u0015\n.\n其上的范数为\njjHjj=E\u0014Z∞\n0H2\nsdhM,M is\u0015\n.\n定义 12.1.3.我们把下列形式的循序可测过程称为 初等过程 :\nHs(ω) =p−1X\ni=0Hi(ω)1(ti,ti+1](s),\n其中 ,0 =t0< t 1<\u0001 \u0001 \u0001< tp,而对于i= 0,1,...,p \u00001,Hi(ω)是关于 Fti\n可测的有界随机变量 .我们用 E表示全体初等过程 .\n注 12.1.3. E是L2(M)的子空间 .\n命题 12.1.4.对于任意的 M2 H2,E在L2(M)中稠密 .\n证明 .根据 Hilbert空间的基本理论 ,我们只需要验证下述命题 :对于任意\n的K2L2(M),如果K与E中任何的H都垂直 ,那么 ,K在L2(M)中等\n于0.\n根据性质 11.4.4 ,我们有\nZ∞\n0jKsjdhM,M is\u0014\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\u0012Z∞\n01\u0001dhM,M is\u00131\n2\n=\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\nhM,M i1\n2∞.\n两边同时取期望 ,然后利用 Cauchy-Schwartz 不等式 ,我们得到\nE\u0014Z∞\n0jKsjdhM,M is\u0015\n\u0014E\"\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\nhM,M i1\n2∞#\n\u0014\u0012\nE\u0014Z∞\n0K2\nsdhM,M is\u0015\u0013 1\n2\n(E[hM,M i∞])1\n2<+1.172 第十二章 随机积分\n这说明几乎必然的 ,Z+∞\n0jKsjdhM,M is<+1.\n从而 ,K对hM,M i的随机积分定义良好 .用X表示该随机积分 ,即\nXt=Zt\n0KsdhM,M is.\n那么 ,X是从 0出发的连续的有限变差过程 .另一方面 ,取\nHr(ω) =F(ω)1(s,t](r),\n其中 ,F(ω)关于Fs可测的有界�", "\u00001,Hi(ω)是关于 Fti\n可测的有界随机变量 .我们用 E表示全体初等过程 .\n注 12.1.3. E是L2(M)的子空间 .\n命题 12.1.4.对于任意的 M2 H2,E在L2(M)中稠密 .\n证明 .根据 Hilbert空间的基本理论 ,我们只需要验证下述命题 :对于任意\n的K2L2(M),如果K与E中任何的H都垂直 ,那么 ,K在L2(M)中等\n于0.\n根据性质 11.4.4 ,我们有\nZ∞\n0jKsjdhM,M is\u0014\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\u0012Z∞\n01\u0001dhM,M is\u00131\n2\n=\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\nhM,M i1\n2∞.\n两边同时取期望 ,然后利用 Cauchy-Schwartz 不等式 ,我们得到\nE\u0014Z∞\n0jKsjdhM,M is\u0015\n\u0014E\"\u0012Z∞\n0K2\nsdhM,M is\u00131\n2\nhM,M i1\n2∞#\n\u0014\u0012\nE\u0014Z∞\n0K2\nsdhM,M is\u0015\u0013 1\n2\n(E[hM,M i∞])1\n2<+1.172 第十二章 随机积分\n这说明几乎必然的 ,Z+∞\n0jKsjdhM,M is<+1.\n从而 ,K对hM,M i的随机积分定义良好 .用X表示该随机积分 ,即\nXt=Zt\n0KsdhM,M is.\n那么 ,X是从 0出发的连续的有限变差过程 .另一方面 ,取\nHr(ω) =F(ω)1(s,t](r),\n其中 ,F(ω)关于Fs可测的有界随机变量 .如果\n0 = (H,K ) =E\u0014\nF(ω)Zt\nsKrdhM,M ir\u0015\n=E[F(ω)(Xt\u0000Xs)].\n那么 ,由F(ω)的任意性 ,可知E[Xt\u0000XsjFs] = 0 ,即E[XtjFs] =Xs,8s<t .\n故,X是鞅 .由于X既是从 0出发的有限变差过程 ,又是连续鞅 ,根据定\n理11.2.8 ,几乎必然的 ,8t\u00150,0 =Xt=Rt\n0KsdhM,M is.这只能是因为对\n几乎所有的 ω,对测度 dhM,M is下几乎处处的 s,Ks= 0 .而这又等价于\nK在L2(M)中等于 0.\n令M2H2.假设H2E有如下形式 :\nHs(ω) =p−1X\ni=0Hi(ω)1(ti,ti+1](s).\n那么 ,我们定义过程 H\u0001M :\n(H\u0001M)t=p−1X\ni=0Hi(ω)(Mti+1∧t\u0000Mti∧t).\n那么 ,我们有H\u0001M2H2,并且\njjH\u0001MjjH2=jjHjjL2(M),\n即从H到H\u0001M的变换是等距变换 ,称为H对M的随机积分 . (验证 !)利\n用E在L2(M)的稠密性 ,我们可以将上述随机积分等距的延拓到 L2(M)\n之上 ,得到L2(M)到H2的等距变换 ,得到随机积分 H\u0001M .\n命题 12.1.5.H\u0001M是唯一的 H2中的鞅 ,使得8N2H2,我们有\nhH\u0001M,Ni=H\u0001 hM,Ni. (12.3)第 12.1节 随机积分的构造 173\n我们简述证明概要 ,详细的证明见 [LG16 ,定理 5.4].\n证明 .首先 ,对初等过程验证 (12.3 ).其中 ,我们需要用到命题 11.4.2中的 (4).\n然后 ,对于一般的 H2L2(M),我们用初等过程 H(n)逼近 .利用随机积分\n等距同构的性质 ,H(n)\u0001M在H2空间中逼近 H\u0001M .利用 Cauchy-Schwartz\n不等式 ,这保证了 hH(n)\u0001M,Ni∞在L1意义下收敛于 hH\u0001M,Ni.利用\nKunita-W atanabe 不等式 (命题 11.4.4 ),我们有\nj((H(n)\u0000H)\u0001 hM,Ni)∞j \u0014q\n((H(n)\u0000H)2\u0001 hM,M i)∞hN,Ni∞L1\n!0.\n于是 ,对于一般的 H2L2(M),\nhH\u0001M,Ni∞= (H\u0001 hM,Ni)∞. (12.4)\n然后 ,我们将N替换成Nt,即可得到 8t\u00150,\nhH\u0001M,Nit= (H\u0001 hM,Ni)t.\n为了证明满足\nhX,Ni=H\u0001 hM,Ni\n的X2H2的唯一性 ,我们注意到\nh(H\u0001M\u0000X),Ni= 0.\n取N=H\u0001M\u0000X,利用命题 11.3.4 ,可知X=H\u0001M .+\n命题 12.1.6.如果T是停时 ,那么 ,1[0,T(ω)](s)是循序可测过程 .\n(1[0,T]H)\u0001M= (H\u0001M)T=H\u0001MT= 1 [0,T]H\u0001MT.\n证明 .因为 1[0,T(ω)](s)是左连续适应过程 1[0,T(ω)+1/n)(s)当n! 1时的极\n限,所以 ,1[0,T(ω)](s)的循序可测 .接下来 ,我们利用命题 12.1.5完成证明 .注\n意到8t\u00150,我们有\nh(1[0,T]H)\u0001M,Nit= 1 [0,T]H\u0001 hM,Nit\n= (H\u0001 hM,Ni)T∧t\n=h(H\u0001M)T,Nit.\n由于上式对任意 N2H2成立 ,所以 ,根据命题 12.1.5 ,我们有\n(1[0,T]H)\u0001M= (H\u0001M)T.174 第十二章 随机积分\n另一方面 ,8t\u00150,对于任意的 N2H2,我们有\nhH\u0001MT,Nit= (H\u0001 hMT,Ni)t\n= (H\u0001 hM,NiT)t\n= (H\u0001 hM,Ni)T∧t\n=h(1[0,T]H)\u0001M,Nit.\n所以 ,根据命题 12.1.5 ,我们有\n(1[0,T]H)\u0001M=H\u0001MT.\n最后 ,利用之前的结论 ,我们发现\n1[0,T]H\u0001MT= (1 [0,T]H\u0001M)T= ((H\u0001M)T)T= (H\u0001M)T.\n注 12.1.7.式(12.3 )可以用于定义随机积分 .实际上 ,\nf(N) =E[(H\u0001 hM,Ni)∞] =E[hH\u0001M,Ni∞] = (H\u0001M,N )H2\n定义了 Hilbert空间H2上的连续线性泛函 .由 Riesz表示定理 ,存在唯一\n一个X2H2,使得f(N) = (X,N )H2.那么 ,只能有X=H\u0001M .我们把\nX定义为H关于M的随机积分 .\n注 12.1.8.在(12", "[0,T(ω)+1/n)(s)当n! 1时的极\n限,所以 ,1[0,T(ω)](s)的循序可测 .接下来 ,我们利用命题 12.1.5完成证明 .注\n意到8t\u00150,我们有\nh(1[0,T]H)\u0001M,Nit= 1 [0,T]H\u0001 hM,Nit\n= (H\u0001 hM,Ni)T∧t\n=h(H\u0001M)T,Nit.\n由于上式对任意 N2H2成立 ,所以 ,根据命题 12.1.5 ,我们有\n(1[0,T]H)\u0001M= (H\u0001M)T.174 第十二章 随机积分\n另一方面 ,8t\u00150,对于任意的 N2H2,我们有\nhH\u0001MT,Nit= (H\u0001 hMT,Ni)t\n= (H\u0001 hM,NiT)t\n= (H\u0001 hM,Ni)T∧t\n=h(1[0,T]H)\u0001M,Nit.\n所以 ,根据命题 12.1.5 ,我们有\n(1[0,T]H)\u0001M=H\u0001MT.\n最后 ,利用之前的结论 ,我们发现\n1[0,T]H\u0001MT= (1 [0,T]H\u0001M)T= ((H\u0001M)T)T= (H\u0001M)T.\n注 12.1.7.式(12.3 )可以用于定义随机积分 .实际上 ,\nf(N) =E[(H\u0001 hM,Ni)∞] =E[hH\u0001M,Ni∞] = (H\u0001M,N )H2\n定义了 Hilbert空间H2上的连续线性泛函 .由 Riesz表示定理 ,存在唯一\n一个X2H2,使得f(N) = (X,N )H2.那么 ,只能有X=H\u0001M .我们把\nX定义为H关于M的随机积分 .\n注 12.1.8.在(12.3 )中,将N替换成K\u0001N,可得\nhH\u0001M,K \u0001Ni=H\u0001 hM,K \u0001Ni=H\u0001 hK\u0001N,Mi.\n再由 (12.3 ),我们有\nhK\u0001N,Mi=K\u0001 hN,Mi=K\u0001 hM,Ni.\n于是 ,我们得到\nhH\u0001M,K \u0001Ni=H\u0001(K\u0001 hM,Ni) = (HK)\u0001 hM,Ni.\n即,我们有\nhH\u0001M,K \u0001Nit=Zt\n0HsKsdhM,Nis. (12.5)第 12.1节 随机积分的构造 175\n下面的随机积分得 “结合律 ”很有用 .\n命题 12.1.9. 假设H2L2(M).假设K是循序可测过程 .那么 ,KH2\nL2(M)当且仅当K2L2(H\u0001M).如果KH2L2(M),那么 ,我们有\n(KH)\u0001M=K\u0001(H\u0001M).\n证明 .注意到KH2L2(M)当且仅当E[R∞\n0K2\nsH2\nsdhM,M is]<+1.而\nhH\u0001M,H \u0001Mi=H2\u0001 hM,M i.\n故,H2\nsdhM,M is= dhH\u0001M,H \u0001Mis.因此 ,我们有\nE\u0014Z∞\n0K2\nsH2\nsdhM,M is\u0015\n=E\u0014Z∞\n0K2\nsdhH\u0001M,H \u0001Mis\u0015\n.\n综上 ,可知KH2L2(M)当且仅当K2L2(H\u0001M).假设KH2L2(M).\n那么 ,对于任意的 N2H2,我们有\nh(KH)\u0001M,Ni= (KH)\u0001 hM,Ni\n=K\u0001(H\u0001 hM,Ni)\n=K\u0001 hH\u0001M,Ni\n=hK\u0001(H\u0001M),Ni.\n由N得任意性 ,我们有\n(KH)\u0001M=K\u0001(H\u0001M).\n12.1.2 对于局部鞅的随机积分\n假设M是一个连续局部鞅 .我们用L2(M)表示所有满足下列可积性\n的循序可测过程 H:\nE\u0014Z∞\n0H2\nsdhM,M is\u0015\n<+1.\n那么 ,如同M是L2有界连续鞅的情形一样 ,L2(M)可以被视为普通的 L2\n空间 .特别的 ,L2(M)是 Hilbert空间 .我们用L2\nloc(M)表示所有满足下列\n局部可积性的循序可测过程 H:几乎必然的 ,\nZt\n0H2\nsdhM,M is<+1,8t\u00150.176 第十二章 随机积分\n对于n\u00151,我们定义\nTn= infft\u00150 :Zt\n0(1 +H2\ns)dhM,M is\u0015ng.\n那么 ,Tn是一列单调上升到 +1的停时 .对于n\u00151,MTn2H2,1[0,Tn]H2\nL2(MTn).因此 ,可以定义随机积分 X(n)= (1 [0,Tn]H)\u0001MTn.积分出来的\n过程X(n)是L2有界连续鞅 .并且 ,对于m > n ,利用命题 12.1.6 ,我们有\nX(m)与X(n)满足相容性 :\n(X(m))Tn= ((1 [0,Tm]H)\u0001MTm)Tn= (1 [0,Tn]1[0,Tm]H)\u0001(MTm)Tn\n= (1 [0,Tn]H)\u0001MTn=X(n).\n因此 ,定义X= limn→∞X(n),那么 ,X(n)=XTn.特别的 ,X是从 0出发\n的连续局部鞅 .我们将X定义为H对M的随机积分 H\u0001M .不难发现 ,当\n我们限制M2H2,H2L2(M),就得到了与之前相同的随机积分 .所以 ,对\n于连续局部鞅的随机积分是对于 L2有界连续鞅的随机积分的推广 .我们记\n(H\u0001M)t=Zt\n0HsdMs,8t\u00150.\n定理 12.1.10. 假设M是连续局部鞅 ,H2L2\nloc(M).那么 ,对于任意的连\n续局部鞅N,我们有\nhH\u0001M,Ni=H\u0001 hM,Ni. (12.6)\n另一方面 ,如果X是从 0出发的连续局部鞅 ,且对任意的连续局部鞅 N满\n足\nhX,Ni=H\u0001 hM,Ni.\n那么 ,X=H\u0001M .\n证明 .通过使用局部化序列 (Tn)n,式(12.6 )可由 (12.3 )推出 .命题后半部分\n关于X=H\u0001M的证明与之前 L2有界连续鞅的对应结论的证明完全相\n同.\n通过局部化后再利用 L2有界连续鞅的结论 ,我们可以得到局部鞅情形\n下的类似结论 :第 12.1节 随机积分的构造 177\n定理 12.1.11. 如果T是停时 ,那么 ,\n(1[0,T]H)\u0001M=H\u0001MT= (1 [0,T]H)\u0001MT= (H\u0001M)T.\n如果H2L2\nloc(M),K是循序可测过程 ,那么 ,KH2L2\nloc(M)当且仅当\nK2L2\nloc(H\u0001M).并且当KH2L2\nloc(M)时,", "为H对M的随机积分 H\u0001M .不难发现 ,当\n我们限制M2H2,H2L2(M),就得到了与之前相同的随机积分 .所以 ,对\n于连续局部鞅的随机积分是对于 L2有界连续鞅的随机积分的推广 .我们记\n(H\u0001M)t=Zt\n0HsdMs,8t\u00150.\n定理 12.1.10. 假设M是连续局部鞅 ,H2L2\nloc(M).那么 ,对于任意的连\n续局部鞅N,我们有\nhH\u0001M,Ni=H\u0001 hM,Ni. (12.6)\n另一方面 ,如果X是从 0出发的连续局部鞅 ,且对任意的连续局部鞅 N满\n足\nhX,Ni=H\u0001 hM,Ni.\n那么 ,X=H\u0001M .\n证明 .通过使用局部化序列 (Tn)n,式(12.6 )可由 (12.3 )推出 .命题后半部分\n关于X=H\u0001M的证明与之前 L2有界连续鞅的对应结论的证明完全相\n同.\n通过局部化后再利用 L2有界连续鞅的结论 ,我们可以得到局部鞅情形\n下的类似结论 :第 12.1节 随机积分的构造 177\n定理 12.1.11. 如果T是停时 ,那么 ,\n(1[0,T]H)\u0001M=H\u0001MT= (1 [0,T]H)\u0001MT= (H\u0001M)T.\n如果H2L2\nloc(M),K是循序可测过程 ,那么 ,KH2L2\nloc(M)当且仅当\nK2L2\nloc(H\u0001M).并且当KH2L2\nloc(M)时,我们有\n(KH)\u0001M=K\u0001(H\u0001M).\n12.1.3 对于连续半鞅的随机积分\n假设X=M+V是连续半鞅的标准分解 .对于循序可测过程 H,如果\nH\u0001M与H\u0001V都有良好定义 ,那么 ,我们将H对半鞅X的随机积分定义\n为\nH\u0001X=H\u0001M+H\u0001V,\n并记\n(H\u0001X)t=Zt\n0HsdXs.\n接下来 ,我们给出使得 H\u0001X良好定义的充分条件 :如果循序可测过程 H是\n局部有界的 ,即几乎必然的 ,对于任意的 t\u00150,\nsup\ns≤tjHsj<+1,\n那么 ,H\u0001X是良好定义的 .\n命题 12.1.12. 1.映射 (H,X )7!H\u0001X是双线性的 .\n2.如果H和K都是局部有界循序可测过程 ,那么 ,\n(KH)\u0001X=K\u0001(H\u0001X).\n3.对于停时T,我们有\n(1[0,T]H)\u0001X=H\u0001XT= (1 [0,T]H)\u0001XT= (H\u0001X)T.\n4.H\u0001X也是连续半鞅 ,其标准分解为\nH\u0001X=H\u0001M+H\u0001V.178 第十二章 随机积分\n5.假设H形如\nHs(ω) =p−1X\ni=0Hi(ω)1(ti,ti+1](s),\n其中 ,0 =t0<t 1<\u0001 \u0001 \u0001<tp,而Hi(ω)是Fti可测的随机变量 .那么 ,\n我们有\n(H\u0001X)t=p−1X\ni=0Hi(Xti+1∧t\u0000Xti∧t).\n12.1.4 随机积分的收敛\n我们先给出一个控制收敛定理型的结果 :\n定理 12.1.13. 假设X=M+V是连续半鞅 X的标准分解 .假设 (H(n))n≥1\n和H都是局部有界的循序可测过程 .假设K是非负的循序可测过程 .假设\n下面的条件几乎必然成立 :\n1.8s2[0,t],H(n)\ns!Hs;\n2.8n\u00151,8s2[0,t],jH(n)\nsj \u0014Ks;\n3.Rt\n0K2\nsdhM,M is<+1,Rt\n0KsjdVsj<+1.\n那么 ,当n! 1时,我们有\nZt\n0H(n)\ns dXsP!Zt\n0HsdXs.\n第 12.2节 Itô公式\nItô公式是随机分析的基石 ,相当于微积分中的牛顿 -莱布尼兹公式 .\nItô公式表明多元半鞅 (X(1),X(2),...,X(p))的二阶连续可微函数 Yt=\nF(X(1)\nt,X(2)\nt,...,X(p)\nt)仍然是半鞅 ,并且该公式给出了连续半鞅 Y的标\n准分解 .\n定理 12.2.1 (Itô公式 ).假设X(1),X(2),...,X(p)是连续的半鞅 .假设F\n是定义在 Rp上的二阶连续可微函数 .那么 ,对于t\u00150,我们有\nF(X(1)\nt,X(2)\nt,...,X(p)\nt) =F(X(1)\n0,X(2)\n0,...,X(p)\n0)\n+pX\nj=1Zt\n0∂F\n∂xj(X(1)\ns,X(2)\ns,...,X(p)\ns)dX(j)\ns第 12.2节 ITÔ公式 179\n+1\n2pX\nj,k=1Zt\n0∂2F\n∂xi∂xj(X(1)\ns,X(2)\ns,...,X(p)\ns)dhX(j),X(k)is.\nItô公式的证明见 [LG16 ,定理 5.10].接下来 ,我们考虑 Itô公式的几种\n常见特殊形式 .\n命题 12.2.2 (分布积分公式 ).假设X和Y是连续的半鞅 .令F(x,y) =xy .\n由 Itô公式 ,可知\nXtYt\u0000X0Y0=Zt\n0XsdYs+Zt\n0YsdXs+hX,Yit.\n特别的 ,如果Y=X,那么 ,我们得到\nX2\nt\u0000X2\n0= 2Zt\n0XsdXs+hX,Xis.\n命题 12.2.3 (一维 Itô公式 ).假设X是连续半鞅 ,F(x)是二阶连续可微的\n函数 .那么 ,我们有\nF(Xt) =F(X0) +Zt\n0F′(Xs)dXs+1\n2Zt\n0F′′(Xs)dhX,Xis.\n特别的 ,对于一维标准布朗运动 ,我们有\nF(Bt) =F(0) +Zt\n0F′(Bs)dBs+1\n2Zt\n0F′′(Bs)ds.\n例 12.1.假设B是标准布朗运动 .那么 ,Xt=Bt是连续半鞅 .由 Itô公式 ,\nYt=B2\nt也是连续半鞅 .并且 ,\nB2\nt= 2Zt\n0BsdBs+t= (2B\u0001B)t+t.\n所以 ,根据连续半鞅的尖括号过程的定义 ,我们有", "s)dX(j)\ns第 12.2节 ITÔ公式 179\n+1\n2pX\nj,k=1Zt\n0∂2F\n∂xi∂xj(X(1)\ns,X(2)\ns,...,X(p)\ns)dhX(j),X(k)is.\nItô公式的证明见 [LG16 ,定理 5.10].接下来 ,我们考虑 Itô公式的几种\n常见特殊形式 .\n命题 12.2.2 (分布积分公式 ).假设X和Y是连续的半鞅 .令F(x,y) =xy .\n由 Itô公式 ,可知\nXtYt\u0000X0Y0=Zt\n0XsdYs+Zt\n0YsdXs+hX,Yit.\n特别的 ,如果Y=X,那么 ,我们得到\nX2\nt\u0000X2\n0= 2Zt\n0XsdXs+hX,Xis.\n命题 12.2.3 (一维 Itô公式 ).假设X是连续半鞅 ,F(x)是二阶连续可微的\n函数 .那么 ,我们有\nF(Xt) =F(X0) +Zt\n0F′(Xs)dXs+1\n2Zt\n0F′′(Xs)dhX,Xis.\n特别的 ,对于一维标准布朗运动 ,我们有\nF(Bt) =F(0) +Zt\n0F′(Bs)dBs+1\n2Zt\n0F′′(Bs)ds.\n例 12.1.假设B是标准布朗运动 .那么 ,Xt=Bt是连续半鞅 .由 Itô公式 ,\nYt=B2\nt也是连续半鞅 .并且 ,\nB2\nt= 2Zt\n0BsdBs+t= (2B\u0001B)t+t.\n所以 ,根据连续半鞅的尖括号过程的定义 ,我们有\nhB,B2it=hB,2B\u0001Bit= (2B\u0001 hB,Bi)t= 2Zt\n0Bsds.\n例 12.2.假设B是标准布朗运动 .那么 ,(t,Bt)是多元连续半鞅 .假设\nF(t,x)是二阶连续可微的函数 .那么 ,我们有\nF(t,Bt) =F(0,0) +Zt\n0∂F\n∂x(s,Bs)dBs180 第十二章 随机积分\n+Zt\n0∂F\n∂t(s,Bs)ds+1\n2Zt\n0∂2F\n∂x2(s,Bs)ds.\n例如 ,取F(t,x) =tx,那么 ,我们得到\ntBt=Zt\n0sdBs+Zt\n0Bsds.\n命题 12.2.4.假设 (B(1),B(2),...,B(d))是d维标准布朗运动 .那么 ,\nhB(i),B(j)it=δi,jt.\n注意到 (t,B(1),B(2),...,B(d))是多元连续半鞅 .假设F(t,x1,x2,...,x d)是\n二阶连续可微的函数 .那么 ,我们有\nF(t,B(1)\nt,B(2)\nt,...,B(d)\nt) =F(0,0,0,..., 0)\n+dX\nj=1Zt\n0∂F\n∂xj(s,B(1)\ns,B(2)\ns,...,B(d)\ns)dB(j)\ns\n+Zt\n0∂F\n∂t(s,B(1)\ns,B(2)\ns,...,B(d)\ns)ds\n+1\n2Zt\n0∆F(s,B(1)\ns,B(2)\ns,...,B(d)\ns)ds,\n其中 ,\n∆F(t,x1,x2,...,x d) =dX\nj=1∂2F\n∂x2\nj(t,x1,x2,...,x d).\n有些时候 ,二阶连续可微函数 F没有定义在全空间上 ,而是定义在一个\n开集U\u001aRp上.那么 ,考虑闭包V包含于U的开子集V.那么 ,FjV可以\n延拓为整个空间 Rp上的二阶连续可微函数 G.并且G支撑在U上.假设\n多元连续半鞅 X= (X(1),X(2),...,X(p))的初值 (X(1)\n0,X(2)\n0,...,X(p)\n0)几\n乎必然的属于 V.定义TV是此多元连续半鞅第一次离开 V的时刻 .那么 ,\n停止过程XTV仍然是连续半鞅 ,始终处于V之上 .那么 ,我们可以对多元\n连续半鞅XTV和函数G应用 Itô公式 .因此 ,对于t<T V,关于X和F的\nItô公式成立 .如果过程X几乎必然不会离开 U,那么 ,对于所有的 t\u00150,\n关于X和F的 Itô公式仍然成立 .\n例 12.3.假设B= (B(1),B(2),B(3))是从x0出发的三维标准布朗运动 .假\n设x06= 0 .考虑连续半鞅 Xt=P3\nj=1(B(j)\nt)2.那么 ,由于Px(B访问0) = 0 ,第 12.2节 ITÔ公式 181\n所以 ,几乎必然的 ,8t\u00150,Xt>0.令Yt= 1/jjBtjj= 1/pXt.注意到\nF(x) = 1/px在x>0上有定义 ,并且二阶连续可微 .根据 Itô公式 ,我们\n有\nYt= 1/jjx0jj \u00001\n2Zt\n01\nX3\n2sdXs+3\n8Zt\n01\nX5\n2shX,Xis.\n利用 Itô公式 ,我们有\nXt=jjx0jj2+ 23X\nj=1B(j)\ns dB(j)s+ 3t.\n所以 ,我们有\ndXs= 23X\nj=1B(j)\ns dB(j)\ns+ 3 ds,\nhX,Xis=h23X\nj=1B(j)\u0001B(j),23X\nk=1B(k)\u0001B(k)is\n=43X\nj,k=1((B(j)B(k))\u0001 hB(j),B(k)i)s\n=43X\nj=1Zs\n0(B(j)\nu)2du\n=4Zs\n0Xudu.\n综上 ,可得\nYt= 1/jjx0jj \u00003X\nj=1Zt\n0B(j)\ns/X3\n2sdB(j)\ns.\n因此 ,Y是局部鞅 .\n最后 ,利用 Itô公式 ,我们得到一族被称为 指数鞅的连续局部鞅 .它可以\n看成离散时间指数鞅的连续时间对应 .\n定义 12.2.1.对于一个复数值的随机过程 ,如果它的实部和虚部分别是两个\n连续局部鞅 ,我们称其为 复连续局部鞅 .\n命题 12.2.5.假设M是连续局部鞅 .假设λ2C.定义\nE(λM)t= exp(λMt\u0000λ2\n2hM,M it).182 第十二章 随机积分\n那么 ,E(λM)是复连续局部鞅 .进一步的 ,我们有\nE(λM)t=eλM0+λZt\n0E(λM)sdMs.\n证明 .直接利用 Itô公式 .\n第 12.3节 Itô", "有\nYt= 1/jjx0jj \u00001\n2Zt\n01\nX3\n2sdXs+3\n8Zt\n01\nX5\n2shX,Xis.\n利用 Itô公式 ,我们有\nXt=jjx0jj2+ 23X\nj=1B(j)\ns dB(j)s+ 3t.\n所以 ,我们有\ndXs= 23X\nj=1B(j)\ns dB(j)\ns+ 3 ds,\nhX,Xis=h23X\nj=1B(j)\u0001B(j),23X\nk=1B(k)\u0001B(k)is\n=43X\nj,k=1((B(j)B(k))\u0001 hB(j),B(k)i)s\n=43X\nj=1Zs\n0(B(j)\nu)2du\n=4Zs\n0Xudu.\n综上 ,可得\nYt= 1/jjx0jj \u00003X\nj=1Zt\n0B(j)\ns/X3\n2sdB(j)\ns.\n因此 ,Y是局部鞅 .\n最后 ,利用 Itô公式 ,我们得到一族被称为 指数鞅的连续局部鞅 .它可以\n看成离散时间指数鞅的连续时间对应 .\n定义 12.2.1.对于一个复数值的随机过程 ,如果它的实部和虚部分别是两个\n连续局部鞅 ,我们称其为 复连续局部鞅 .\n命题 12.2.5.假设M是连续局部鞅 .假设λ2C.定义\nE(λM)t= exp(λMt\u0000λ2\n2hM,M it).182 第十二章 随机积分\n那么 ,E(λM)是复连续局部鞅 .进一步的 ,我们有\nE(λM)t=eλM0+λZt\n0E(λM)sdMs.\n证明 .直接利用 Itô公式 .\n第 12.3节 Itô公式的应用\n12.3.1 布朗运动的 Lévy刻画\n我们介绍多维标准标准布朗运动的 Lévy刻画 .\n定理 12.3.1. 假设X= (X(1),X(2),...,X(d))是取值在 Rd上的连续的适\n应过程 .那么 ,以下两条等价 :\n(1)X是d维(Ft)-布朗运动 .\n(2)过程X(1),X(2),...,X(d)都是从 0出发的连续局部鞅 ,并且\nhX(j),X(k)it=δj,kt,\n其中 ,δj,k是 Kronecker 符号 ,即δj,k= 1j=k.\n为了简单起见 ,我们只给出 d= 1时的证明 .一般的情况的证明 ,请见\n[LG16 ,定理 5.12].\n证明 .之前我们已经知道 (1)可以推出 (2).我们只需要证明 (2))(1).为此 ,\n我们利用性质 12.2.5中的指数鞅 .注意到Mt= exp(iXt+1\n2t)是局部鞅 .对\n于任意固定的 t\u00150,Mt是有界的随机变量 .因此 ,M是鞅 .故,对于s\u0014t,\n我们有\nE[exp(iXt+1\n2t)jFs] = exp(iXs+1\n2s).\n等价的 ,我们有\nE[exp(i(Xt\u0000Xs))jFs] =e−1\n2(t−s).\n这说明给定 Fs,Xt\u0000Xs的条件分布是 N(0,t\u0000s).特别的 ,Xt\u0000Xs独立\n于Fs.最后 ,注意到X是从 0出发的连续的适应过程 .所以 ,X是Ft-布朗\n运动 .第 12.3节 ITÔ公式的应用 183\n12.3.2 连续鞅与布朗运动的时间变换\n我们的下一个定理说明连续局部鞅 M可以从布朗运动通过 (随机的 )\n时间变换后得到 .那么 ,连续局部鞅的一些轨道性质可以通过布朗运动的相\n关研究得到 .例如 ,假设hM,M i∞= +1,那么 ,可以从 lim supt→∞Bt=\n+1和 lim inf t→∞Bt=\u00001得到\nlim sup\nt→∞Mt= +1,lim inf\nt→+∞Mt=\u00001.\n定理 12.3.2 (Dambis-Bubins-Schwarz) .假设M是从 0出发的连续局部鞅 ,\n并且hM,M i∞=1.那么 ,存在一个布朗运动 B使得\nMt=B⟨M,M⟩t.\n作为证明的准备 ,我们需要一个技术性的引理 .\n引理 12.3.3.几乎必然的 ,对所有 0\u0014a<b ,\nMt=Ma,8t2[a,b]( ) hM,M ib=hM,M ia.\n证明 .利用M和hM,M i的连续性 ,我们只需要对所有的满足 0\u0014a<b的\n有理数对 (a,b)验证结果即可 .利用有理数对的可数性 ,我们只需要验证如\n下结果 :对于固定的 0\u0014a<b ,几乎必然的 ,\nMt=Ma,8t2[a,b]( ) hM,M ib=hM,M ia.\n根据二次变差过程 hM,M i的逼近式 (11.1 ),我们有\nMt=Ma,8t2[a,b] =) hM,M ib=hM,M ia.\n接下来 ,我们证明反方向的蕴含关系 .为此 ,我们引入一个新的连续局部鞅\nNt=Mt\u0000Mt∧a.\n那么 ,我们有\nhN,Ni=hM\u0000Ma,M\u0000Mai=hM,M i \u0000 hM,M ia.\n因此 ,对于t\u0014b,hN,Ni= 0 .注意到Nb是初值为 0的局部鞅 ,并且\nhNb,Nbi= 0 .根据命题 11.3.4 ,我们有Nb恒为 0.等价的 ,对于任意的\nt2[a,b],Mt=Ma.184 第十二章 随机积分\n接下来 ,我们证明定理 12.3.2 .\n定理 12.3.2的证明 .对于r\u00150,我们定义\nτr= infft\u00150 :hM,M i \u0015tg.\n那么 ,函数r7!τr是非降函数 t7! hM,M i的左连续逆 .除此以外 ,对于每\n个r\u00150,τr都是停时 .定义\nBr=Mτr,8r\u00150.\n定义Gr=Fτr.由于 (Ft)是完备的域流 ,(Gr)也是完备的域流 .并且B是关\n于域流 Gr的适应过程 .接下来 ,我们验证B是局部鞅 .对于s\u0015r\u00150,Mτs\n是局部鞅 .注意到 hMτs,Mτsi∞=hM,M iτs=s.所以 ,根据定理 11.3.5中\n的 (1),Mτs是L2有界鞅 ,并且N(s)= (Mτs)2\u0000hMτs,Mτsi是一致可积鞅 .\n根据可选停时定理 ,我们有\nE[Mτs\n∞jFτr] =Mτs\nτr,\n即,\nE[BsjGr] =Br.\n因此 ,B是鞅 .类似的 ,根据可选停时定理 ,我们有\nE[N(s)\n∞jFτr] =N(s)\nτr,\n即,\nE[B2\ns\u0000sjGr] =B", "�a.\n那么 ,我们有\nhN,Ni=hM\u0000Ma,M\u0000Mai=hM,M i \u0000 hM,M ia.\n因此 ,对于t\u0014b,hN,Ni= 0 .注意到Nb是初值为 0的局部鞅 ,并且\nhNb,Nbi= 0 .根据命题 11.3.4 ,我们有Nb恒为 0.等价的 ,对于任意的\nt2[a,b],Mt=Ma.184 第十二章 随机积分\n接下来 ,我们证明定理 12.3.2 .\n定理 12.3.2的证明 .对于r\u00150,我们定义\nτr= infft\u00150 :hM,M i \u0015tg.\n那么 ,函数r7!τr是非降函数 t7! hM,M i的左连续逆 .除此以外 ,对于每\n个r\u00150,τr都是停时 .定义\nBr=Mτr,8r\u00150.\n定义Gr=Fτr.由于 (Ft)是完备的域流 ,(Gr)也是完备的域流 .并且B是关\n于域流 Gr的适应过程 .接下来 ,我们验证B是局部鞅 .对于s\u0015r\u00150,Mτs\n是局部鞅 .注意到 hMτs,Mτsi∞=hM,M iτs=s.所以 ,根据定理 11.3.5中\n的 (1),Mτs是L2有界鞅 ,并且N(s)= (Mτs)2\u0000hMτs,Mτsi是一致可积鞅 .\n根据可选停时定理 ,我们有\nE[Mτs\n∞jFτr] =Mτs\nτr,\n即,\nE[BsjGr] =Br.\n因此 ,B是鞅 .类似的 ,根据可选停时定理 ,我们有\nE[N(s)\n∞jFτr] =N(s)\nτr,\n即,\nE[B2\ns\u0000sjGr] =B2\nr\u0000r.\n所以 ,B2\ns\u0000s是鞅 .因此 ,hB,Bis=s.由于M从0出发 ,所以 ,B也从 0\n出发 .最后根据 Lévy关于布朗运动的刻画 (定理 12.3.1 ),B是(Gr)布朗运\n动.最后 ,注意到\nt\u0000=τ⟨M,M⟩t= inffs\u00150 :hM,M is=hM,M itg.\n利用引理 12.3.3 ,可知几乎必然的 ,对于所有的 t\u00150,\nMt−=Mt.\n等价的 ,我们有\nB⟨M,M⟩t=Mτ⟨M,M⟩t=Mt−=Mt.第 12.3节 ITÔ公式的应用 185\n12.3.3 BDG 不等式\n在本节中 ,我们给出一个联系连续局部鞅与它的二次变差过程的重要不\n等式 .假设M是连续局部鞅 .定义\nM∗\nt= max\ns≤tjMsj.\n定理 12.3.4 (Burkholder-Davis-Gundy 不等式 ).假设p >0.存在两个正\n常数cp和Cp,使得对于任意的从 0出发的连续局部鞅和任意的停时 T,下\n述不等式成立 :\ncpE[hM,M ip/2\nT]\u0014E[(M∗\nT)p]\u0014CpE[hM,M ip/2\nT].\n注 12.3.5.定理中的期望有可能取正无穷 .\n注 12.3.6. 上述定理把 M∗\nT的p阶矩的估计转化成了关于p\nhM,M iT的\np阶矩的估计 .如果M来自于一个随机积分 ,后者的估计往往相对比较简\n单.另外 ,上述定理在随机微分方程的理论中有重要应用 .\n我们略去定理的证明 ,而给出定理的一个重要应用 .\n推论 12.3.7.假设N是一个从 0出发的局部鞅 .如果\nE[hN,Ni1/2\n∞]<+1,\n那么 ,N是一致可积鞅 .\n注 12.3.8.例如 ,如果N=H\u0001M ,一般我们只知道 N是从 0出发的连续\n局部鞅 .注意到\nhN,Ni∞=Z+∞\n0H2\nsdhM,M is.\n所以 ,如果\nE\"\u0012Z∞\n0H2\nsdhM,M is\u00131/2#\n<1,\n那么 ,随机积分N是一致可积鞅 .作为推论 ,如果对于任意的 t\u00150,我们有\nE\"\u0012Zt\n0H2\nsdhM,M is\u00131/2#\n<1,\n那么 ,随机积分N是鞅 .\n问题 .验证关于布朗运动的指数鞅 E(λB)是鞅 .186 第十二章 随机积分\n第 12.4节 鞅表示\n如果我们将域流 (Ft)选为由布朗运动生成的自然域流的完备化 ,那么 ,\n所有关于这个域流的连续鞅都可以被表示成关于布朗运动的随机积分 .我们\n把这样的定理称为鞅表示定理 .为了简单起见 ,我们先考虑一维布朗运动的\n情形 ,在本节最后给出高维情形 .\n回忆定义 12.1.2 .对于布朗运动 B,我们有\nL2(B) =\u001a\n循序可测过程 (hs)s≥0:E\u0014Z∞\n0h2\nsds\u0015\n<+1\u001b\n.\n定理 12.4.1. 假设 (Ft)是由从零出发的标准布朗运动诱导的自然域流的\n完备化 .假设Z是关于 F∞可测的平方可积随机变量 .那么 ,存在唯一的\nh2L2(B),使得\nZ=E[Z] +Z∞\n0hsdBs. (12.7)\n因此 ,对于L2有界鞅M ,对于任意的 t\u00150,存在唯一的 h2L2(B)和常\n数C,使得\nMt=C+Zt\n0hsdBs.\n更一般的 ,假设M是连续的局部鞅 ,那么 ,存在唯一的 h2L2\nloc(B)和常数\nC,对于任意的 t\u00150,我们有\nMt=C+Zt\n0hsdBs.\n注 12.4.2.注意到我们并没有要求 L2有界鞅M的连续性 .\n为了证明定理 12.4.1 ,我们需要如下引理 :\n引理 12.4.3.假设 0 =t0<t 1<\u0001 \u0001 \u0001<tn,λ1,λ2,...,λ n2R,那么 ,形如\nexp \ninX\nj=1λj(Btj\u0000Btj−1)!\n的随机变量生成的线性空间在复数值平方可积随机变量空间 L2\nC(Ω,F∞,P)\n中稠密 .\n证明 .我们只需说明结论 :如果Z2L2\nC(Ω,F,P)与所有形如\nexp \ninX\nj=1λj(Btj\u0000Btj−1)!第 12.4节 鞅表示 187\n的随机变量垂直 ,那么 ,Z几乎必然等于 0.为此 ,我们假设对于任意的\n0 =t0<t 1<\u0001 \u0001 \u0001<tn", ".\n定理 12.4.1. 假设 (Ft)是由从零出发的标准布朗运动诱导的自然域流的\n完备化 .假设Z是关于 F∞可测的平方可积随机变量 .那么 ,存在唯一的\nh2L2(B),使得\nZ=E[Z] +Z∞\n0hsdBs. (12.7)\n因此 ,对于L2有界鞅M ,对于任意的 t\u00150,存在唯一的 h2L2(B)和常\n数C,使得\nMt=C+Zt\n0hsdBs.\n更一般的 ,假设M是连续的局部鞅 ,那么 ,存在唯一的 h2L2\nloc(B)和常数\nC,对于任意的 t\u00150,我们有\nMt=C+Zt\n0hsdBs.\n注 12.4.2.注意到我们并没有要求 L2有界鞅M的连续性 .\n为了证明定理 12.4.1 ,我们需要如下引理 :\n引理 12.4.3.假设 0 =t0<t 1<\u0001 \u0001 \u0001<tn,λ1,λ2,...,λ n2R,那么 ,形如\nexp \ninX\nj=1λj(Btj\u0000Btj−1)!\n的随机变量生成的线性空间在复数值平方可积随机变量空间 L2\nC(Ω,F∞,P)\n中稠密 .\n证明 .我们只需说明结论 :如果Z2L2\nC(Ω,F,P)与所有形如\nexp \ninX\nj=1λj(Btj\u0000Btj−1)!第 12.4节 鞅表示 187\n的随机变量垂直 ,那么 ,Z几乎必然等于 0.为此 ,我们假设对于任意的\n0 =t0<t 1<\u0001 \u0001 \u0001<tn与λ1,λ2,...,λ n2R,\nE\"\nZexp \ninX\nj=1λj(Btj\u0000Btj−1)!#\n= 0.\n我们定义复数值有限测度 µ:8F2 B(Rn),\nµ(F) =E[Z1F(Bt1,Bt2\u0000Bt1,...,B tn\u0000Btn−1)]/E[Z].\n那么 ,根据假设条件 ,µ的 F ourier变换恒为零 .根据逆转公式 ,µ是零测度 ,\n即,8F2 B(Rn),\nE[Z1F(Bt1,Bt2\u0000Bt1,...,B tn\u0000Btn−1)] = 0.\n因此 ,对于任意的 0 =t0<t 1<\u0001 \u0001 \u0001<tn,对于任意的 A2σ(Bt1,Bt2,...,B tn),\n我们有\nE[Z1A] = 0.\n最后 ,根据单调类定理 ,8A2 F∞,E[Z1A] = 0 .这说明Z几乎必然为 0.\n接下来 ,我们证明定理 12.4.1 .\n定理 12.4.1的证明 .我们首先来说明 (12.7 )出现的h的唯一性 .如果h和h′\n都满足要求 ,那么 ,必然有\nZ∞\n0hsdBs=Z∞\n0h′\nsdBs.\n那么 ,必然有Z∞\n0(hs\u0000h′\ns)dBs= 0.\n根据随机积分是 L2(B)到H2的同构 ,我们知道\njjh\u0000h′jjL2(B)= 0.\n故,在L2(B)中,h=h′.接下来 ,我们证明 (12.7 )中h的存在性 .具有表\n示(12.7 )的随机变量构成 L2(Ω,F∞,P)的线性子空间 V.更进一步的 ,此子\n空间V是闭的 .实际上 ,假设\nZ(n)=E[Z(n)] +Z∞\n0h(n)\ns dBs188 第十二章 随机积分\n并且Zn在L2意义下收敛到 Z.注意到\njjZ(n)\u0000Z(m)jj2\nL2(Ω,F∞,P)= (E[Z(n)]\u0000E[Z(m)])2+Z∞\n0(h(n)\ns\u0000h(m)\ns)2ds.\n所以 , lim n→∞E[Z(n)]存在 ,并且h(n)在L2(B)中收敛到某个 h.那么 ,必\n然有\nZ=Z[Z] +Z∞\n0hsdBs.\n为了证明V=L2(Ω,F∞,P),只需要证明 V中包含一个 L2(Ω,F∞,P)的\n稠密子集 .对于 0 =t0< t 1<\u0001 \u0001 \u0001< tn,λ1,λ2,...,λ n2R,令f(s) =\nPn\nj=1λj1(tj−1,tj](s).那么 ,\nMt=Zt\n0f(s)dBs=nX\nj=1λj(Btj∧t\u0000Btj−1∧t)2H2.\n指数鞅 E(iM)有界 .故其是鞅 .另外 ,该指数鞅可以表示成随机积分\n1 +iZt\n0E(iM)sdMs= 1 +iZt\n0E(iM)sf(s)dBs.\n故,E(iM)∞的实部和虚部均包含于 V.再注意到\nE(iM)∞= exp \ninX\nj=1λj(Btj\u0000Btj−1) +1\n2nX\nj=1λ2\nj(tj\u0000tj−1)!\n.\n所以 ,根据引理 12.4.3 ,E(iM)∞生成的子空间在 L2\nC(Ω,F∞,P)中稠密 .故,\nE(iM)∞的实部和虚部生成的子空间 W在L2\nC(Ω,F∞,P)中稠密 .而V包\n含W ,证毕 .\n注 12.4.4.根据鞅表示定理 ,任何关于 (Ft)的L2有界鞅M都可以表示成\n随机积分 .而我们这里的随机积分的轨道是连续的 .因此 ,M必然有连续的\n修正 .进一步的 ,可以证明关于 (Ft)的任何鞅都有连续的修正 .证明细节见\n[LG16 , 130-131 页].\n最后 ,我们陈述多维情形的鞅表示定理 .\n定理 12.4.5.假设B是从 0出发的d维标准布朗运动 .用(Ft)表示由B\n诱导的自然域流的完备化 .那么 ,对于任意的 Z2L2(Ω,F∞,P),存在唯一\n的一组循序可测过程 (h(1),h(2),...,h(d)),使得\ndX\nj=1E\u0014Z∞\n0(h(j)\ns)2ds\u0015\n<+1,第 12.5节 GIRSANOV 定理 189\n并且\nZ=E[Z] +dX\nj=1Z∞\n0h(j)\ns dB(j)\ns.\n类似的 ,假设M是连续的局部鞅 ,那么 ,存在常数C和唯一的一组循序可\n测过程 (h(1),h(2),...,h(d)),使得对于任意的 t\u00150,\ndX\nj=1Zt\n0(h(j)\ns)2ds<+1,\n并且\nMt=C+dX\nj=1Z∞\n0h(j)\ns dB(j)\ns.\n第 12.5节 Girsanov 定理\n在本节中 ,我们始终假设域流", "和虚部生成的子空间 W在L2\nC(Ω,F∞,P)中稠密 .而V包\n含W ,证毕 .\n注 12.4.4.根据鞅表示定理 ,任何关于 (Ft)的L2有界鞅M都可以表示成\n随机积分 .而我们这里的随机积分的轨道是连续的 .因此 ,M必然有连续的\n修正 .进一步的 ,可以证明关于 (Ft)的任何鞅都有连续的修正 .证明细节见\n[LG16 , 130-131 页].\n最后 ,我们陈述多维情形的鞅表示定理 .\n定理 12.4.5.假设B是从 0出发的d维标准布朗运动 .用(Ft)表示由B\n诱导的自然域流的完备化 .那么 ,对于任意的 Z2L2(Ω,F∞,P),存在唯一\n的一组循序可测过程 (h(1),h(2),...,h(d)),使得\ndX\nj=1E\u0014Z∞\n0(h(j)\ns)2ds\u0015\n<+1,第 12.5节 GIRSANOV 定理 189\n并且\nZ=E[Z] +dX\nj=1Z∞\n0h(j)\ns dB(j)\ns.\n类似的 ,假设M是连续的局部鞅 ,那么 ,存在常数C和唯一的一组循序可\n测过程 (h(1),h(2),...,h(d)),使得对于任意的 t\u00150,\ndX\nj=1Zt\n0(h(j)\ns)2ds<+1,\n并且\nMt=C+dX\nj=1Z∞\n0h(j)\ns dB(j)\ns.\n第 12.5节 Girsanov 定理\n在本节中 ,我们始终假设域流 (Ft)是完备而右连续的 .我们关心在概率\n测度从P换成Q之后 ,对鞅、局部鞅、有限变差过程和半鞅等概念的影响 .\n大多数情况下 ,我们假设P和Q是相互绝对连续的 .为了区分不同概率测\n度下的积分 ,我们用EP表示关于概率测度 P的期望 .类似的 ,EQ表示关\n于概率测度 Q的期望 .首先 ,我们注意到有限变差过程不受上述测度变换的\n影响 .\n接下来的性质表明测度变换自然的与非负鞅有关联 .\n命题 12.5.1.假设在 (Ω,F∞)上有两个概率测度 P和Q.假设Q关于P\n绝对连续 ,并用D∞表示在 (Ω,F∞)上Q关于P的 Radon-Nikodim 导数 .\n对于t\u00150,令\nDt=E[D∞jFt].\n那么 ,Dt恰好是在 (Ω,Ft)上Q关于P的 Radon-Nikodim 导数 .根据定\n义,关于概率P,(Dt)t≥0是非负一致可积鞅 .故,Dt存在右连左极的修正 .\n之后 ,我们总是假设 (Dt)t≥0是右连左极的 .如果我们进一步假设 P和Q\n在(Ω,F∞)上是相互绝对连续的 ,那么 ,关于概率P几乎必然的 ,\ninf\nt≥0Dt>0. (12.8)\n于是 ,关于概率P,(Dt)t≥0是严格正的一致可积鞅 .190 第十二章 随机积分\n证明 .除了 (12.8 ),其他结论的验证方法都是标准的 .为了证明 (12.8 ),我们\n定义停时\nTε= infft\u00150 :Dt<εg.\n这里 ,Tε是停时实际上由定理 10.2.3保证 .注意到\nQ(Tε<1) =EP[1Tε<∞D∞] =EP[1Tε<∞DTε]\u0014ε.\n所以 ,我们有\nQ(∞\\\nn=1fT1/n<1g) = 0.\n由于P和Q相互绝对连续 ,所以 ,\nP(∞\\\nn=1fT1/n<1g) = 0.\n这说明P-a.s.,9n\u00151,T1/n=1,从而 , inf t≥0Dt>0.\n接下来的命题说明如果 (Dt)t≥0是连续的 ,那么它可以被写成指数鞅\nE(L)形式 .\n命题 12.5.2.假设D是严格正的连续局部鞅 .定义\nLt= logD0+Zt\n0D−1\ns dDs. (12.9)\n那么 ,L是连续局部鞅 .更进一步的 ,我们有\nDt=E(L)t= exp\u0012\nLt\u00001\n2hL,Lit\u0013\n.\n证明 .对 logDt应用 Itô公式 ,可得\nlogDt= logD0+Zt\n0D−1\ns dDs\u00001\n2Zt\n0D−2\nshD,Dit.\n上式恰好等于 Lt\u00001\n2hL,Lit.\n接下来 ,我们叙述 Gisanov 定理 .\n定理 12.5.3.假设P和Q是可测空间 (Ω,F∞)之上的两个相互绝对连续\n的概率测度 .假设右连左极过程 (Dt)t≥0满足\n8t\u00150,Dt=dQ\ndP\f\f\f\nFt.第 12.5节 GIRSANOV 定理 191\n假设D的轨道是连续的 .令D=E(L),其中 ,L由式 (12.9 )给出 .那么 ,如\n果M在概率P下是连续局部鞅 ,那么 ,\nfM=M\u0000 hM,Li\n是概率Q下的连续局部鞅 .\n注 12.5.4.如果 (Ft)是标准布朗运动诱导的自然域流的完备化 ,那么 ,(Ft)\n也是右连续的 .根据鞅表示定理 ,鞅D有连续修正 .如果D是右连左极的 ,\n那么 ,它和一个连续鞅是不可区分的 .于是 ,不附加任何其他条件 , Gisanov\n定理成立 .\n证明 .首先 ,我们注意到 hM,M i=hfM,fMi.其次 ,我们不妨假设 M0= 0 .\n令\nT(n)= infft\u00150 :hM,M it+hL,Lit+hD,Dit+max\nu≤tMu+max\nu≤tDu\u0015ng.\n那么 ,T(n)是一列单调上升到无穷的停时 ,使得MT(n)都是L2有界鞅 .注\n意到\n(hM,LiT(n))2\u0014 hM,M iT(n)hL,LiT(n)\u0014n2.\n所以 ,fMT(n)也是L2有界的过程 .接下来 ,对于 0\u0014s<t ,A2 FT(n)∧s我\n们有\nEQ[fMT(n)∧t1A] =EP[(MT(n)∧t\u0000 hM,LiT(n)∧t)1AD∞]\n=EP[(MT(n)\nt\u0000 hMT(n),Lit)DT(n)\nt1A].\n根据分部积分公式 ,我们有\n(MT(n)\nt\u0000 hMT(n),Lit)DT(n)\nt\n=Z", "Q\ndP\f\f\f\nFt.第 12.5节 GIRSANOV 定理 191\n假设D的轨道是连续的 .令D=E(L),其中 ,L由式 (12.9 )给出 .那么 ,如\n果M在概率P下是连续局部鞅 ,那么 ,\nfM=M\u0000 hM,Li\n是概率Q下的连续局部鞅 .\n注 12.5.4.如果 (Ft)是标准布朗运动诱导的自然域流的完备化 ,那么 ,(Ft)\n也是右连续的 .根据鞅表示定理 ,鞅D有连续修正 .如果D是右连左极的 ,\n那么 ,它和一个连续鞅是不可区分的 .于是 ,不附加任何其他条件 , Gisanov\n定理成立 .\n证明 .首先 ,我们注意到 hM,M i=hfM,fMi.其次 ,我们不妨假设 M0= 0 .\n令\nT(n)= infft\u00150 :hM,M it+hL,Lit+hD,Dit+max\nu≤tMu+max\nu≤tDu\u0015ng.\n那么 ,T(n)是一列单调上升到无穷的停时 ,使得MT(n)都是L2有界鞅 .注\n意到\n(hM,LiT(n))2\u0014 hM,M iT(n)hL,LiT(n)\u0014n2.\n所以 ,fMT(n)也是L2有界的过程 .接下来 ,对于 0\u0014s<t ,A2 FT(n)∧s我\n们有\nEQ[fMT(n)∧t1A] =EP[(MT(n)∧t\u0000 hM,LiT(n)∧t)1AD∞]\n=EP[(MT(n)\nt\u0000 hMT(n),Lit)DT(n)\nt1A].\n根据分部积分公式 ,我们有\n(MT(n)\nt\u0000 hMT(n),Lit)DT(n)\nt\n=Zt\n0(MT(n)\nu\u0000 hMT(n),Liu)dDT(n)\nu+Zt\n0DT(n)\nu dMT(n)\nu\n\u0000Zt\n0DT(n)\nu dhMT(n),Liu+hMT(n),DT(n)it\n=Zt\n0(MT(n)\nu\u0000 hMT(n),Liu)dDT(n)\nu+Zt\n0DT(n)\nu dMT(n)\nu\n\u0000Zt\n0DudhMT(n),Liu+hMT(n),Dit.192 第十二章 随机积分\n利用Dt=E(L)t=D0+Rt\n0E(L)sdLs=D0+Rt\n0DsdLs,我们得到\nhMT(n),Dit=Zt\n0DudhMT(n),Liu.\n故,(MT(n)\nt\u0000 hMT(n),Lit)Dt是随机积分\nNtdef=Zt\n0(MT(n)\nu\u0000 hMT(n),Liu)dDT(n)\nu+Zt\n0DT(n)\nu dMT(n)\nu.\n利用停时T(n)的定义 ,我们有\nE[hN,Ni∞]<+1.\n所以 ,(MT(n)\nt\u0000 hMT(n),Lit)Dt是L2有界连续鞅 .于是 ,我们有\nEQ[fMT(n)∧t1A] =EP[(MT(n)\nt\u0000 hMT(n),Lit)DT(n)\nt1A]\n=EP[(MT(n)\ns\u0000 hMT(n),Lis)DT(n)\ns1A]\n=EQ[(MT(n)\ns\u0000 hMT(n),Lis)1A]\n=EQ[fMT(n)∧s1A].\n假设B2 Fs.那么 ,我们有\nEQ[fMT(n)∧t1B] =EQ[fMT(n)∧t1{T(n)≤s}∩B] +EQ[fMT(n)∧t1{T(n)>s}∩B]\n=EQ[fMT(n)∧s1{T(n)≤s}∩B] +EQ[fMT(n)∧t1{T(n)>s}∩B]\n=EQ[fMT(n)∧s1{T(n)≤s}∩B] +EQ[fMT(n)∧t1A]\n=EQ[fMT(n)∧s1{T(n)≤s}∩B] +EQ[fMT(n)∧s1A]\n=EQ[fMT(n)∧s1{T(n)≤s}∩B] +EQ[fMT(n)∧s1{T(n)>s}∩B]\n=EQ[fMT(n)∧s1B],\n其中 ,A=fT(n)>sg \\B2 FT(n)∧s.最后 ,由B2 Fs的任意性 ,我们有\nEQ[fMT(n)\ntjFs] =fMT(n)\ns.\n所以 ,fMT(n)是鞅 .最后 ,我们知道fM是局部鞅 .第十三章 随机微分方程\n第 13.1节 定义\n随机微分方程提供了一个被随机噪声扰动的微分方程模型 .\n定义 13.1.1.假设d和m是两个正整数 .令σ:R+\u0002Rd!Md×m(R)和\nb:R+\u0002Rd!Rd是两个局部有界的可测函数 ,其中 ,Md×m表示d\u0002m\n实矩阵全体 .我们记σ= (σij)1≤i≤d,1≤j≤m,b= (bi)1≤i≤d.我们假设B=\n(B(1),B(2),...,B(m))是m维标准布朗运动 ,而X= (X(1),X(2),...,X(d))\n是d维随机过程 .我们考虑如下的随机微分方程 E(σ,b):\ndXt=σ(t,Xt)dBt+b(t,Xt)dt. (13.1)\n实际上 ,这是随机微分方程组 .其中的第i个方程为\ndX(i)\nt=mX\nj=1σij(t,Xt)dB(j)\nt+bi(t,Xt)dt.\n而所谓的随机微分方程的 弱解指的是由下列六个对象构成的整体 :\n1.一个带完备域流的概率空间 (Ω,F,(Ft)t∈[0,+∞],P).\n2.一个从 0出发的m维(Ft)-布朗运动B= (B(1),B(2),...,B(m)).\n3.一个连续的 d维适应过程 X= (X(1),X(2),...,X(d)),满足\nXt=X0+Zt\n0σ(t,Xt)dBt+Zt\n0b(t,Xt)dt,\n即对于 1\u0014i\u0014d,我们有\nX(i)\nt=X(i)\n0+mX\nj=1Zt\n0σij(t,Xt)dB(j)\nt+Zt\n0bi(t,Xt)dt.\n193194 第十三章 随机微分方程\n额外的 ,如果X0=x2Rd,我们称X是方程Ex(σ,b)的解 .假设X是方\n程Ex(σ,b)的弱解 ,如果X关于由布朗运动 B诱导的自然域流的完备化适\n应,那么 ,我们称X是强解 .从这个意义上 ,强解和弱解的区别在于关心的\n过程X关于驱动随机微分方程的随机噪声 B的可测性 .\n例 13.1 (T anaka’s SDE) .考虑 T anaka的随机微分方程 :\ndXt= sgn(Xt)dBt,\n其中 , sgn (x) = 1 (0,∞)(x)\u00001(−∞,0](x).那么 ,该随机微分方程只存在弱解 ,\n不存在强解 .实际上 ,取X是布朗运动 ,(Ft)t∈[0,+∞]是X诱导的自然域流\n的完备化 .定义Bt=Rt\n0sgn(Xt)dXt.那么 ,B也", "�解指的是由下列六个对象构成的整体 :\n1.一个带完备域流的概率空间 (Ω,F,(Ft)t∈[0,+∞],P).\n2.一个从 0出发的m维(Ft)-布朗运动B= (B(1),B(2),...,B(m)).\n3.一个连续的 d维适应过程 X= (X(1),X(2),...,X(d)),满足\nXt=X0+Zt\n0σ(t,Xt)dBt+Zt\n0b(t,Xt)dt,\n即对于 1\u0014i\u0014d,我们有\nX(i)\nt=X(i)\n0+mX\nj=1Zt\n0σij(t,Xt)dB(j)\nt+Zt\n0bi(t,Xt)dt.\n193194 第十三章 随机微分方程\n额外的 ,如果X0=x2Rd,我们称X是方程Ex(σ,b)的解 .假设X是方\n程Ex(σ,b)的弱解 ,如果X关于由布朗运动 B诱导的自然域流的完备化适\n应,那么 ,我们称X是强解 .从这个意义上 ,强解和弱解的区别在于关心的\n过程X关于驱动随机微分方程的随机噪声 B的可测性 .\n例 13.1 (T anaka’s SDE) .考虑 T anaka的随机微分方程 :\ndXt= sgn(Xt)dBt,\n其中 , sgn (x) = 1 (0,∞)(x)\u00001(−∞,0](x).那么 ,该随机微分方程只存在弱解 ,\n不存在强解 .实际上 ,取X是布朗运动 ,(Ft)t∈[0,+∞]是X诱导的自然域流\n的完备化 .定义Bt=Rt\n0sgn(Xt)dXt.那么 ,B也是 (Ft)-布朗运动 . (实际\n上,作为对于布朗运动的随机积分 ,布朗运动是连续局部鞅 .但是 ,其二次变\n差过程 hB,Bit= ( sgn(Xt))2hX,Xit=t.所以 ,根据布朗运动的 Lévy刻画 .\n过程B是(Ft)-布朗运动 .)因此 , T anaka 方程的弱解总是存在的 .利用局\n部时 ,可以说明强解不存在 .\n关于随机微分方程有若干存在和唯一的概念 :\n定义 13.1.2. 如果对于任意的 x2Rd,方程Ex(σ,b)的弱解都存在 ,我们\n称弱解存在 .如果对于任意的 x2Rd,方程Ex(σ,b)的弱解在分布意义下唯\n一,我们称弱解唯一 .我们首先固定带域流的概率空间 (Ω,F,(Ft)t∈[0,+∞],P)\n和(Ft)-布朗运动 ,如果任何两个初值几乎必然相同的解 X和X′都是不可\n区分的 ,那么 ,我们称有 轨道唯一性 .\n下面这个定理把不同的存在和唯一性结合了起来 :\n定理 13.1.1 (Y amada-W atanabe) .假设弱解的存在性和轨道唯一性 .那么 ,\n必然有弱解的唯一性 .更进一步的 ,给定带域流的概率空间 (Ω,F,(Ft),P)\n和(Ft)布朗运动B,对于任意的 x2Rd,方程Ex(σ,b)都存在唯一的强解 .\n第 13.2节 Lipschitz 情形\n假设条件 .关于σ和b,我们假设关于空间变量的一致 Lipschitz 条件 .\n即,我们假设存在常数 K < +1,使得对于任意的 t\u00150,x,y2Rd,我们有\njσ(t,x)\u0000σ(t,y)j \u0014Kjx\u0000yj,jb(t,x)\u0000b(t,y)j \u0014Kjx\u0000yj.第 13.2节 LIPSCHITZ 情形 195\n定理 13.2.1.在先前的假设条件下 ,该方程的解具有轨道唯一性 ,并且对于\n任意的x2Rd,方程Ex(σ,b)都存在 (唯一的 )强解 .\n注 13.2.2.在弱解的意义下 ,方程的解也是存在且唯一的 .\n为了证明定理 13.2.1 ,我们需要如下 Gronwall 引理 :\n引理 13.2.3 (Gronwall 引理 ).假设T > 0.假设g: [0,T]!R是有界可测\n函数 .假设存在正常数 a和b,使得对于任意的 t2[0,T],我们有\ng(t)\u0014a+bZt\n0g(s)ds.\n那么 ,对于任意的 t2[0,T],我们有\ng(t)\u0014aexp(bt).\n定理 13.2.1的证明 .我们只给出 d=m= 1的证明 .一般情况下的证明是\n类似的 .首先 ,我们证明轨道唯一性 .为此 ,我们固定带域流的概率空间\n(Ω,F,(Ft),P),固定其上的 (Ft)-布朗运动B.假设我们有两个初值几乎必\n然相同的解 X和X′.即假设X0=X′\n0,并且\nXt=X0+Zt\n0σ(s,X s)dBs+Zt\n0b(s,X s)ds,\nX′\nt=X′\n0+Zt\n0σ(s,X′\ns)dBs+Zt\n0b(s,X′\ns)ds.\n固定M > 0,定义\nτ= infft\u00150 :jXtj \u0015M或者jX′\ntj \u0015Mg.\n那么 ,对于s\u0014τ,我们有\njσ(s,X s)\u0000σ(s,X′\ns)j \u0014KjXs\u0000X′\nsj \u00142MK,\njb(s,X s)\u0000b(s,X′\ns)j \u0014KjXs\u0000X′\nsj \u00142MK.\n那么 ,我们有\nE[(Xτ∧t\u0000X′\nτ∧t)2]\u00142E[(Zτ∧t\n0(σ(s,X s)\u0000σ(s,X′\ns))dBs)2]\n+ 2E[(Zτ∧t\n0(b(s,X s)\u0000b(s,X′\ns))ds)2]196 第十三章 随机微分方程\n=2[Zτ∧t\n0(σ(s,X s)\u0000σ(s,X′\ns))2ds]\n+ 2TE[Zτ∧t\n0(b(s,X s)\u0000b(s,X′\ns))2ds]\n\u00142K2(1 +T)E[Zτ∧t\n0jXs\u0000X′\nsj2ds]\n\u00142K2(1 +T)Zt\n0E[(Xτ∧s\u0000X′\nτ∧s)2]ds.\n令h(t) =E[(Xτ∧t\u0000X′\nτ∧t)2].那么 ,我们有\nh(t)\u00142K2(1 +T)Zt\n0h(s)ds.\n根据 Gronwall 引理 ,我们得到h(t)恒等于 0.所以 ,Xτ∧t与X′\nτ∧t几乎必然\n相等 .令M! 1 ,我们得到Xt与X′\nt几乎必然相等 .所以 ,X与X′互为\n修正 .但是 ,X和X′的轨道都是连", "′\nt=X′\n0+Zt\n0σ(s,X′\ns)dBs+Zt\n0b(s,X′\ns)ds.\n固定M > 0,定义\nτ= infft\u00150 :jXtj \u0015M或者jX′\ntj \u0015Mg.\n那么 ,对于s\u0014τ,我们有\njσ(s,X s)\u0000σ(s,X′\ns)j \u0014KjXs\u0000X′\nsj \u00142MK,\njb(s,X s)\u0000b(s,X′\ns)j \u0014KjXs\u0000X′\nsj \u00142MK.\n那么 ,我们有\nE[(Xτ∧t\u0000X′\nτ∧t)2]\u00142E[(Zτ∧t\n0(σ(s,X s)\u0000σ(s,X′\ns))dBs)2]\n+ 2E[(Zτ∧t\n0(b(s,X s)\u0000b(s,X′\ns))ds)2]196 第十三章 随机微分方程\n=2[Zτ∧t\n0(σ(s,X s)\u0000σ(s,X′\ns))2ds]\n+ 2TE[Zτ∧t\n0(b(s,X s)\u0000b(s,X′\ns))2ds]\n\u00142K2(1 +T)E[Zτ∧t\n0jXs\u0000X′\nsj2ds]\n\u00142K2(1 +T)Zt\n0E[(Xτ∧s\u0000X′\nτ∧s)2]ds.\n令h(t) =E[(Xτ∧t\u0000X′\nτ∧t)2].那么 ,我们有\nh(t)\u00142K2(1 +T)Zt\n0h(s)ds.\n根据 Gronwall 引理 ,我们得到h(t)恒等于 0.所以 ,Xτ∧t与X′\nτ∧t几乎必然\n相等 .令M! 1 ,我们得到Xt与X′\nt几乎必然相等 .所以 ,X与X′互为\n修正 .但是 ,X和X′的轨道都是连续的 ,所以 ,二者不可区分 .这说明了轨\n道的唯一性 .\n最后 ,我们用 Picard迭代法来证明强解的存在性 .为此 ,我们归纳的构\n造一列连续的适应过程 :\nX(0)\nt=x,\nX(n+1)\nt =x+Zt\n0σ(s,X(n)\ns)dBs+Zt\n0σ(s,X(n)\ns)ds.\n根据归纳法 ,可以验证定义出过程 X(n)都是适应的连续过程 ,所以 ,其中的\n随机积分都是良好定义的 .我们将证明对于任意的 T > 0,都存在Ex(σ,b)\n直到时刻T的强解 .接下来 ,根据解的轨道唯一性 ,对于S <T ,直到T时\n刻的强解在 S时刻之前与直到 S时刻的强解是一样的 .这一相容性使得我\n们可以通过拼接的方法得到定义在 [0,1)上的完整强解 .接下来 ,我们固定\nT > 0.对于n\u00150,我们定义\ngn(t) =E\u0014\nsup\n0≤s≤tjX(n+1)\ns\u0000X(n)\nsj2\u0015\n.\n注意到\nX(1)\nt=x+Zt\n0σ(s,x)dBs+Zt\n0b(s,x)ds.\n利用σ和b的连续性 ,σ(s,x)和b(s,x)有上界CT.于是 ,利用 Doob不等\n式,我们有\ng0(t)\u00144E[(X(1)\nt\u0000x)2]第 13.2节 LIPSCHITZ 情形 197\n=4E\"\u0012Zt\n0σ(s,x)dBs+Zt\n0b(s,x)ds\u00132#\n\u00148E\"\u0012Zt\n0σ(s,x)dBs\u00132#\n+ 8E\"\u0012Zt\n0b(s,x)ds\u00132#\n\u00148E\u0014Zt\n0(σ(s,x))2ds\u0015\n+ 8TE\u0014Zt\n0(b(s,x))2ds\u0015\n\u00148T(1 +T)C2\nT<1.\n令C1= 8T(1 +T)C2\nT,那么 ,g0(t)\u0014C1.接下来 ,利用 BDG不等式和\nLipschitz 条件 ,我们得到\ngn(t)\u00142E\"\nsup\n0≤s≤t\u0012Zs\n0(σ(u,X(n)\nu)\u0000σ(u,X(n−1)\nu ))dBu\u00132#\n+ 2E\"\nsup\n0≤s≤t\u0012Zs\n0(b(u,X(n)\nu)\u0000b(u,X(n−1)\nu ))du\u00132#\n\u00142CE\u0014Zt\n0(σ(u,X(n)\nu)\u0000σ(u,X(n−1)))2du\u0015\n+ 2TE\u0014Zt\n0(b(u,X(n)\nu)\u0000b(u,X(n−1)\nu ))2du\u0015\n\u00142(C+T)K2E\u0014Zt\n0jX(n)\nu\u0000X(n−1)\nuj2du\u0015\n\u0014C2Zt\n0gn−1(u)du,\n其中 ,C2= 2(C+T)K2.利用归纳法 ,可以证明\ngn(t)\u0014C1Cn\n2tn\nn!.\n因此 ,我们有\n∞X\nn=0E\u0014\nsup\n0≤s≤tjX(n+1)\ns\u0000X(n)\nsj\u0015\n\u0014∞X\nn=0gn(t)<+1.\n因此 ,我们有\n∞X\nn=0sup\n0≤s≤tjX(n+1)\ns\u0000X(n)\nsj<1.\n所以 ,当n! 1时,连续的适应过程 X(n)在[0,T]一致收敛 .记极限过程\n为X.那么 ,X也是连续的适应过程 ,并且当n! 1时,在[0,T]上,X(n)198 第十三章 随机微分方程\n一致收敛于 X.利用归纳法 ,8n\u00150,X(n)关于布朗运动 B诱导的自然域\n流的完备化适应 .所以 ,极限过程X也关于布朗运动 B诱导的自然域流的\n完备化适应 .接下来注意到在 [0,T]上,几乎必然的 ,b(s,X(n)\ns)一致收敛于\nb(s,X s).所以 ,在[0,T]上,几乎必然的 ,\nZt\n0(b(s,X s)\u0000b(s,X(n)\ns))ds\n一致收敛于 0.再注意到在 [0,T]上,几乎必然的 ,σ(s,X(n)\ns)一致收敛于\nσ(s,X s).利用随机积分的控制收敛定理 ,我们知道\nZt\n0(σ(s,X s)\u0000σ(s,X(n)\ns))dBs\n依概率收敛于 0.其中 ,为了保证控制收敛定理的成立 ,我们选取控制函数\n∞X\nn=0sup\n0≤u≤sjX(n)\nu\u0000X(n+1)\nuj.\n于是 ,在X(n)的递推公式中令 n! 1 ,我们得到 ,几乎必然的 ,\nXt=x+Zt\n0σ(s,X s)dBs+Zt\n0b(s,X s)ds.\n综上 ,方程Ex(σ,b)的强解存在 .\n第 13.3节 解的马氏性\n本节考虑的时齐的情形 ,即σ(t,x) =σ(x),b(t,x) =b(x).与上节一样 ,\n我们仍假设 σ和b是 Lipschitz 函数 ,即存在常数 K <1,使得\njσ(x)\u0000σ(y)j \u0014Kjx\u0000yj,jb(x)\u0000b(y)j \u0014Kjx\u0000", ")\nu ))du\u00132#\n\u00142CE\u0014Zt\n0(σ(u,X(n)\nu)\u0000σ(u,X(n−1)))2du\u0015\n+ 2TE\u0014Zt\n0(b(u,X(n)\nu)\u0000b(u,X(n−1)\nu ))2du\u0015\n\u00142(C+T)K2E\u0014Zt\n0jX(n)\nu\u0000X(n−1)\nuj2du\u0015\n\u0014C2Zt\n0gn−1(u)du,\n其中 ,C2= 2(C+T)K2.利用归纳法 ,可以证明\ngn(t)\u0014C1Cn\n2tn\nn!.\n因此 ,我们有\n∞X\nn=0E\u0014\nsup\n0≤s≤tjX(n+1)\ns\u0000X(n)\nsj\u0015\n\u0014∞X\nn=0gn(t)<+1.\n因此 ,我们有\n∞X\nn=0sup\n0≤s≤tjX(n+1)\ns\u0000X(n)\nsj<1.\n所以 ,当n! 1时,连续的适应过程 X(n)在[0,T]一致收敛 .记极限过程\n为X.那么 ,X也是连续的适应过程 ,并且当n! 1时,在[0,T]上,X(n)198 第十三章 随机微分方程\n一致收敛于 X.利用归纳法 ,8n\u00150,X(n)关于布朗运动 B诱导的自然域\n流的完备化适应 .所以 ,极限过程X也关于布朗运动 B诱导的自然域流的\n完备化适应 .接下来注意到在 [0,T]上,几乎必然的 ,b(s,X(n)\ns)一致收敛于\nb(s,X s).所以 ,在[0,T]上,几乎必然的 ,\nZt\n0(b(s,X s)\u0000b(s,X(n)\ns))ds\n一致收敛于 0.再注意到在 [0,T]上,几乎必然的 ,σ(s,X(n)\ns)一致收敛于\nσ(s,X s).利用随机积分的控制收敛定理 ,我们知道\nZt\n0(σ(s,X s)\u0000σ(s,X(n)\ns))dBs\n依概率收敛于 0.其中 ,为了保证控制收敛定理的成立 ,我们选取控制函数\n∞X\nn=0sup\n0≤u≤sjX(n)\nu\u0000X(n+1)\nuj.\n于是 ,在X(n)的递推公式中令 n! 1 ,我们得到 ,几乎必然的 ,\nXt=x+Zt\n0σ(s,X s)dBs+Zt\n0b(s,X s)ds.\n综上 ,方程Ex(σ,b)的强解存在 .\n第 13.3节 解的马氏性\n本节考虑的时齐的情形 ,即σ(t,x) =σ(x),b(t,x) =b(x).与上节一样 ,\n我们仍假设 σ和b是 Lipschitz 函数 ,即存在常数 K <1,使得\njσ(x)\u0000σ(y)j \u0014Kjx\u0000yj,jb(x)\u0000b(y)j \u0014Kjx\u0000yj.\n定理 13.3.1.假设X是方程E(σ,b)的解 .那么 ,X是 F el ler过程 ,马氏半\n群(Qt)t≥0如下定义 :\nQtf(x) =E[f(X(x)\nt)],\n其中 ,X(x)是初值为x的方程Ex(σ,b)的解 .对应的无穷小生成算子 L\n的定义域D(L)包含紧支撑且二阶连续可微的函数 C2\nc(Rd).并且 ,对于\nf2C2\nc(Rd),我们有\nLf(x) =1\n2dX\ni,j=1(σσT)ij(x)∂2f\n∂xi∂xj(x) +dX\ni=1bi(x)∂f\n∂xi(x).第 13.4节 例子 199\n注 13.3.2.通常 ,如果一个随机微分方程的解是连续轨道的马氏过程 ,那么 ,\n我们称之为 扩散过程 (diffusion process) .\n第 13.4节 例子\n我们考虑几个重要的一维随机微分方程的例子 .\n13.4.1 Ornstein –Uhlenbeck 过程\n令λ > 0.一维 Ornstein–Uhlenbeck 过程指的是下列随机微分方程的\n解:\ndXt= dBt\u0000λXtdt. (13.2)\n令Yt=eλtXt.利用 Itô公式 ,我们知道\ndYt=eλtdXt+λeλtXtdt=eλtdBt.\n两边同时积分 ,得到\neλtXt=X0+Zt\n0eλsdBs.\n所以 ,我们得到\nXt=X0e−λt+Zt\n0eλ(s−t)dBs.\n上式中的随机积分是 Wiener积分 ,被积函数是确定性的 .可以证明Zt=Rt\n0eλ(s−t)dBs是零均值高斯过程 ,协方差\nE[ZsZt] =E[Zs\n0eλ(u−s)dBuZt\n0eλ(u−t)dBu]\n=Zmin(s,t)\n0eλ(2u−s−t)du\n=1\n2λ(e2λmin(s,t)\u00001)e−λ(s+t)\n=1\n2λ(e−λ|s−t|\u0000e−λ(s+t)).\n根据第 13.3节,X是马氏过程 .假设初始状态 X0服从正态分布 N(0,1\n2λ).那\n么,X服从协方差函数为\nΓ(s,t) =1\n2λe−λ|s−t|\n的零均值高斯过程 .注意到这是一个平稳过程 .所以 ,马氏过程X的平稳分\n布就是N(0,1\n2λ).200 第十三章 随机微分方程\n13.4.2 几何布朗运动\n令σ >0且r2R.参数为 (σ,r)的几何布朗运动指的是如下随机微分\n方程的解 :\ndXt=σXtdBt+rXtdt. (13.3)\n假设X0>0.对 logXt应用 Itô公式 ,得到\nd logXt=1\nXtdXt\u00001\n21\nX2\ntdhX,Xit\n=σdBt+ (r\u0000σ2/2) dt.\n所以 ,我们有\nlogXt= logX0+Bt+ (r\u0000σ2/2)t.\n于是 ,我们得到\nXt=X0eBt+(r−σ2/2)t.\n注意到当X0>0时,X始终为正 .几何布朗运动在金融数学的 Black-\nScholes模型中有应用 .参考文献\n[Dur19] Rick Durrett. Probability—theory and examples , volume 49 of\nCambridge Series in Statistical and Probabilistic Mathematics .\nCambridge University Press, Cambridge, 2019. Fifth edition of\n[ MR1068527].\n[Kal21] Olav Kallenberg. F oundations of modern probability , volume 99\nof Probability Theory and Stochastic Model ling . Springer, Cham,\nthird edition, [2021] ©2021.\n[LG16] Jean-F rançois Le Gall. Brownian motion, martingales, and stochas-\ntic calculus , volume 274 of Graduate T exts in Mathematics .\nSpringer, [Cham], french edition, 2016.\n[Nor98] J. R. Norris. Markov chains , volume 2 of Cambridge Series in\nStatistical and Probabilistic Mathematics . Cambridge University\nPress, Cambridge, 1998. Reprint of 1997 original.\n201"]